OBJECT [0,3949]
    FIELD [1,20]
        String: "name" [1,7]
        STRING [8,20]
            String: "model jobs" [8,20]
    FIELD [21,286]
        String: "on" [21,25]
        OBJECT [26,286]
            FIELD [27,285]
                String: "workflow_call" [27,42]
                OBJECT [43,285]
                    FIELD [44,284]
                        String: "inputs" [44,52]
                        OBJECT [53,284]
                            FIELD [54,103]
                                String: "folder_slices" [54,69]
                                OBJECT [70,103]
                                    FIELD [71,86]
                                        String: "required" [71,81]
                                        TRUE [82,86]
                                    FIELD [87,102]
                                        String: "type" [87,93]
                                        STRING [94,102]
                                            String: "string" [94,102]
                            FIELD [104,152]
                                String: "machine_type" [104,118]
                                OBJECT [119,152]
                                    FIELD [120,135]
                                        String: "required" [120,130]
                                        TRUE [131,135]
                                    FIELD [136,151]
                                        String: "type" [136,142]
                                        STRING [143,151]
                                            String: "string" [143,151]
                            FIELD [153,197]
                                String: "slice_id" [153,163]
                                OBJECT [164,197]
                                    FIELD [165,180]
                                        String: "required" [165,175]
                                        TRUE [176,180]
                                    FIELD [181,196]
                                        String: "type" [181,187]
                                        STRING [188,196]
                                            String: "number" [188,196]
                            FIELD [198,240]
                                String: "runner" [198,206]
                                OBJECT [207,240]
                                    FIELD [208,223]
                                        String: "required" [208,218]
                                        TRUE [219,223]
                                    FIELD [224,239]
                                        String: "type" [224,230]
                                        STRING [231,239]
                                            String: "string" [231,239]
                            FIELD [241,283]
                                String: "docker" [241,249]
                                OBJECT [250,283]
                                    FIELD [251,266]
                                        String: "required" [251,261]
                                        TRUE [262,266]
                                    FIELD [267,282]
                                        String: "type" [267,273]
                                        STRING [274,282]
                                            String: "string" [274,282]
    FIELD [287,595]
        String: "env" [287,292]
        OBJECT [293,595]
            FIELD [294,316]
                String: "HF_HOME" [294,303]
                STRING [304,316]
                    String: "/mnt/cache" [304,316]
            FIELD [317,342]
                String: "TRANSFORMERS_IS_CI" [317,337]
                TRUE [338,342]
            FIELD [343,362]
                String: "OMP_NUM_THREADS" [343,360]
                NUMBER [361,362]
                    Number: 8 [361,362]
            FIELD [363,382]
                String: "MKL_NUM_THREADS" [363,380]
                NUMBER [381,382]
                    Number: 8 [381,382]
            FIELD [383,398]
                String: "RUN_SLOW" [383,393]
                TRUE [394,398]
            FIELD [399,453]
                String: "HF_HUB_READ_TOKEN" [399,418]
                STRING [419,453]
                    String: "${{ secrets.HF_HUB_READ_TOKEN }}" [419,453]
            FIELD [454,506]
                String: "SIGOPT_API_TOKEN" [454,472]
                STRING [473,506]
                    String: "${{ secrets.SIGOPT_API_TOKEN }}" [473,506]
            FIELD [507,539]
                String: "TF_FORCE_GPU_ALLOW_GROWTH" [507,534]
                TRUE [535,539]
            FIELD [540,565]
                String: "RUN_PT_TF_CROSS_TESTS" [540,563]
                NUMBER [564,565]
                    Number: 1 [564,565]
            FIELD [566,594]
                String: "CUDA_VISIBLE_DEVICES" [566,588]
                STRING [589,594]
                    String: "0,1" [589,594]
    FIELD [596,3948]
        String: "jobs" [596,602]
        OBJECT [603,3948]
            FIELD [604,3947]
                String: "run_models_gpu" [604,620]
                OBJECT [621,3947]
                    FIELD [622,632]
                        String: "name" [622,628]
                        STRING [629,632]
                            String: " " [629,632]
                    FIELD [633,758]
                        String: "strategy" [633,643]
                        OBJECT [644,758]
                            FIELD [645,661]
                                String: "max-parallel" [645,659]
                                NUMBER [660,661]
                                    Number: 1 [660,661]
                            FIELD [662,679]
                                String: "fail-fast" [662,673]
                                FALSE [674,679]
                            FIELD [680,757]
                                String: "matrix" [680,688]
                                OBJECT [689,757]
                                    FIELD [690,756]
                                        String: "folders" [690,699]
                                        STRING [700,756]
                                            String: "${{ fromJson(inputs.folder_slices)[inputs.slice_id] }}" [700,756]
                    FIELD [759,846]
                        String: "runs-on" [759,768]
                        ARRAY [769,846]
                            STRING [770,798]
                                String: "${{ inputs.machine_type }}" [770,798]
                            STRING [799,812]
                                String: "self-hosted" [799,812]
                            STRING [813,822]
                                String: "amd-gpu" [813,822]
                            STRING [823,845]
                                String: "${{ inputs.runner }}" [823,845]
                    FIELD [847,1042]
                        String: "container" [847,858]
                        OBJECT [859,1042]
                            FIELD [860,890]
                                String: "image" [860,867]
                                STRING [868,890]
                                    String: "${{ inputs.docker }}" [868,890]
                            FIELD [891,1041]
                                String: "options" [891,900]
                                STRING [901,1041]
                                    String: "--device /dev/kfd --device /dev/dri --env ROCR_VISIBLE_DEVICES --shm-size \"16gb\" --ipc host -v /mnt/cache/.cache/huggingface:/mnt/cache/" [901,1041]
                    FIELD [1043,3946]
                        String: "steps" [1043,1050]
                        ARRAY [1051,3946]
                            OBJECT [1052,1256]
                                FIELD [1053,1088]
                                    String: "name" [1053,1059]
                                    STRING [1060,1088]
                                        String: "Echo input and matrix info" [1060,1088]
                                FIELD [1089,1103]
                                    String: "shell" [1089,1096]
                                    STRING [1097,1103]
                                        String: "bash" [1097,1103]
                                FIELD [1104,1255]
                                    String: "run" [1104,1109]
                                    STRING [1110,1255]
                                        String: "echo \"${{ inputs.folder_slices }}\"\necho \"${{ matrix.folders }}\"\necho \"${{ toJson(fromJson(inputs.folder_slices)[inputs.slice_id]) }}\"\n" [1110,1255]
                            OBJECT [1257,1531]
                                FIELD [1258,1300]
                                    String: "name" [1258,1264]
                                    STRING [1265,1300]
                                        String: "Echo folder ${{ matrix.folders }}" [1265,1300]
                                FIELD [1301,1315]
                                    String: "shell" [1301,1308]
                                    STRING [1309,1315]
                                        String: "bash" [1309,1315]
                                FIELD [1316,1530]
                                    String: "run" [1316,1321]
                                    STRING [1322,1530]
                                        String: "echo \"${{ matrix.folders }}\"\nmatrix_folders=${{ matrix.folders }}\nmatrix_folders=${matrix_folders/'models/'/'models_'}\necho \"$matrix_folders\"\necho \"matrix_folders=$matrix_folders\" >> $GITHUB_ENV\n" [1322,1530]
                            OBJECT [1532,1643]
                                FIELD [1533,1554]
                                    String: "name" [1533,1539]
                                    STRING [1540,1554]
                                        String: "Update clone" [1540,1554]
                                FIELD [1555,1590]
                                    String: "working-directory" [1555,1574]
                                    STRING [1575,1590]
                                        String: "/transformers" [1575,1590]
                                FIELD [1591,1642]
                                    String: "run" [1591,1596]
                                    STRING [1597,1642]
                                        String: "git fetch && git checkout ${{ github.sha }}" [1597,1642]
                            OBJECT [1644,1859]
                                FIELD [1645,1742]
                                    String: "name" [1645,1651]
                                    STRING [1652,1742]
                                        String: "Reinstall transformers in edit mode (remove the one installed during docker image build)" [1652,1742]
                                FIELD [1743,1778]
                                    String: "working-directory" [1743,1762]
                                    STRING [1763,1778]
                                        String: "/transformers" [1763,1778]
                                FIELD [1779,1858]
                                    String: "run" [1779,1784]
                                    STRING [1785,1858]
                                        String: "python3 -m pip uninstall -y transformers && python3 -m pip install -e ." [1785,1858]
                            OBJECT [1860,2044]
                                FIELD [1861,1914]
                                    String: "name" [1861,1867]
                                    STRING [1868,1914]
                                        String: "Update / Install some packages (for Past CI)" [1868,1914]
                                FIELD [1915,1962]
                                    String: "if" [1915,1919]
                                    STRING [1920,1962]
                                        String: "${{ contains(inputs.docker, '-past-') }}" [1920,1962]
                                FIELD [1963,1998]
                                    String: "working-directory" [1963,1982]
                                    STRING [1983,1998]
                                        String: "/transformers" [1983,1998]
                                FIELD [1999,2043]
                                    String: "run" [1999,2004]
                                    STRING [2005,2043]
                                        String: "python3 -m pip install -U datasets\n" [2005,2043]
                            OBJECT [2045,2338]
                                FIELD [2046,2099]
                                    String: "name" [2046,2052]
                                    STRING [2053,2099]
                                        String: "Update / Install some packages (for Past CI)" [2053,2099]
                                FIELD [2100,2187]
                                    String: "if" [2100,2104]
                                    STRING [2105,2187]
                                        String: "${{ contains(inputs.docker, '-past-') && contains(inputs.docker, '-pytorch-') }}" [2105,2187]
                                FIELD [2188,2223]
                                    String: "working-directory" [2188,2207]
                                    STRING [2208,2223]
                                        String: "/transformers" [2208,2223]
                                FIELD [2224,2337]
                                    String: "run" [2224,2229]
                                    STRING [2230,2337]
                                        String: "python3 -m pip install --no-cache-dir git+https://github.com/huggingface/accelerate@main#egg=accelerate\n" [2230,2337]
                            OBJECT [2339,2377]
                                FIELD [2340,2357]
                                    String: "name" [2340,2346]
                                    STRING [2347,2357]
                                        String: "ROCM-SMI" [2347,2357]
                                FIELD [2358,2376]
                                    String: "run" [2358,2363]
                                    STRING [2364,2376]
                                        String: "rocm-smi\n" [2364,2376]
                            OBJECT [2378,2441]
                                FIELD [2379,2397]
                                    String: "name" [2379,2385]
                                    STRING [2386,2397]
                                        String: "ROCM-INFO" [2386,2397]
                                FIELD [2398,2440]
                                    String: "run" [2398,2403]
                                    STRING [2404,2440]
                                        String: "rocminfo  | grep \"Agent\" -A 14\n" [2404,2440]
                            OBJECT [2442,2521]
                                FIELD [2443,2473]
                                    String: "name" [2443,2449]
                                    STRING [2450,2473]
                                        String: "Show ROCR environment" [2450,2473]
                                FIELD [2474,2520]
                                    String: "run" [2474,2479]
                                    STRING [2480,2520]
                                        String: "echo \"ROCR: $ROCR_VISIBLE_DEVICES\"\n" [2480,2520]
                            OBJECT [2522,2617]
                                FIELD [2523,2543]
                                    String: "name" [2523,2529]
                                    STRING [2530,2543]
                                        String: "Environment" [2530,2543]
                                FIELD [2544,2579]
                                    String: "working-directory" [2544,2563]
                                    STRING [2564,2579]
                                        String: "/transformers" [2564,2579]
                                FIELD [2580,2616]
                                    String: "run" [2580,2585]
                                    STRING [2586,2616]
                                        String: "python3 utils/print_env.py\n" [2586,2616]
                            OBJECT [2618,2727]
                                FIELD [2619,2671]
                                    String: "name" [2619,2625]
                                    STRING [2626,2671]
                                        String: "Show installed libraries and their versions" [2626,2671]
                                FIELD [2672,2707]
                                    String: "working-directory" [2672,2691]
                                    STRING [2692,2707]
                                        String: "/transformers" [2692,2707]
                                FIELD [2708,2726]
                                    String: "run" [2708,2713]
                                    STRING [2714,2726]
                                        String: "pip freeze" [2714,2726]
                            OBJECT [2728,2978]
                                FIELD [2729,2758]
                                    String: "name" [2729,2735]
                                    STRING [2736,2758]
                                        String: "Run all tests on GPU" [2736,2758]
                                FIELD [2759,2794]
                                    String: "working-directory" [2759,2778]
                                    STRING [2779,2794]
                                        String: "/transformers" [2779,2794]
                                FIELD [2795,2977]
                                    String: "run" [2795,2800]
                                    STRING [2801,2977]
                                        String: "python3 -m pytest -rsfE -v --make-reports=${{ inputs.machine_type }}_run_models_gpu_${{ matrix.folders }}_test_reports tests/${{ matrix.folders }}  -m \"not not_device_test\"" [2801,2977]
                            OBJECT [2979,3190]
                                FIELD [2980,3010]
                                    String: "name" [2980,2986]
                                    STRING [2987,3010]
                                        String: "Failure short reports" [2987,3010]
                                FIELD [3011,3034]
                                    String: "if" [3011,3015]
                                    STRING [3016,3034]
                                        String: "${{ failure() }}" [3016,3034]
                                FIELD [3035,3059]
                                    String: "continue-on-error" [3035,3054]
                                    TRUE [3055,3059]
                                FIELD [3060,3189]
                                    String: "run" [3060,3065]
                                    STRING [3066,3189]
                                        String: "cat /transformers/reports/${{ inputs.machine_type }}_run_models_gpu_${{ matrix.folders }}_test_reports/failures_short.txt" [3066,3189]
                            OBJECT [3191,3557]
                                FIELD [3192,3209]
                                    String: "name" [3192,3198]
                                    STRING [3199,3209]
                                        String: "Run test" [3199,3209]
                                FIELD [3210,3224]
                                    String: "shell" [3210,3217]
                                    STRING [3218,3224]
                                        String: "bash" [3218,3224]
                                FIELD [3225,3556]
                                    String: "run" [3225,3230]
                                    STRING [3231,3556]
                                        String: "mkdir -p /transformers/reports/${{ inputs.machine_type }}_run_models_gpu_${{ matrix.folders }}_test_reports\necho \"hello\" > /transformers/reports/${{ inputs.machine_type }}_run_models_gpu_${{ matrix.folders }}_test_reports/hello.txt\necho \"${{ inputs.machine_type }}_run_models_gpu_${{ matrix.folders }}_test_reports\"\n" [3231,3556]
                            OBJECT [3558,3945]
                                FIELD [3559,3678]
                                    String: "name" [3559,3565]
                                    STRING [3566,3678]
                                        String: "Test suite reports artifacts: ${{ inputs.machine_type }}_run_models_gpu_${{ env.matrix_folders }}_test_reports" [3566,3678]
                                FIELD [3679,3701]
                                    String: "if" [3679,3683]
                                    STRING [3684,3701]
                                        String: "${{ always() }}" [3684,3701]
                                FIELD [3702,3737]
                                    String: "uses" [3702,3708]
                                    STRING [3709,3737]
                                        String: "actions/upload-artifact@v4" [3709,3737]
                                FIELD [3738,3944]
                                    String: "with" [3738,3744]
                                    OBJECT [3745,3944]
                                        FIELD [3746,3835]
                                            String: "name" [3746,3752]
                                            STRING [3753,3835]
                                                String: "${{ inputs.machine_type }}_run_models_gpu_${{ env.matrix_folders }}_test_reports" [3753,3835]
                                        FIELD [3836,3943]
                                            String: "path" [3836,3842]
                                            STRING [3843,3943]
                                                String: "/transformers/reports/${{ inputs.machine_type }}_run_models_gpu_${{ matrix.folders }}_test_reports" [3843,3943]