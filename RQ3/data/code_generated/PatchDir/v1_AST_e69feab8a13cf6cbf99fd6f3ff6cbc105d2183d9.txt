OBJECT [0,20175]
    FIELD [1,35]
        String: "name" [1,7]
        STRING [8,35]
            String: "Self-hosted runner (push)" [8,35]
    FIELD [36,282]
        String: "on" [36,40]
        OBJECT [41,282]
            FIELD [42,149]
                String: "workflow_run" [42,56]
                OBJECT [57,149]
                    FIELD [58,106]
                        String: "workflows" [58,69]
                        ARRAY [70,106]
                            STRING [71,105]
                                String: "Self-hosted runner (push-caller)" [71,105]
                    FIELD [107,126]
                        String: "branches" [107,117]
                        ARRAY [118,126]
                            STRING [119,125]
                                String: "main" [119,125]
                    FIELD [127,148]
                        String: "types" [127,134]
                        ARRAY [135,148]
                            STRING [136,147]
                                String: "completed" [136,147]
            FIELD [150,254]
                String: "push" [150,156]
                OBJECT [157,254]
                    FIELD [158,184]
                        String: "branches" [158,168]
                        ARRAY [169,184]
                            STRING [170,176]
                                String: "ci_*" [170,176]
                            STRING [177,183]
                                String: "ci-*" [177,183]
                    FIELD [185,253]
                        String: "paths" [185,192]
                        ARRAY [193,253]
                            STRING [194,202]
                                String: "src/**" [194,202]
                            STRING [203,213]
                                String: "tests/**" [203,213]
                            STRING [214,226]
                                String: ".github/**" [214,226]
                            STRING [227,241]
                                String: "templates/**" [227,241]
                            STRING [242,252]
                                String: "utils/**" [242,252]
            FIELD [255,281]
                String: "repository_dispatch" [255,276]
                NULL [277,281]
    FIELD [283,458]
        String: "env" [283,288]
        OBJECT [289,458]
            FIELD [290,312]
                String: "HF_HOME" [290,299]
                STRING [300,312]
                    String: "/mnt/cache" [300,312]
            FIELD [313,338]
                String: "TRANSFORMERS_IS_CI" [313,333]
                TRUE [334,338]
            FIELD [339,358]
                String: "OMP_NUM_THREADS" [339,356]
                NUMBER [357,358]
                    Number: 8 [357,358]
            FIELD [359,378]
                String: "MKL_NUM_THREADS" [359,376]
                NUMBER [377,378]
                    Number: 8 [377,378]
            FIELD [379,398]
                String: "PYTEST_TIMEOUT" [379,395]
                NUMBER [396,398]
                    Number: 60 [396,398]
            FIELD [399,431]
                String: "TF_FORCE_GPU_ALLOW_GROWTH" [399,426]
                TRUE [427,431]
            FIELD [432,457]
                String: "RUN_PT_TF_CROSS_TESTS" [432,455]
                NUMBER [456,457]
                    Number: 1 [456,457]
    FIELD [459,20174]
        String: "jobs" [459,465]
        OBJECT [466,20174]
            FIELD [467,840]
                String: "check_runner_status" [467,488]
                OBJECT [489,840]
                    FIELD [490,518]
                        String: "name" [490,496]
                        STRING [497,518]
                            String: "Check Runner Status" [497,518]
                    FIELD [519,544]
                        String: "runs-on" [519,528]
                        STRING [529,544]
                            String: "ubuntu-latest" [529,544]
                    FIELD [545,839]
                        String: "steps" [545,552]
                        ARRAY [553,839]
                            OBJECT [554,640]
                                FIELD [555,585]
                                    String: "name" [555,561]
                                    STRING [562,585]
                                        String: "Checkout transformers" [562,585]
                                FIELD [586,614]
                                    String: "uses" [586,592]
                                    STRING [593,614]
                                        String: "actions/checkout@v3" [593,614]
                                FIELD [615,639]
                                    String: "with" [615,621]
                                    OBJECT [622,639]
                                        FIELD [623,638]
                                            String: "fetch-depth" [623,636]
                                            NUMBER [637,638]
                                                Number: 2 [637,638]
                            OBJECT [641,838]
                                FIELD [642,670]
                                    String: "name" [642,648]
                                    STRING [649,670]
                                        String: "Check Runner Status" [649,670]
                                FIELD [671,837]
                                    String: "run" [671,676]
                                    STRING [677,837]
                                        String: "python utils/check_self_hosted_runner.py --target_runners single-gpu-ci-runner-docker,multi-gpu-ci-runner-docker --token ${{ secrets.ACCESS_REPO_INFO_TOKEN }}" [677,837]
            FIELD [841,1267]
                String: "check_runners" [841,856]
                OBJECT [857,1267]
                    FIELD [858,880]
                        String: "name" [858,864]
                        STRING [865,880]
                            String: "Check Runners" [865,880]
                    FIELD [881,910]
                        String: "needs" [881,888]
                        STRING [889,910]
                            String: "check_runner_status" [889,910]
                    FIELD [911,976]
                        String: "strategy" [911,921]
                        OBJECT [922,976]
                            FIELD [923,975]
                                String: "matrix" [923,931]
                                OBJECT [932,975]
                                    FIELD [933,974]
                                        String: "machine_type" [933,947]
                                        ARRAY [948,974]
                                            STRING [949,961]
                                                String: "single-gpu" [949,961]
                                            STRING [962,973]
                                                String: "multi-gpu" [962,973]
                    FIELD [977,1044]
                        String: "runs-on" [977,986]
                        ARRAY [987,1044]
                            STRING [988,1001]
                                String: "self-hosted" [988,1001]
                            STRING [1002,1014]
                                String: "docker-gpu" [1002,1014]
                            STRING [1015,1043]
                                String: "${{ matrix.machine_type }}" [1015,1043]
                    FIELD [1045,1213]
                        String: "container" [1045,1056]
                        OBJECT [1057,1213]
                            FIELD [1058,1115]
                                String: "image" [1058,1065]
                                STRING [1066,1115]
                                    String: "huggingface/transformers-all-latest-gpu-push-ci" [1066,1115]
                            FIELD [1116,1212]
                                String: "options" [1116,1125]
                                STRING [1126,1212]
                                    String: "--gpus 0 --shm-size \"16gb\" --ipc host -v /mnt/cache/.cache/huggingface:/mnt/cache/" [1126,1212]
                    FIELD [1214,1266]
                        String: "steps" [1214,1221]
                        ARRAY [1222,1266]
                            OBJECT [1223,1265]
                                FIELD [1224,1243]
                                    String: "name" [1224,1230]
                                    STRING [1231,1243]
                                        String: "NVIDIA-SMI" [1231,1243]
                                FIELD [1244,1264]
                                    String: "run" [1244,1249]
                                    STRING [1250,1264]
                                        String: "nvidia-smi\n" [1250,1264]
            FIELD [1268,4169]
                String: "setup" [1268,1275]
                OBJECT [1276,4169]
                    FIELD [1277,1291]
                        String: "name" [1277,1283]
                        STRING [1284,1291]
                            String: "Setup" [1284,1291]
                    FIELD [1292,1315]
                        String: "needs" [1292,1299]
                        STRING [1300,1315]
                            String: "check_runners" [1300,1315]
                    FIELD [1316,1381]
                        String: "strategy" [1316,1326]
                        OBJECT [1327,1381]
                            FIELD [1328,1380]
                                String: "matrix" [1328,1336]
                                OBJECT [1337,1380]
                                    FIELD [1338,1379]
                                        String: "machine_type" [1338,1352]
                                        ARRAY [1353,1379]
                                            STRING [1354,1366]
                                                String: "single-gpu" [1354,1366]
                                            STRING [1367,1378]
                                                String: "multi-gpu" [1367,1378]
                    FIELD [1382,1449]
                        String: "runs-on" [1382,1391]
                        ARRAY [1392,1449]
                            STRING [1393,1406]
                                String: "self-hosted" [1393,1406]
                            STRING [1407,1419]
                                String: "docker-gpu" [1407,1419]
                            STRING [1420,1448]
                                String: "${{ matrix.machine_type }}" [1420,1448]
                    FIELD [1450,1618]
                        String: "container" [1450,1461]
                        OBJECT [1462,1618]
                            FIELD [1463,1520]
                                String: "image" [1463,1470]
                                STRING [1471,1520]
                                    String: "huggingface/transformers-all-latest-gpu-push-ci" [1471,1520]
                            FIELD [1521,1617]
                                String: "options" [1521,1530]
                                STRING [1531,1617]
                                    String: "--gpus 0 --shm-size \"16gb\" --ipc host -v /mnt/cache/.cache/huggingface:/mnt/cache/" [1531,1617]
                    FIELD [1619,1734]
                        String: "outputs" [1619,1628]
                        OBJECT [1629,1734]
                            FIELD [1630,1679]
                                String: "matrix" [1630,1638]
                                STRING [1639,1679]
                                    String: "${{ steps.set-matrix.outputs.matrix }}" [1639,1679]
                            FIELD [1680,1733]
                                String: "test_map" [1680,1690]
                                STRING [1691,1733]
                                    String: "${{ steps.set-matrix.outputs.test_map }}" [1691,1733]
                    FIELD [1735,4168]
                        String: "steps" [1735,1742]
                        ARRAY [1743,4168]
                            OBJECT [1744,2461]
                                FIELD [1745,1790]
                                    String: "name" [1745,1751]
                                    STRING [1752,1790]
                                        String: "Prepare custom environment variables" [1752,1790]
                                FIELD [1791,1805]
                                    String: "shell" [1791,1798]
                                    STRING [1799,1805]
                                        String: "bash" [1799,1805]
                                FIELD [1806,2460]
                                    String: "run" [1806,1811]
                                    STRING [1812,2460]
                                        String: "CI_BRANCH_PUSH=${{ github.event.ref }}\nCI_BRANCH_PUSH=${CI_BRANCH_PUSH/'refs/heads/'/''}\nCI_BRANCH_WORKFLOW_RUN=${{ github.event.workflow_run.head_branch }}\nCI_SHA_PUSH=${{ github.event.head_commit.id }}\nCI_SHA_WORKFLOW_RUN=${{ github.event.workflow_run.head_sha }}\necho $CI_BRANCH_PUSH\necho $CI_BRANCH_WORKFLOW_RUN\necho $CI_SHA_PUSH\necho $CI_SHA_WORKFLOW_RUN\n[[ ! -z \"$CI_BRANCH_PUSH\" ]] && echo \"CI_BRANCH=$CI_BRANCH_PUSH\" >> $GITHUB_ENV || echo \"CI_BRANCH=$CI_BRANCH_WORKFLOW_RUN\" >> $GITHUB_ENV\n[[ ! -z \"$CI_SHA_PUSH\" ]] && echo \"CI_SHA=$CI_SHA_PUSH\" >> $GITHUB_ENV || echo \"CI_SHA=$CI_SHA_WORKFLOW_RUN\" >> $GITHUB_ENV\n" [1812,2460]
                            OBJECT [2462,2597]
                                FIELD [2463,2499]
                                    String: "name" [2463,2469]
                                    STRING [2470,2499]
                                        String: "print environment variables" [2470,2499]
                                FIELD [2500,2596]
                                    String: "run" [2500,2505]
                                    STRING [2506,2596]
                                        String: "echo \"env.CI_BRANCH = ${{ env.CI_BRANCH }}\"\necho \"env.CI_SHA = ${{ env.CI_SHA }}\"\n" [2506,2596]
                            OBJECT [2598,2919]
                                FIELD [2599,2648]
                                    String: "name" [2599,2605]
                                    STRING [2606,2648]
                                        String: "Update clone using environment variables" [2606,2648]
                                FIELD [2649,2684]
                                    String: "working-directory" [2649,2668]
                                    STRING [2669,2684]
                                        String: "/transformers" [2669,2684]
                                FIELD [2685,2918]
                                    String: "run" [2685,2690]
                                    STRING [2691,2918]
                                        String: "echo \"original branch = $(git branch --show-current)\"\ngit fetch && git checkout ${{ env.CI_BRANCH }}\necho \"updated branch = $(git branch --show-current)\"\ngit checkout ${{ env.CI_SHA }}\necho \"log = $(git log -n 1)\"\n" [2691,2918]
                            OBJECT [2920,3058]
                                FIELD [2921,2937]
                                    String: "name" [2921,2927]
                                    STRING [2928,2937]
                                        String: "Cleanup" [2928,2937]
                                FIELD [2938,2973]
                                    String: "working-directory" [2938,2957]
                                    STRING [2958,2973]
                                        String: "/transformers" [2958,2973]
                                FIELD [2974,3057]
                                    String: "run" [2974,2979]
                                    STRING [2980,3057]
                                        String: "rm -rf tests/__pycache__\nrm -rf tests/models/__pycache__\nrm -rf reports\n" [2980,3057]
                            OBJECT [3059,3168]
                                FIELD [3060,3112]
                                    String: "name" [3060,3066]
                                    STRING [3067,3112]
                                        String: "Show installed libraries and their versions" [3067,3112]
                                FIELD [3113,3148]
                                    String: "working-directory" [3113,3132]
                                    STRING [3133,3148]
                                        String: "/transformers" [3133,3148]
                                FIELD [3149,3167]
                                    String: "run" [3149,3154]
                                    STRING [3155,3167]
                                        String: "pip freeze" [3155,3167]
                            OBJECT [3169,3364]
                                FIELD [3170,3201]
                                    String: "name" [3170,3176]
                                    STRING [3177,3201]
                                        String: "Fetch the tests to run" [3177,3201]
                                FIELD [3202,3237]
                                    String: "working-directory" [3202,3221]
                                    STRING [3222,3237]
                                        String: "/transformers" [3222,3237]
                                FIELD [3238,3363]
                                    String: "run" [3238,3243]
                                    STRING [3244,3363]
                                        String: "pip install --upgrade git-python\npython3 utils/tests_fetcher.py --diff_with_last_commit | tee test_preparation.txt\n" [3244,3363]
                            OBJECT [3365,3507]
                                FIELD [3366,3395]
                                    String: "name" [3366,3372]
                                    STRING [3373,3395]
                                        String: "Report fetched tests" [3373,3395]
                                FIELD [3396,3431]
                                    String: "uses" [3396,3402]
                                    STRING [3403,3431]
                                        String: "actions/upload-artifact@v3" [3403,3431]
                                FIELD [3432,3506]
                                    String: "with" [3432,3438]
                                    OBJECT [3439,3506]
                                        FIELD [3440,3461]
                                            String: "name" [3440,3446]
                                            STRING [3447,3461]
                                                String: "test_fetched" [3447,3461]
                                        FIELD [3462,3505]
                                            String: "path" [3462,3468]
                                            STRING [3469,3505]
                                                String: "/transformers/test_preparation.txt" [3469,3505]
                            OBJECT [3508,4167]
                                FIELD [3509,3526]
                                    String: "id" [3509,3513]
                                    STRING [3514,3526]
                                        String: "set-matrix" [3514,3526]
                                FIELD [3527,3562]
                                    String: "name" [3527,3533]
                                    STRING [3534,3562]
                                        String: "Organize tests into models" [3534,3562]
                                FIELD [3563,3598]
                                    String: "working-directory" [3563,3582]
                                    STRING [3583,3598]
                                        String: "/transformers" [3583,3598]
                                FIELD [3599,4166]
                                    String: "run" [3599,3604]
                                    STRING [3605,4166]
                                        String: "if [ -f test_map.json ]; then\n    keys=$(python3 -c 'import json; fp = open(\"test_map.json\"); test_map = json.load(fp); fp.close(); d = list(test_map.keys()); print(d)')\n    test_map=$(python3 -c 'import json; fp = open(\"test_map.json\"); test_map = json.load(fp); fp.close(); print(test_map)')\nelse\n    keys=$(python3 -c 'keys = [\"dummy\"]; print(keys)')\n    test_map=$(python3 -c 'test_map = {\"dummy\": []}; print(test_map)')\nfi\necho $keys\necho $test_map\necho \"matrix=$keys\" >> $GITHUB_OUTPUT\necho \"test_map=$test_map\" >> $GITHUB_OUTPUT\n" [3605,4166]
            FIELD [4170,7424]
                String: "run_tests_single_gpu" [4170,4192]
                OBJECT [4193,7424]
                    FIELD [4194,4214]
                        String: "name" [4194,4200]
                        STRING [4201,4214]
                            String: "Model tests" [4201,4214]
                    FIELD [4215,4230]
                        String: "needs" [4215,4222]
                        STRING [4223,4230]
                            String: "setup" [4223,4230]
                    FIELD [4231,4301]
                        String: "if" [4231,4235]
                        STRING [4236,4301]
                            String: "contains(fromJson(needs.setup.outputs.matrix), 'dummy') != true" [4236,4301]
                    FIELD [4302,4429]
                        String: "strategy" [4302,4312]
                        OBJECT [4313,4429]
                            FIELD [4314,4331]
                                String: "fail-fast" [4314,4325]
                                FALSE [4326,4331]
                            FIELD [4332,4428]
                                String: "matrix" [4332,4340]
                                OBJECT [4341,4428]
                                    FIELD [4342,4397]
                                        String: "folders" [4342,4351]
                                        STRING [4352,4397]
                                            String: "${{ fromJson(needs.setup.outputs.matrix) }}" [4352,4397]
                                    FIELD [4398,4427]
                                        String: "machine_type" [4398,4412]
                                        ARRAY [4413,4427]
                                            STRING [4414,4426]
                                                String: "single-gpu" [4414,4426]
                    FIELD [4430,4497]
                        String: "runs-on" [4430,4439]
                        ARRAY [4440,4497]
                            STRING [4441,4454]
                                String: "self-hosted" [4441,4454]
                            STRING [4455,4467]
                                String: "docker-gpu" [4455,4467]
                            STRING [4468,4496]
                                String: "${{ matrix.machine_type }}" [4468,4496]
                    FIELD [4498,4666]
                        String: "container" [4498,4509]
                        OBJECT [4510,4666]
                            FIELD [4511,4568]
                                String: "image" [4511,4518]
                                STRING [4519,4568]
                                    String: "huggingface/transformers-all-latest-gpu-push-ci" [4519,4568]
                            FIELD [4569,4665]
                                String: "options" [4569,4578]
                                STRING [4579,4665]
                                    String: "--gpus 0 --shm-size \"16gb\" --ipc host -v /mnt/cache/.cache/huggingface:/mnt/cache/" [4579,4665]
                    FIELD [4667,7423]
                        String: "steps" [4667,4674]
                        ARRAY [4675,7423]
                            OBJECT [4676,5393]
                                FIELD [4677,4722]
                                    String: "name" [4677,4683]
                                    STRING [4684,4722]
                                        String: "Prepare custom environment variables" [4684,4722]
                                FIELD [4723,4737]
                                    String: "shell" [4723,4730]
                                    STRING [4731,4737]
                                        String: "bash" [4731,4737]
                                FIELD [4738,5392]
                                    String: "run" [4738,4743]
                                    STRING [4744,5392]
                                        String: "CI_BRANCH_PUSH=${{ github.event.ref }}\nCI_BRANCH_PUSH=${CI_BRANCH_PUSH/'refs/heads/'/''}\nCI_BRANCH_WORKFLOW_RUN=${{ github.event.workflow_run.head_branch }}\nCI_SHA_PUSH=${{ github.event.head_commit.id }}\nCI_SHA_WORKFLOW_RUN=${{ github.event.workflow_run.head_sha }}\necho $CI_BRANCH_PUSH\necho $CI_BRANCH_WORKFLOW_RUN\necho $CI_SHA_PUSH\necho $CI_SHA_WORKFLOW_RUN\n[[ ! -z \"$CI_BRANCH_PUSH\" ]] && echo \"CI_BRANCH=$CI_BRANCH_PUSH\" >> $GITHUB_ENV || echo \"CI_BRANCH=$CI_BRANCH_WORKFLOW_RUN\" >> $GITHUB_ENV\n[[ ! -z \"$CI_SHA_PUSH\" ]] && echo \"CI_SHA=$CI_SHA_PUSH\" >> $GITHUB_ENV || echo \"CI_SHA=$CI_SHA_WORKFLOW_RUN\" >> $GITHUB_ENV\n" [4744,5392]
                            OBJECT [5394,5529]
                                FIELD [5395,5431]
                                    String: "name" [5395,5401]
                                    STRING [5402,5431]
                                        String: "print environment variables" [5402,5431]
                                FIELD [5432,5528]
                                    String: "run" [5432,5437]
                                    STRING [5438,5528]
                                        String: "echo \"env.CI_BRANCH = ${{ env.CI_BRANCH }}\"\necho \"env.CI_SHA = ${{ env.CI_SHA }}\"\n" [5438,5528]
                            OBJECT [5530,5851]
                                FIELD [5531,5580]
                                    String: "name" [5531,5537]
                                    STRING [5538,5580]
                                        String: "Update clone using environment variables" [5538,5580]
                                FIELD [5581,5616]
                                    String: "working-directory" [5581,5600]
                                    STRING [5601,5616]
                                        String: "/transformers" [5601,5616]
                                FIELD [5617,5850]
                                    String: "run" [5617,5622]
                                    STRING [5623,5850]
                                        String: "echo \"original branch = $(git branch --show-current)\"\ngit fetch && git checkout ${{ env.CI_BRANCH }}\necho \"updated branch = $(git branch --show-current)\"\ngit checkout ${{ env.CI_SHA }}\necho \"log = $(git log -n 1)\"\n" [5623,5850]
                            OBJECT [5852,6067]
                                FIELD [5853,5950]
                                    String: "name" [5853,5859]
                                    STRING [5860,5950]
                                        String: "Reinstall transformers in edit mode (remove the one installed during docker image build)" [5860,5950]
                                FIELD [5951,5986]
                                    String: "working-directory" [5951,5970]
                                    STRING [5971,5986]
                                        String: "/transformers" [5971,5986]
                                FIELD [5987,6066]
                                    String: "run" [5987,5992]
                                    STRING [5993,6066]
                                        String: "python3 -m pip uninstall -y transformers && python3 -m pip install -e ." [5993,6066]
                            OBJECT [6068,6414]
                                FIELD [6069,6111]
                                    String: "name" [6069,6075]
                                    STRING [6076,6111]
                                        String: "Echo folder ${{ matrix.folders }}" [6076,6111]
                                FIELD [6112,6126]
                                    String: "shell" [6112,6119]
                                    STRING [6120,6126]
                                        String: "bash" [6120,6126]
                                FIELD [6127,6413]
                                    String: "run" [6127,6132]
                                    STRING [6133,6413]
                                        String: "echo \"${{ matrix.folders }}\"\necho \"${{ fromJson(needs.setup.outputs.test_map)[matrix.folders] }}\"\nmatrix_folders=${{ matrix.folders }}\nmatrix_folders=${matrix_folders/'models/'/'models_'}\necho \"$matrix_folders\"\necho \"matrix_folders=$matrix_folders\" >> $GITHUB_ENV\n" [6133,6413]
                            OBJECT [6415,6457]
                                FIELD [6416,6435]
                                    String: "name" [6416,6422]
                                    STRING [6423,6435]
                                        String: "NVIDIA-SMI" [6423,6435]
                                FIELD [6436,6456]
                                    String: "run" [6436,6441]
                                    STRING [6442,6456]
                                        String: "nvidia-smi\n" [6442,6456]
                            OBJECT [6458,6553]
                                FIELD [6459,6479]
                                    String: "name" [6459,6465]
                                    STRING [6466,6479]
                                        String: "Environment" [6466,6479]
                                FIELD [6480,6515]
                                    String: "working-directory" [6480,6499]
                                    STRING [6500,6515]
                                        String: "/transformers" [6500,6515]
                                FIELD [6516,6552]
                                    String: "run" [6516,6521]
                                    STRING [6522,6552]
                                        String: "python3 utils/print_env.py\n" [6522,6552]
                            OBJECT [6554,6663]
                                FIELD [6555,6607]
                                    String: "name" [6555,6561]
                                    STRING [6562,6607]
                                        String: "Show installed libraries and their versions" [6562,6607]
                                FIELD [6608,6643]
                                    String: "working-directory" [6608,6627]
                                    STRING [6628,6643]
                                        String: "/transformers" [6628,6643]
                                FIELD [6644,6662]
                                    String: "run" [6644,6649]
                                    STRING [6650,6662]
                                        String: "pip freeze" [6650,6662]
                            OBJECT [6664,6937]
                                FIELD [6665,6712]
                                    String: "name" [6665,6671]
                                    STRING [6672,6712]
                                        String: "Run all non-slow selected tests on GPU" [6672,6712]
                                FIELD [6713,6748]
                                    String: "working-directory" [6713,6732]
                                    STRING [6733,6748]
                                        String: "/transformers" [6733,6748]
                                FIELD [6749,6936]
                                    String: "run" [6749,6754]
                                    STRING [6755,6936]
                                        String: "python3 -m pytest -n 2 --dist=loadfile -v --make-reports=${{ matrix.machine_type }}_tests_gpu_${{ matrix.folders }} ${{ fromJson(needs.setup.outputs.test_map)[matrix.folders] }}\n" [6755,6936]
                            OBJECT [6938,7131]
                                FIELD [6939,6969]
                                    String: "name" [6939,6945]
                                    STRING [6946,6969]
                                        String: "Failure short reports" [6946,6969]
                                FIELD [6970,6993]
                                    String: "if" [6970,6974]
                                    STRING [6975,6993]
                                        String: "${{ failure() }}" [6975,6993]
                                FIELD [6994,7018]
                                    String: "continue-on-error" [6994,7013]
                                    TRUE [7014,7018]
                                FIELD [7019,7130]
                                    String: "run" [7019,7024]
                                    STRING [7025,7130]
                                        String: "cat /transformers/reports/${{ matrix.machine_type }}_tests_gpu_${{ matrix.folders }}/failures_short.txt" [7025,7130]
                            OBJECT [7132,7422]
                                FIELD [7133,7170]
                                    String: "name" [7133,7139]
                                    STRING [7140,7170]
                                        String: "Test suite reports artifacts" [7140,7170]
                                FIELD [7171,7193]
                                    String: "if" [7171,7175]
                                    STRING [7176,7193]
                                        String: "${{ always() }}" [7176,7193]
                                FIELD [7194,7229]
                                    String: "uses" [7194,7200]
                                    STRING [7201,7229]
                                        String: "actions/upload-artifact@v3" [7201,7229]
                                FIELD [7230,7421]
                                    String: "with" [7230,7236]
                                    OBJECT [7237,7421]
                                        FIELD [7238,7330]
                                            String: "name" [7238,7244]
                                            STRING [7245,7330]
                                                String: "${{ matrix.machine_type }}_run_all_tests_gpu_${{ env.matrix_folders }}_test_reports" [7245,7330]
                                        FIELD [7331,7420]
                                            String: "path" [7331,7337]
                                            STRING [7338,7420]
                                                String: "/transformers/reports/${{ matrix.machine_type }}_tests_gpu_${{ matrix.folders }}" [7338,7420]
            FIELD [7425,10715]
                String: "run_tests_multi_gpu" [7425,7446]
                OBJECT [7447,10715]
                    FIELD [7448,7468]
                        String: "name" [7448,7454]
                        STRING [7455,7468]
                            String: "Model tests" [7455,7468]
                    FIELD [7469,7484]
                        String: "needs" [7469,7476]
                        STRING [7477,7484]
                            String: "setup" [7477,7484]
                    FIELD [7485,7555]
                        String: "if" [7485,7489]
                        STRING [7490,7555]
                            String: "contains(fromJson(needs.setup.outputs.matrix), 'dummy') != true" [7490,7555]
                    FIELD [7556,7682]
                        String: "strategy" [7556,7566]
                        OBJECT [7567,7682]
                            FIELD [7568,7585]
                                String: "fail-fast" [7568,7579]
                                FALSE [7580,7585]
                            FIELD [7586,7681]
                                String: "matrix" [7586,7594]
                                OBJECT [7595,7681]
                                    FIELD [7596,7651]
                                        String: "folders" [7596,7605]
                                        STRING [7606,7651]
                                            String: "${{ fromJson(needs.setup.outputs.matrix) }}" [7606,7651]
                                    FIELD [7652,7680]
                                        String: "machine_type" [7652,7666]
                                        ARRAY [7667,7680]
                                            STRING [7668,7679]
                                                String: "multi-gpu" [7668,7679]
                    FIELD [7683,7750]
                        String: "runs-on" [7683,7692]
                        ARRAY [7693,7750]
                            STRING [7694,7707]
                                String: "self-hosted" [7694,7707]
                            STRING [7708,7720]
                                String: "docker-gpu" [7708,7720]
                            STRING [7721,7749]
                                String: "${{ matrix.machine_type }}" [7721,7749]
                    FIELD [7751,7921]
                        String: "container" [7751,7762]
                        OBJECT [7763,7921]
                            FIELD [7764,7821]
                                String: "image" [7764,7771]
                                STRING [7772,7821]
                                    String: "huggingface/transformers-all-latest-gpu-push-ci" [7772,7821]
                            FIELD [7822,7920]
                                String: "options" [7822,7831]
                                STRING [7832,7920]
                                    String: "--gpus all --shm-size \"16gb\" --ipc host -v /mnt/cache/.cache/huggingface:/mnt/cache/" [7832,7920]
                    FIELD [7922,10714]
                        String: "steps" [7922,7929]
                        ARRAY [7930,10714]
                            OBJECT [7931,8648]
                                FIELD [7932,7977]
                                    String: "name" [7932,7938]
                                    STRING [7939,7977]
                                        String: "Prepare custom environment variables" [7939,7977]
                                FIELD [7978,7992]
                                    String: "shell" [7978,7985]
                                    STRING [7986,7992]
                                        String: "bash" [7986,7992]
                                FIELD [7993,8647]
                                    String: "run" [7993,7998]
                                    STRING [7999,8647]
                                        String: "CI_BRANCH_PUSH=${{ github.event.ref }}\nCI_BRANCH_PUSH=${CI_BRANCH_PUSH/'refs/heads/'/''}\nCI_BRANCH_WORKFLOW_RUN=${{ github.event.workflow_run.head_branch }}\nCI_SHA_PUSH=${{ github.event.head_commit.id }}\nCI_SHA_WORKFLOW_RUN=${{ github.event.workflow_run.head_sha }}\necho $CI_BRANCH_PUSH\necho $CI_BRANCH_WORKFLOW_RUN\necho $CI_SHA_PUSH\necho $CI_SHA_WORKFLOW_RUN\n[[ ! -z \"$CI_BRANCH_PUSH\" ]] && echo \"CI_BRANCH=$CI_BRANCH_PUSH\" >> $GITHUB_ENV || echo \"CI_BRANCH=$CI_BRANCH_WORKFLOW_RUN\" >> $GITHUB_ENV\n[[ ! -z \"$CI_SHA_PUSH\" ]] && echo \"CI_SHA=$CI_SHA_PUSH\" >> $GITHUB_ENV || echo \"CI_SHA=$CI_SHA_WORKFLOW_RUN\" >> $GITHUB_ENV\n" [7999,8647]
                            OBJECT [8649,8784]
                                FIELD [8650,8686]
                                    String: "name" [8650,8656]
                                    STRING [8657,8686]
                                        String: "print environment variables" [8657,8686]
                                FIELD [8687,8783]
                                    String: "run" [8687,8692]
                                    STRING [8693,8783]
                                        String: "echo \"env.CI_BRANCH = ${{ env.CI_BRANCH }}\"\necho \"env.CI_SHA = ${{ env.CI_SHA }}\"\n" [8693,8783]
                            OBJECT [8785,9106]
                                FIELD [8786,8835]
                                    String: "name" [8786,8792]
                                    STRING [8793,8835]
                                        String: "Update clone using environment variables" [8793,8835]
                                FIELD [8836,8871]
                                    String: "working-directory" [8836,8855]
                                    STRING [8856,8871]
                                        String: "/transformers" [8856,8871]
                                FIELD [8872,9105]
                                    String: "run" [8872,8877]
                                    STRING [8878,9105]
                                        String: "echo \"original branch = $(git branch --show-current)\"\ngit fetch && git checkout ${{ env.CI_BRANCH }}\necho \"updated branch = $(git branch --show-current)\"\ngit checkout ${{ env.CI_SHA }}\necho \"log = $(git log -n 1)\"\n" [8878,9105]
                            OBJECT [9107,9322]
                                FIELD [9108,9205]
                                    String: "name" [9108,9114]
                                    STRING [9115,9205]
                                        String: "Reinstall transformers in edit mode (remove the one installed during docker image build)" [9115,9205]
                                FIELD [9206,9241]
                                    String: "working-directory" [9206,9225]
                                    STRING [9226,9241]
                                        String: "/transformers" [9226,9241]
                                FIELD [9242,9321]
                                    String: "run" [9242,9247]
                                    STRING [9248,9321]
                                        String: "python3 -m pip uninstall -y transformers && python3 -m pip install -e ." [9248,9321]
                            OBJECT [9323,9669]
                                FIELD [9324,9366]
                                    String: "name" [9324,9330]
                                    STRING [9331,9366]
                                        String: "Echo folder ${{ matrix.folders }}" [9331,9366]
                                FIELD [9367,9381]
                                    String: "shell" [9367,9374]
                                    STRING [9375,9381]
                                        String: "bash" [9375,9381]
                                FIELD [9382,9668]
                                    String: "run" [9382,9387]
                                    STRING [9388,9668]
                                        String: "echo \"${{ matrix.folders }}\"\necho \"${{ fromJson(needs.setup.outputs.test_map)[matrix.folders] }}\"\nmatrix_folders=${{ matrix.folders }}\nmatrix_folders=${matrix_folders/'models/'/'models_'}\necho \"$matrix_folders\"\necho \"matrix_folders=$matrix_folders\" >> $GITHUB_ENV\n" [9388,9668]
                            OBJECT [9670,9712]
                                FIELD [9671,9690]
                                    String: "name" [9671,9677]
                                    STRING [9678,9690]
                                        String: "NVIDIA-SMI" [9678,9690]
                                FIELD [9691,9711]
                                    String: "run" [9691,9696]
                                    STRING [9697,9711]
                                        String: "nvidia-smi\n" [9697,9711]
                            OBJECT [9713,9808]
                                FIELD [9714,9734]
                                    String: "name" [9714,9720]
                                    STRING [9721,9734]
                                        String: "Environment" [9721,9734]
                                FIELD [9735,9770]
                                    String: "working-directory" [9735,9754]
                                    STRING [9755,9770]
                                        String: "/transformers" [9755,9770]
                                FIELD [9771,9807]
                                    String: "run" [9771,9776]
                                    STRING [9777,9807]
                                        String: "python3 utils/print_env.py\n" [9777,9807]
                            OBJECT [9809,9918]
                                FIELD [9810,9862]
                                    String: "name" [9810,9816]
                                    STRING [9817,9862]
                                        String: "Show installed libraries and their versions" [9817,9862]
                                FIELD [9863,9898]
                                    String: "working-directory" [9863,9882]
                                    STRING [9883,9898]
                                        String: "/transformers" [9883,9898]
                                FIELD [9899,9917]
                                    String: "run" [9899,9904]
                                    STRING [9905,9917]
                                        String: "pip freeze" [9905,9917]
                            OBJECT [9919,10228]
                                FIELD [9920,9967]
                                    String: "name" [9920,9926]
                                    STRING [9927,9967]
                                        String: "Run all non-slow selected tests on GPU" [9927,9967]
                                FIELD [9968,10003]
                                    String: "env" [9968,9973]
                                    OBJECT [9974,10003]
                                        FIELD [9975,10002]
                                            String: "MKL_SERVICE_FORCE_INTEL" [9975,10000]
                                            NUMBER [10001,10002]
                                                Number: 1 [10001,10002]
                                FIELD [10004,10039]
                                    String: "working-directory" [10004,10023]
                                    STRING [10024,10039]
                                        String: "/transformers" [10024,10039]
                                FIELD [10040,10227]
                                    String: "run" [10040,10045]
                                    STRING [10046,10227]
                                        String: "python3 -m pytest -n 2 --dist=loadfile -v --make-reports=${{ matrix.machine_type }}_tests_gpu_${{ matrix.folders }} ${{ fromJson(needs.setup.outputs.test_map)[matrix.folders] }}\n" [10046,10227]
                            OBJECT [10229,10422]
                                FIELD [10230,10260]
                                    String: "name" [10230,10236]
                                    STRING [10237,10260]
                                        String: "Failure short reports" [10237,10260]
                                FIELD [10261,10284]
                                    String: "if" [10261,10265]
                                    STRING [10266,10284]
                                        String: "${{ failure() }}" [10266,10284]
                                FIELD [10285,10309]
                                    String: "continue-on-error" [10285,10304]
                                    TRUE [10305,10309]
                                FIELD [10310,10421]
                                    String: "run" [10310,10315]
                                    STRING [10316,10421]
                                        String: "cat /transformers/reports/${{ matrix.machine_type }}_tests_gpu_${{ matrix.folders }}/failures_short.txt" [10316,10421]
                            OBJECT [10423,10713]
                                FIELD [10424,10461]
                                    String: "name" [10424,10430]
                                    STRING [10431,10461]
                                        String: "Test suite reports artifacts" [10431,10461]
                                FIELD [10462,10484]
                                    String: "if" [10462,10466]
                                    STRING [10467,10484]
                                        String: "${{ always() }}" [10467,10484]
                                FIELD [10485,10520]
                                    String: "uses" [10485,10491]
                                    STRING [10492,10520]
                                        String: "actions/upload-artifact@v3" [10492,10520]
                                FIELD [10521,10712]
                                    String: "with" [10521,10527]
                                    OBJECT [10528,10712]
                                        FIELD [10529,10621]
                                            String: "name" [10529,10535]
                                            STRING [10536,10621]
                                                String: "${{ matrix.machine_type }}_run_all_tests_gpu_${{ env.matrix_folders }}_test_reports" [10536,10621]
                                        FIELD [10622,10711]
                                            String: "path" [10622,10628]
                                            STRING [10629,10711]
                                                String: "/transformers/reports/${{ matrix.machine_type }}_tests_gpu_${{ matrix.folders }}" [10629,10711]
            FIELD [10716,14109]
                String: "run_tests_torch_cuda_extensions_single_gpu" [10716,10760]
                OBJECT [10761,14109]
                    FIELD [10762,10797]
                        String: "name" [10762,10768]
                        STRING [10769,10797]
                            String: "Torch CUDA extension tests" [10769,10797]
                    FIELD [10798,10813]
                        String: "needs" [10798,10805]
                        STRING [10806,10813]
                            String: "setup" [10806,10813]
                    FIELD [10814,10942]
                        String: "if" [10814,10818]
                        STRING [10819,10942]
                            String: "contains(fromJson(needs.setup.outputs.matrix), 'deepspeed') || contains(fromJson(needs.setup.outputs.matrix), 'extended')" [10819,10942]
                    FIELD [10943,11014]
                        String: "strategy" [10943,10953]
                        OBJECT [10954,11014]
                            FIELD [10955,10972]
                                String: "fail-fast" [10955,10966]
                                FALSE [10967,10972]
                            FIELD [10973,11013]
                                String: "matrix" [10973,10981]
                                OBJECT [10982,11013]
                                    FIELD [10983,11012]
                                        String: "machine_type" [10983,10997]
                                        ARRAY [10998,11012]
                                            STRING [10999,11011]
                                                String: "single-gpu" [10999,11011]
                    FIELD [11015,11082]
                        String: "runs-on" [11015,11024]
                        ARRAY [11025,11082]
                            STRING [11026,11039]
                                String: "self-hosted" [11026,11039]
                            STRING [11040,11052]
                                String: "docker-gpu" [11040,11052]
                            STRING [11053,11081]
                                String: "${{ matrix.machine_type }}" [11053,11081]
                    FIELD [11083,11265]
                        String: "container" [11083,11094]
                        OBJECT [11095,11265]
                            FIELD [11096,11167]
                                String: "image" [11096,11103]
                                STRING [11104,11167]
                                    String: "huggingface/transformers-pytorch-deepspeed-latest-gpu-push-ci" [11104,11167]
                            FIELD [11168,11264]
                                String: "options" [11168,11177]
                                STRING [11178,11264]
                                    String: "--gpus 0 --shm-size \"16gb\" --ipc host -v /mnt/cache/.cache/huggingface:/mnt/cache/" [11178,11264]
                    FIELD [11266,14108]
                        String: "steps" [11266,11273]
                        ARRAY [11274,14108]
                            OBJECT [11275,11992]
                                FIELD [11276,11321]
                                    String: "name" [11276,11282]
                                    STRING [11283,11321]
                                        String: "Prepare custom environment variables" [11283,11321]
                                FIELD [11322,11336]
                                    String: "shell" [11322,11329]
                                    STRING [11330,11336]
                                        String: "bash" [11330,11336]
                                FIELD [11337,11991]
                                    String: "run" [11337,11342]
                                    STRING [11343,11991]
                                        String: "CI_BRANCH_PUSH=${{ github.event.ref }}\nCI_BRANCH_PUSH=${CI_BRANCH_PUSH/'refs/heads/'/''}\nCI_BRANCH_WORKFLOW_RUN=${{ github.event.workflow_run.head_branch }}\nCI_SHA_PUSH=${{ github.event.head_commit.id }}\nCI_SHA_WORKFLOW_RUN=${{ github.event.workflow_run.head_sha }}\necho $CI_BRANCH_PUSH\necho $CI_BRANCH_WORKFLOW_RUN\necho $CI_SHA_PUSH\necho $CI_SHA_WORKFLOW_RUN\n[[ ! -z \"$CI_BRANCH_PUSH\" ]] && echo \"CI_BRANCH=$CI_BRANCH_PUSH\" >> $GITHUB_ENV || echo \"CI_BRANCH=$CI_BRANCH_WORKFLOW_RUN\" >> $GITHUB_ENV\n[[ ! -z \"$CI_SHA_PUSH\" ]] && echo \"CI_SHA=$CI_SHA_PUSH\" >> $GITHUB_ENV || echo \"CI_SHA=$CI_SHA_WORKFLOW_RUN\" >> $GITHUB_ENV\n" [11343,11991]
                            OBJECT [11993,12128]
                                FIELD [11994,12030]
                                    String: "name" [11994,12000]
                                    STRING [12001,12030]
                                        String: "print environment variables" [12001,12030]
                                FIELD [12031,12127]
                                    String: "run" [12031,12036]
                                    STRING [12037,12127]
                                        String: "echo \"env.CI_BRANCH = ${{ env.CI_BRANCH }}\"\necho \"env.CI_SHA = ${{ env.CI_SHA }}\"\n" [12037,12127]
                            OBJECT [12129,12460]
                                FIELD [12130,12179]
                                    String: "name" [12130,12136]
                                    STRING [12137,12179]
                                        String: "Update clone using environment variables" [12137,12179]
                                FIELD [12180,12225]
                                    String: "working-directory" [12180,12199]
                                    STRING [12200,12225]
                                        String: "/workspace/transformers" [12200,12225]
                                FIELD [12226,12459]
                                    String: "run" [12226,12231]
                                    STRING [12232,12459]
                                        String: "echo \"original branch = $(git branch --show-current)\"\ngit fetch && git checkout ${{ env.CI_BRANCH }}\necho \"updated branch = $(git branch --show-current)\"\ngit checkout ${{ env.CI_SHA }}\necho \"log = $(git log -n 1)\"\n" [12232,12459]
                            OBJECT [12461,12686]
                                FIELD [12462,12559]
                                    String: "name" [12462,12468]
                                    STRING [12469,12559]
                                        String: "Reinstall transformers in edit mode (remove the one installed during docker image build)" [12469,12559]
                                FIELD [12560,12605]
                                    String: "working-directory" [12560,12579]
                                    STRING [12580,12605]
                                        String: "/workspace/transformers" [12580,12605]
                                FIELD [12606,12685]
                                    String: "run" [12606,12611]
                                    STRING [12612,12685]
                                        String: "python3 -m pip uninstall -y transformers && python3 -m pip install -e ." [12612,12685]
                            OBJECT [12687,12781]
                                FIELD [12688,12727]
                                    String: "name" [12688,12694]
                                    STRING [12695,12727]
                                        String: "Remove cached torch extensions" [12695,12727]
                                FIELD [12728,12780]
                                    String: "run" [12728,12733]
                                    STRING [12734,12780]
                                        String: "rm -rf /github/home/.cache/torch_extensions/" [12734,12780]
                            OBJECT [12782,13090]
                                FIELD [12783,12819]
                                    String: "name" [12783,12789]
                                    STRING [12790,12819]
                                        String: "Pre build DeepSpeed *again*" [12790,12819]
                                FIELD [12820,12852]
                                    String: "working-directory" [12820,12839]
                                    STRING [12840,12852]
                                        String: "/workspace" [12840,12852]
                                FIELD [12853,13089]
                                    String: "run" [12853,12858]
                                    STRING [12859,13089]
                                        String: "python3 -m pip uninstall -y deepspeed\nDS_BUILD_CPU_ADAM=1 DS_BUILD_FUSED_ADAM=1 DS_BUILD_UTILS=1 python3 -m pip install deepspeed --global-option=\"build_ext\" --global-option=\"-j8\" --no-cache -v --disable-pip-version-check\n" [12859,13089]
                            OBJECT [13091,13133]
                                FIELD [13092,13111]
                                    String: "name" [13092,13098]
                                    STRING [13099,13111]
                                        String: "NVIDIA-SMI" [13099,13111]
                                FIELD [13112,13132]
                                    String: "run" [13112,13117]
                                    STRING [13118,13132]
                                        String: "nvidia-smi\n" [13118,13132]
                            OBJECT [13134,13238]
                                FIELD [13135,13155]
                                    String: "name" [13135,13141]
                                    STRING [13142,13155]
                                        String: "Environment" [13142,13155]
                                FIELD [13156,13201]
                                    String: "working-directory" [13156,13175]
                                    STRING [13176,13201]
                                        String: "/workspace/transformers" [13176,13201]
                                FIELD [13202,13237]
                                    String: "run" [13202,13207]
                                    STRING [13208,13237]
                                        String: "python utils/print_env.py\n" [13208,13237]
                            OBJECT [13239,13358]
                                FIELD [13240,13292]
                                    String: "name" [13240,13246]
                                    STRING [13247,13292]
                                        String: "Show installed libraries and their versions" [13247,13292]
                                FIELD [13293,13338]
                                    String: "working-directory" [13293,13312]
                                    STRING [13313,13338]
                                        String: "/workspace/transformers" [13313,13338]
                                FIELD [13339,13357]
                                    String: "run" [13339,13344]
                                    STRING [13345,13357]
                                        String: "pip freeze" [13345,13357]
                            OBJECT [13359,13610]
                                FIELD [13360,13407]
                                    String: "name" [13360,13366]
                                    STRING [13367,13407]
                                        String: "Run all non-slow selected tests on GPU" [13367,13407]
                                FIELD [13408,13453]
                                    String: "working-directory" [13408,13427]
                                    STRING [13428,13453]
                                        String: "/workspace/transformers" [13428,13453]
                                FIELD [13454,13609]
                                    String: "run" [13454,13459]
                                    STRING [13460,13609]
                                        String: "python -m pytest -n 1 --dist=loadfile -v --make-reports=${{ matrix.machine_type }}_tests_torch_cuda_extensions_gpu tests/deepspeed tests/extended\n" [13460,13609]
                            OBJECT [13611,13814]
                                FIELD [13612,13642]
                                    String: "name" [13612,13618]
                                    STRING [13619,13642]
                                        String: "Failure short reports" [13619,13642]
                                FIELD [13643,13666]
                                    String: "if" [13643,13647]
                                    STRING [13648,13666]
                                        String: "${{ failure() }}" [13648,13666]
                                FIELD [13667,13691]
                                    String: "continue-on-error" [13667,13686]
                                    TRUE [13687,13691]
                                FIELD [13692,13813]
                                    String: "run" [13692,13697]
                                    STRING [13698,13813]
                                        String: "cat /workspace/transformers/reports/${{ matrix.machine_type }}_tests_torch_cuda_extensions_gpu/failures_short.txt" [13698,13813]
                            OBJECT [13815,14107]
                                FIELD [13816,13853]
                                    String: "name" [13816,13822]
                                    STRING [13823,13853]
                                        String: "Test suite reports artifacts" [13823,13853]
                                FIELD [13854,13876]
                                    String: "if" [13854,13858]
                                    STRING [13859,13876]
                                        String: "${{ always() }}" [13859,13876]
                                FIELD [13877,13912]
                                    String: "uses" [13877,13883]
                                    STRING [13884,13912]
                                        String: "actions/upload-artifact@v3" [13884,13912]
                                FIELD [13913,14106]
                                    String: "with" [13913,13919]
                                    OBJECT [13920,14106]
                                        FIELD [13921,14005]
                                            String: "name" [13921,13927]
                                            STRING [13928,14005]
                                                String: "${{ matrix.machine_type }}_run_tests_torch_cuda_extensions_gpu_test_reports" [13928,14005]
                                        FIELD [14006,14105]
                                            String: "path" [14006,14012]
                                            STRING [14013,14105]
                                                String: "/workspace/transformers/reports/${{ matrix.machine_type }}_tests_torch_cuda_extensions_gpu" [14013,14105]
            FIELD [14110,17503]
                String: "run_tests_torch_cuda_extensions_multi_gpu" [14110,14153]
                OBJECT [14154,17503]
                    FIELD [14155,14190]
                        String: "name" [14155,14161]
                        STRING [14162,14190]
                            String: "Torch CUDA extension tests" [14162,14190]
                    FIELD [14191,14206]
                        String: "needs" [14191,14198]
                        STRING [14199,14206]
                            String: "setup" [14199,14206]
                    FIELD [14207,14335]
                        String: "if" [14207,14211]
                        STRING [14212,14335]
                            String: "contains(fromJson(needs.setup.outputs.matrix), 'deepspeed') || contains(fromJson(needs.setup.outputs.matrix), 'extended')" [14212,14335]
                    FIELD [14336,14406]
                        String: "strategy" [14336,14346]
                        OBJECT [14347,14406]
                            FIELD [14348,14365]
                                String: "fail-fast" [14348,14359]
                                FALSE [14360,14365]
                            FIELD [14366,14405]
                                String: "matrix" [14366,14374]
                                OBJECT [14375,14405]
                                    FIELD [14376,14404]
                                        String: "machine_type" [14376,14390]
                                        ARRAY [14391,14404]
                                            STRING [14392,14403]
                                                String: "multi-gpu" [14392,14403]
                    FIELD [14407,14474]
                        String: "runs-on" [14407,14416]
                        ARRAY [14417,14474]
                            STRING [14418,14431]
                                String: "self-hosted" [14418,14431]
                            STRING [14432,14444]
                                String: "docker-gpu" [14432,14444]
                            STRING [14445,14473]
                                String: "${{ matrix.machine_type }}" [14445,14473]
                    FIELD [14475,14659]
                        String: "container" [14475,14486]
                        OBJECT [14487,14659]
                            FIELD [14488,14559]
                                String: "image" [14488,14495]
                                STRING [14496,14559]
                                    String: "huggingface/transformers-pytorch-deepspeed-latest-gpu-push-ci" [14496,14559]
                            FIELD [14560,14658]
                                String: "options" [14560,14569]
                                STRING [14570,14658]
                                    String: "--gpus all --shm-size \"16gb\" --ipc host -v /mnt/cache/.cache/huggingface:/mnt/cache/" [14570,14658]
                    FIELD [14660,17502]
                        String: "steps" [14660,14667]
                        ARRAY [14668,17502]
                            OBJECT [14669,15386]
                                FIELD [14670,14715]
                                    String: "name" [14670,14676]
                                    STRING [14677,14715]
                                        String: "Prepare custom environment variables" [14677,14715]
                                FIELD [14716,14730]
                                    String: "shell" [14716,14723]
                                    STRING [14724,14730]
                                        String: "bash" [14724,14730]
                                FIELD [14731,15385]
                                    String: "run" [14731,14736]
                                    STRING [14737,15385]
                                        String: "CI_BRANCH_PUSH=${{ github.event.ref }}\nCI_BRANCH_PUSH=${CI_BRANCH_PUSH/'refs/heads/'/''}\nCI_BRANCH_WORKFLOW_RUN=${{ github.event.workflow_run.head_branch }}\nCI_SHA_PUSH=${{ github.event.head_commit.id }}\nCI_SHA_WORKFLOW_RUN=${{ github.event.workflow_run.head_sha }}\necho $CI_BRANCH_PUSH\necho $CI_BRANCH_WORKFLOW_RUN\necho $CI_SHA_PUSH\necho $CI_SHA_WORKFLOW_RUN\n[[ ! -z \"$CI_BRANCH_PUSH\" ]] && echo \"CI_BRANCH=$CI_BRANCH_PUSH\" >> $GITHUB_ENV || echo \"CI_BRANCH=$CI_BRANCH_WORKFLOW_RUN\" >> $GITHUB_ENV\n[[ ! -z \"$CI_SHA_PUSH\" ]] && echo \"CI_SHA=$CI_SHA_PUSH\" >> $GITHUB_ENV || echo \"CI_SHA=$CI_SHA_WORKFLOW_RUN\" >> $GITHUB_ENV\n" [14737,15385]
                            OBJECT [15387,15522]
                                FIELD [15388,15424]
                                    String: "name" [15388,15394]
                                    STRING [15395,15424]
                                        String: "print environment variables" [15395,15424]
                                FIELD [15425,15521]
                                    String: "run" [15425,15430]
                                    STRING [15431,15521]
                                        String: "echo \"env.CI_BRANCH = ${{ env.CI_BRANCH }}\"\necho \"env.CI_SHA = ${{ env.CI_SHA }}\"\n" [15431,15521]
                            OBJECT [15523,15854]
                                FIELD [15524,15573]
                                    String: "name" [15524,15530]
                                    STRING [15531,15573]
                                        String: "Update clone using environment variables" [15531,15573]
                                FIELD [15574,15619]
                                    String: "working-directory" [15574,15593]
                                    STRING [15594,15619]
                                        String: "/workspace/transformers" [15594,15619]
                                FIELD [15620,15853]
                                    String: "run" [15620,15625]
                                    STRING [15626,15853]
                                        String: "echo \"original branch = $(git branch --show-current)\"\ngit fetch && git checkout ${{ env.CI_BRANCH }}\necho \"updated branch = $(git branch --show-current)\"\ngit checkout ${{ env.CI_SHA }}\necho \"log = $(git log -n 1)\"\n" [15626,15853]
                            OBJECT [15855,16080]
                                FIELD [15856,15953]
                                    String: "name" [15856,15862]
                                    STRING [15863,15953]
                                        String: "Reinstall transformers in edit mode (remove the one installed during docker image build)" [15863,15953]
                                FIELD [15954,15999]
                                    String: "working-directory" [15954,15973]
                                    STRING [15974,15999]
                                        String: "/workspace/transformers" [15974,15999]
                                FIELD [16000,16079]
                                    String: "run" [16000,16005]
                                    STRING [16006,16079]
                                        String: "python3 -m pip uninstall -y transformers && python3 -m pip install -e ." [16006,16079]
                            OBJECT [16081,16175]
                                FIELD [16082,16121]
                                    String: "name" [16082,16088]
                                    STRING [16089,16121]
                                        String: "Remove cached torch extensions" [16089,16121]
                                FIELD [16122,16174]
                                    String: "run" [16122,16127]
                                    STRING [16128,16174]
                                        String: "rm -rf /github/home/.cache/torch_extensions/" [16128,16174]
                            OBJECT [16176,16484]
                                FIELD [16177,16213]
                                    String: "name" [16177,16183]
                                    STRING [16184,16213]
                                        String: "Pre build DeepSpeed *again*" [16184,16213]
                                FIELD [16214,16246]
                                    String: "working-directory" [16214,16233]
                                    STRING [16234,16246]
                                        String: "/workspace" [16234,16246]
                                FIELD [16247,16483]
                                    String: "run" [16247,16252]
                                    STRING [16253,16483]
                                        String: "python3 -m pip uninstall -y deepspeed\nDS_BUILD_CPU_ADAM=1 DS_BUILD_FUSED_ADAM=1 DS_BUILD_UTILS=1 python3 -m pip install deepspeed --global-option=\"build_ext\" --global-option=\"-j8\" --no-cache -v --disable-pip-version-check\n" [16253,16483]
                            OBJECT [16485,16527]
                                FIELD [16486,16505]
                                    String: "name" [16486,16492]
                                    STRING [16493,16505]
                                        String: "NVIDIA-SMI" [16493,16505]
                                FIELD [16506,16526]
                                    String: "run" [16506,16511]
                                    STRING [16512,16526]
                                        String: "nvidia-smi\n" [16512,16526]
                            OBJECT [16528,16632]
                                FIELD [16529,16549]
                                    String: "name" [16529,16535]
                                    STRING [16536,16549]
                                        String: "Environment" [16536,16549]
                                FIELD [16550,16595]
                                    String: "working-directory" [16550,16569]
                                    STRING [16570,16595]
                                        String: "/workspace/transformers" [16570,16595]
                                FIELD [16596,16631]
                                    String: "run" [16596,16601]
                                    STRING [16602,16631]
                                        String: "python utils/print_env.py\n" [16602,16631]
                            OBJECT [16633,16752]
                                FIELD [16634,16686]
                                    String: "name" [16634,16640]
                                    STRING [16641,16686]
                                        String: "Show installed libraries and their versions" [16641,16686]
                                FIELD [16687,16732]
                                    String: "working-directory" [16687,16706]
                                    STRING [16707,16732]
                                        String: "/workspace/transformers" [16707,16732]
                                FIELD [16733,16751]
                                    String: "run" [16733,16738]
                                    STRING [16739,16751]
                                        String: "pip freeze" [16739,16751]
                            OBJECT [16753,17004]
                                FIELD [16754,16801]
                                    String: "name" [16754,16760]
                                    STRING [16761,16801]
                                        String: "Run all non-slow selected tests on GPU" [16761,16801]
                                FIELD [16802,16847]
                                    String: "working-directory" [16802,16821]
                                    STRING [16822,16847]
                                        String: "/workspace/transformers" [16822,16847]
                                FIELD [16848,17003]
                                    String: "run" [16848,16853]
                                    STRING [16854,17003]
                                        String: "python -m pytest -n 1 --dist=loadfile -v --make-reports=${{ matrix.machine_type }}_tests_torch_cuda_extensions_gpu tests/deepspeed tests/extended\n" [16854,17003]
                            OBJECT [17005,17208]
                                FIELD [17006,17036]
                                    String: "name" [17006,17012]
                                    STRING [17013,17036]
                                        String: "Failure short reports" [17013,17036]
                                FIELD [17037,17060]
                                    String: "if" [17037,17041]
                                    STRING [17042,17060]
                                        String: "${{ failure() }}" [17042,17060]
                                FIELD [17061,17085]
                                    String: "continue-on-error" [17061,17080]
                                    TRUE [17081,17085]
                                FIELD [17086,17207]
                                    String: "run" [17086,17091]
                                    STRING [17092,17207]
                                        String: "cat /workspace/transformers/reports/${{ matrix.machine_type }}_tests_torch_cuda_extensions_gpu/failures_short.txt" [17092,17207]
                            OBJECT [17209,17501]
                                FIELD [17210,17247]
                                    String: "name" [17210,17216]
                                    STRING [17217,17247]
                                        String: "Test suite reports artifacts" [17217,17247]
                                FIELD [17248,17270]
                                    String: "if" [17248,17252]
                                    STRING [17253,17270]
                                        String: "${{ always() }}" [17253,17270]
                                FIELD [17271,17306]
                                    String: "uses" [17271,17277]
                                    STRING [17278,17306]
                                        String: "actions/upload-artifact@v3" [17278,17306]
                                FIELD [17307,17500]
                                    String: "with" [17307,17313]
                                    OBJECT [17314,17500]
                                        FIELD [17315,17399]
                                            String: "name" [17315,17321]
                                            STRING [17322,17399]
                                                String: "${{ matrix.machine_type }}_run_tests_torch_cuda_extensions_gpu_test_reports" [17322,17399]
                                        FIELD [17400,17499]
                                            String: "path" [17400,17406]
                                            STRING [17407,17499]
                                                String: "/workspace/transformers/reports/${{ matrix.machine_type }}_tests_torch_cuda_extensions_gpu" [17407,17499]
            FIELD [17504,20173]
                String: "send_results" [17504,17518]
                OBJECT [17519,20173]
                    FIELD [17520,17552]
                        String: "name" [17520,17526]
                        STRING [17527,17552]
                            String: "Send results to webhook" [17527,17552]
                    FIELD [17553,17578]
                        String: "runs-on" [17553,17562]
                        STRING [17563,17578]
                            String: "ubuntu-latest" [17563,17578]
                    FIELD [17579,17594]
                        String: "if" [17579,17583]
                        STRING [17584,17594]
                            String: "always()" [17584,17594]
                    FIELD [17595,17784]
                        String: "needs" [17595,17602]
                        ARRAY [17603,17784]
                            STRING [17604,17625]
                                String: "check_runner_status" [17604,17625]
                            STRING [17626,17641]
                                String: "check_runners" [17626,17641]
                            STRING [17642,17649]
                                String: "setup" [17642,17649]
                            STRING [17650,17672]
                                String: "run_tests_single_gpu" [17650,17672]
                            STRING [17673,17694]
                                String: "run_tests_multi_gpu" [17673,17694]
                            STRING [17695,17739]
                                String: "run_tests_torch_cuda_extensions_single_gpu" [17695,17739]
                            STRING [17740,17783]
                                String: "run_tests_torch_cuda_extensions_multi_gpu" [17740,17783]
                    FIELD [17785,20172]
                        String: "steps" [17785,17792]
                        ARRAY [17793,20172]
                            OBJECT [17794,18031]
                                FIELD [17795,17826]
                                    String: "name" [17795,17801]
                                    STRING [17802,17826]
                                        String: "Preliminary job status" [17802,17826]
                                FIELD [17827,17841]
                                    String: "shell" [17827,17834]
                                    STRING [17835,17841]
                                        String: "bash" [17835,17841]
                                FIELD [17842,18030]
                                    String: "run" [17842,17847]
                                    STRING [17848,18030]
                                        String: "echo \"Runner availability: ${{ needs.check_runner_status.result }}\"\necho \"Setup status: ${{ needs.setup.result }}\"\necho \"Runner status: ${{ needs.check_runners.result }}\"\n" [17848,18030]
                            OBJECT [18032,18749]
                                FIELD [18033,18078]
                                    String: "name" [18033,18039]
                                    STRING [18040,18078]
                                        String: "Prepare custom environment variables" [18040,18078]
                                FIELD [18079,18093]
                                    String: "shell" [18079,18086]
                                    STRING [18087,18093]
                                        String: "bash" [18087,18093]
                                FIELD [18094,18748]
                                    String: "run" [18094,18099]
                                    STRING [18100,18748]
                                        String: "CI_BRANCH_PUSH=${{ github.event.ref }}\nCI_BRANCH_PUSH=${CI_BRANCH_PUSH/'refs/heads/'/''}\nCI_BRANCH_WORKFLOW_RUN=${{ github.event.workflow_run.head_branch }}\nCI_SHA_PUSH=${{ github.event.head_commit.id }}\nCI_SHA_WORKFLOW_RUN=${{ github.event.workflow_run.head_sha }}\necho $CI_BRANCH_PUSH\necho $CI_BRANCH_WORKFLOW_RUN\necho $CI_SHA_PUSH\necho $CI_SHA_WORKFLOW_RUN\n[[ ! -z \"$CI_BRANCH_PUSH\" ]] && echo \"CI_BRANCH=$CI_BRANCH_PUSH\" >> $GITHUB_ENV || echo \"CI_BRANCH=$CI_BRANCH_WORKFLOW_RUN\" >> $GITHUB_ENV\n[[ ! -z \"$CI_SHA_PUSH\" ]] && echo \"CI_SHA=$CI_SHA_PUSH\" >> $GITHUB_ENV || echo \"CI_SHA=$CI_SHA_WORKFLOW_RUN\" >> $GITHUB_ENV\n" [18100,18748]
                            OBJECT [18750,18885]
                                FIELD [18751,18787]
                                    String: "name" [18751,18757]
                                    STRING [18758,18787]
                                        String: "print environment variables" [18758,18787]
                                FIELD [18788,18884]
                                    String: "run" [18788,18793]
                                    STRING [18794,18884]
                                        String: "echo \"env.CI_BRANCH = ${{ env.CI_BRANCH }}\"\necho \"env.CI_SHA = ${{ env.CI_SHA }}\"\n" [18794,18884]
                            OBJECT [18886,18942]
                                FIELD [18887,18915]
                                    String: "uses" [18887,18893]
                                    STRING [18894,18915]
                                        String: "actions/checkout@v3" [18894,18915]
                                FIELD [18916,18941]
                                    String: "with" [18916,18922]
                                    OBJECT [18923,18941]
                                        FIELD [18924,18940]
                                            String: "fetch-depth" [18924,18937]
                                            NUMBER [18938,18940]
                                                Number: 20 [18938,18940]
                            OBJECT [18943,19228]
                                FIELD [18944,18993]
                                    String: "name" [18944,18950]
                                    STRING [18951,18993]
                                        String: "Update clone using environment variables" [18951,18993]
                                FIELD [18994,19227]
                                    String: "run" [18994,18999]
                                    STRING [19000,19227]
                                        String: "echo \"original branch = $(git branch --show-current)\"\ngit fetch && git checkout ${{ env.CI_BRANCH }}\necho \"updated branch = $(git branch --show-current)\"\ngit checkout ${{ env.CI_SHA }}\necho \"log = $(git log -n 1)\"\n" [19000,19227]
                            OBJECT [19229,19268]
                                FIELD [19230,19267]
                                    String: "uses" [19230,19236]
                                    STRING [19237,19267]
                                        String: "actions/download-artifact@v3" [19237,19267]
                            OBJECT [19269,20171]
                                FIELD [19270,19300]
                                    String: "name" [19270,19276]
                                    STRING [19277,19300]
                                        String: "Send message to Slack" [19277,19300]
                                FIELD [19301,20044]
                                    String: "env" [19301,19306]
                                    OBJECT [19307,20044]
                                        FIELD [19308,19364]
                                            String: "CI_SLACK_BOT_TOKEN" [19308,19328]
                                            STRING [19329,19364]
                                                String: "${{ secrets.CI_SLACK_BOT_TOKEN }}" [19329,19364]
                                        FIELD [19365,19423]
                                            String: "CI_SLACK_CHANNEL_ID" [19365,19386]
                                            STRING [19387,19423]
                                                String: "${{ secrets.CI_SLACK_CHANNEL_ID }}" [19387,19423]
                                        FIELD [19424,19494]
                                            String: "CI_SLACK_CHANNEL_ID_DAILY" [19424,19451]
                                            STRING [19452,19494]
                                                String: "${{ secrets.CI_SLACK_CHANNEL_ID_DAILY }}" [19452,19494]
                                        FIELD [19495,19571]
                                            String: "CI_SLACK_CHANNEL_DUMMY_TESTS" [19495,19525]
                                            STRING [19526,19571]
                                                String: "${{ secrets.CI_SLACK_CHANNEL_DUMMY_TESTS }}" [19526,19571]
                                        FIELD [19572,19637]
                                            String: "CI_SLACK_REPORT_CHANNEL_ID" [19572,19600]
                                            STRING [19601,19637]
                                                String: "${{ secrets.CI_SLACK_CHANNEL_ID }}" [19601,19637]
                                        FIELD [19638,19702]
                                            String: "ACCESS_REPO_INFO_TOKEN" [19638,19662]
                                            STRING [19663,19702]
                                                String: "${{ secrets.ACCESS_REPO_INFO_TOKEN }}" [19663,19702]
                                        FIELD [19703,19720]
                                            String: "CI_EVENT" [19703,19713]
                                            STRING [19714,19720]
                                                String: "push" [19714,19720]
                                        FIELD [19721,19778]
                                            String: "CI_TITLE_PUSH" [19721,19736]
                                            STRING [19737,19778]
                                                String: "${{ github.event.head_commit.message }}" [19737,19778]
                                        FIELD [19779,19857]
                                            String: "CI_TITLE_WORKFLOW_RUN" [19779,19802]
                                            STRING [19803,19857]
                                                String: "${{ github.event.workflow_run.head_commit.message }}" [19803,19857]
                                        FIELD [19858,19886]
                                            String: "CI_SHA" [19858,19866]
                                            STRING [19867,19886]
                                                String: "${{ env.CI_SHA }}" [19867,19886]
                                        FIELD [19887,19944]
                                            String: "RUNNER_STATUS" [19887,19902]
                                            STRING [19903,19944]
                                                String: "${{ needs.check_runner_status.result }}" [19903,19944]
                                        FIELD [19945,20000]
                                            String: "RUNNER_ENV_STATUS" [19945,19964]
                                            STRING [19965,20000]
                                                String: "${{ needs.check_runners.result }}" [19965,20000]
                                        FIELD [20001,20043]
                                            String: "SETUP_STATUS" [20001,20015]
                                            STRING [20016,20043]
                                                String: "${{ needs.setup.result }}" [20016,20043]
                                FIELD [20045,20170]
                                    String: "run" [20045,20050]
                                    STRING [20051,20170]
                                        String: "pip install slack_sdk\npip show slack_sdk\npython utils/notification_service.py \"${{ needs.setup.outputs.matrix }}\"" [20051,20170]