OBJECT [0,6061]
    FIELD [1,21]
        String: "name" [1,7]
        STRING [8,21]
            String: "Build on M1" [8,21]
    FIELD [22,215]
        String: "on" [22,26]
        OBJECT [27,215]
            FIELD [28,96]
                String: "pull_request" [28,42]
                OBJECT [43,96]
                    FIELD [44,95]
                        String: "paths" [44,51]
                        ARRAY [52,95]
                            STRING [53,94]
                                String: ".github/workflows/build-m1-binaries.yml" [53,94]
            FIELD [97,189]
                String: "push" [97,103]
                OBJECT [104,189]
                    FIELD [105,146]
                        String: "branches" [105,115]
                        ARRAY [116,146]
                            STRING [117,126]
                                String: "nightly" [117,126]
                            STRING [127,133]
                                String: "main" [127,133]
                            STRING [134,145]
                                String: "release/*" [134,145]
                    FIELD [147,188]
                        String: "tags" [147,153]
                        ARRAY [154,188]
                            STRING [155,187]
                                String: "v[0-9]+.[0-9]+.[0-9]+-rc[0-9]+" [155,187]
            FIELD [190,214]
                String: "workflow_dispatch" [190,209]
                NULL [210,214]
    FIELD [216,243]
        String: "env" [216,221]
        OBJECT [222,243]
            FIELD [223,242]
                String: "CHANNEL" [223,232]
                STRING [233,242]
                    String: "nightly" [233,242]
    FIELD [244,6060]
        String: "jobs" [244,250]
        OBJECT [251,6060]
            FIELD [252,3834]
                String: "build_wheels" [252,266]
                OBJECT [267,3834]
                    FIELD [268,304]
                        String: "name" [268,274]
                        STRING [275,304]
                            String: "Build TorchVision M1 wheels" [275,304]
                    FIELD [305,328]
                        String: "runs-on" [305,314]
                        STRING [315,328]
                            String: "macos-m1-12" [315,328]
                    FIELD [329,383]
                        String: "strategy" [329,339]
                        OBJECT [340,383]
                            FIELD [341,382]
                                String: "matrix" [341,349]
                                OBJECT [350,382]
                                    FIELD [351,381]
                                        String: "py_vers" [351,360]
                                        ARRAY [361,381]
                                            STRING [362,367]
                                                String: "3.8" [362,367]
                                            STRING [368,373]
                                                String: "3.9" [368,373]
                                            STRING [374,380]
                                                String: "3.10" [374,380]
                    FIELD [384,3833]
                        String: "steps" [384,391]
                        ARRAY [392,3833]
                            OBJECT [393,452]
                                FIELD [394,422]
                                    String: "name" [394,400]
                                    STRING [401,422]
                                        String: "Checkout repository" [401,422]
                                FIELD [423,451]
                                    String: "uses" [423,429]
                                    STRING [430,451]
                                        String: "actions/checkout@v2" [430,451]
                            OBJECT [453,729]
                                FIELD [454,499]
                                    String: "name" [454,460]
                                    STRING [461,499]
                                        String: "Set CHANNEL (only for tagged pushes)" [461,499]
                                FIELD [500,587]
                                    String: "if" [500,504]
                                    STRING [505,587]
                                        String: "${{ github.event_name == 'push' && startsWith(github.event.ref, 'refs/tags/') }}" [505,587]
                                FIELD [588,728]
                                    String: "run" [588,593]
                                    STRING [594,728]
                                        String: "# reference ends with an RC suffix\nif [[ ${GITHUB_REF_NAME} = *-rc[0-9]* ]]; then\n  echo \"CHANNEL=test\" >> \"$GITHUB_ENV\"\nfi\n" [594,728]
                            OBJECT [730,967]
                                FIELD [731,773]
                                    String: "name" [731,737]
                                    STRING [738,773]
                                        String: "Set Release CHANNEL (for release)" [738,773]
                                FIELD [774,915]
                                    String: "if" [774,778]
                                    STRING [779,915]
                                        String: "${{ (github.event_name == 'pull_request' && startsWith(github.base_ref, 'release')) || startsWith(github.ref, 'refs/heads/release') }}" [779,915]
                                FIELD [916,966]
                                    String: "run" [916,921]
                                    STRING [922,966]
                                        String: "echo \"CHANNEL=test\" >> \"$GITHUB_ENV\"\n" [922,966]
                            OBJECT [968,2179]
                                FIELD [969,1004]
                                    String: "name" [969,975]
                                    STRING [976,1004]
                                        String: "Build TorchVision M1 wheel" [976,1004]
                                FIELD [1005,1040]
                                    String: "shell" [1005,1012]
                                    STRING [1013,1040]
                                        String: "arch -arch arm64 bash {0}" [1013,1040]
                                FIELD [1041,1126]
                                    String: "env" [1041,1046]
                                    OBJECT [1047,1126]
                                        FIELD [1048,1091]
                                            String: "ENV_NAME" [1048,1058]
                                            STRING [1059,1091]
                                                String: "conda-env-${{ github.run_id }}" [1059,1091]
                                        FIELD [1092,1125]
                                            String: "PY_VERS" [1092,1101]
                                            STRING [1102,1125]
                                                String: "${{ matrix.py_vers }}" [1102,1125]
                                FIELD [1127,2178]
                                    String: "run" [1127,1132]
                                    STRING [1133,2178]
                                        String: ". ~/miniconda3/etc/profile.d/conda.sh\n# Needed for JPEG library detection as setup.py detects conda presence by running `shutil.which('conda')`\nexport PATH=~/miniconda3/bin:$PATH\nset -ex\n. packaging/pkg_helpers.bash\n# if we are uploading to test channell, our version consist only of the base: 0.x.x - no date string or suffix added\nif [[ $CHANNEL == \"test\" ]]; then\n  setup_base_build_version\nelse\n  setup_build_version\nfi\n\nconda create -yp ${ENV_NAME} python=${PY_VERS} numpy libpng jpeg wheel pkg-config\nconda run -p ${ENV_NAME} python3 -mpip install torch --pre --extra-index-url=https://download.pytorch.org/whl/${CHANNEL}\nconda run -p ${ENV_NAME} python3 -mpip install delocate\nconda run -p ${ENV_NAME} python3 setup.py bdist_wheel\nexport PYTORCH_VERSION=\"$(conda run -p ${ENV_NAME} python3 -mpip show torch | grep ^Version: | sed 's/Version:  *//')\"\nconda run -p ${ENV_NAME} DYLD_FALLBACK_LIBRARY_PATH=\"${ENV_NAME}/lib\" delocate-wheel -v --ignore-missing-dependencies dist/*.whl\nconda env remove -p ${ENV_NAME}\n" [1133,2178]
                            OBJECT [2180,3207]
                                FIELD [2181,2200]
                                    String: "name" [2181,2187]
                                    STRING [2188,2200]
                                        String: "Test wheel" [2188,2200]
                                FIELD [2201,2236]
                                    String: "shell" [2201,2208]
                                    STRING [2209,2236]
                                        String: "arch -arch arm64 bash {0}" [2209,2236]
                                FIELD [2237,2327]
                                    String: "env" [2237,2242]
                                    OBJECT [2243,2327]
                                        FIELD [2244,2292]
                                            String: "ENV_NAME" [2244,2254]
                                            STRING [2255,2292]
                                                String: "conda-test-env-${{ github.run_id }}" [2255,2292]
                                        FIELD [2293,2326]
                                            String: "PY_VERS" [2293,2302]
                                            STRING [2303,2326]
                                                String: "${{ matrix.py_vers }}" [2303,2326]
                                FIELD [2328,3206]
                                    String: "run" [2328,2333]
                                    STRING [2334,3206]
                                        String: ". ~/miniconda3/etc/profile.d/conda.sh\nset -ex\nconda create -yp ${ENV_NAME} python=${PY_VERS} numpy\nconda run -p ${ENV_NAME} python3 -mpip install torch --pre --extra-index-url=https://download.pytorch.org/whl/${CHANNEL}\nconda run -p ${ENV_NAME} python3 -mpip install dist/*.whl\n# Test torch is importable, by changing cwd and running import commands\nconda run --cwd /tmp -p ${ENV_NAME} python3 -c \"import torchvision;print('torchvision version is ', torchvision.__version__)\"\nconda run --cwd /tmp -p ${ENV_NAME} python3 -c \"import torch;import torchvision;print('Is torchvision useable?', all(x is not None for x in [torch.ops.image.decode_png, torch.ops.torchvision.roi_align]))\"\nconda run --cwd /tmp -p ${ENV_NAME} python3 -c \"import torchvision;print(torchvision.io.read_image('${PWD}/gallery/assets/dog1.jpg').shape)\"\nconda env remove -p ${ENV_NAME}\n" [2334,3206]
                            OBJECT [3208,3357]
                                FIELD [3209,3240]
                                    String: "name" [3209,3215]
                                    STRING [3216,3240]
                                        String: "Upload wheel to GitHub" [3216,3240]
                                FIELD [3241,3276]
                                    String: "uses" [3241,3247]
                                    STRING [3248,3276]
                                        String: "actions/upload-artifact@v3" [3248,3276]
                                FIELD [3277,3356]
                                    String: "with" [3277,3283]
                                    OBJECT [3284,3356]
                                        FIELD [3285,3340]
                                            String: "name" [3285,3291]
                                            STRING [3292,3340]
                                                String: "torchvision-py${{ matrix.py_vers }}-macos11-m1" [3292,3340]
                                        FIELD [3341,3355]
                                            String: "path" [3341,3347]
                                            STRING [3348,3355]
                                                String: "dist/" [3348,3355]
                            OBJECT [3358,3832]
                                FIELD [3359,3386]
                                    String: "name" [3359,3365]
                                    STRING [3366,3386]
                                        String: "Upload wheel to S3" [3366,3386]
                                FIELD [3387,3520]
                                    String: "if" [3387,3391]
                                    STRING [3392,3520]
                                        String: "${{ github.event_name == 'push' && (github.event.ref == 'refs/heads/nightly' || startsWith(github.event.ref, 'refs/tags/')) }}" [3392,3520]
                                FIELD [3521,3556]
                                    String: "shell" [3521,3528]
                                    STRING [3529,3556]
                                        String: "arch -arch arm64 bash {0}" [3529,3556]
                                FIELD [3557,3716]
                                    String: "env" [3557,3562]
                                    OBJECT [3563,3716]
                                        FIELD [3564,3635]
                                            String: "AWS_ACCESS_KEY_ID" [3564,3583]
                                            STRING [3584,3635]
                                                String: "${{ secrets.AWS_PYTORCH_UPLOADER_ACCESS_KEY_ID }}" [3584,3635]
                                        FIELD [3636,3715]
                                            String: "AWS_SECRET_ACCESS_KEY" [3636,3659]
                                            STRING [3660,3715]
                                                String: "${{ secrets.AWS_PYTORCH_UPLOADER_SECRET_ACCESS_KEY }}" [3660,3715]
                                FIELD [3717,3831]
                                    String: "run" [3717,3722]
                                    STRING [3723,3831]
                                        String: "for pkg in dist/*; do\n  aws s3 cp \"$pkg\" \"s3://pytorch/whl/${CHANNEL}/cpu/\" --acl public-read\ndone\n" [3723,3831]
            FIELD [3835,6059]
                String: "build_conda" [3835,3848]
                OBJECT [3849,6059]
                    FIELD [3850,3894]
                        String: "name" [3850,3856]
                        STRING [3857,3894]
                            String: "Build TorchVision M1 conda packages" [3857,3894]
                    FIELD [3895,3918]
                        String: "runs-on" [3895,3904]
                        STRING [3905,3918]
                            String: "macos-m1-12" [3905,3918]
                    FIELD [3919,3973]
                        String: "strategy" [3919,3929]
                        OBJECT [3930,3973]
                            FIELD [3931,3972]
                                String: "matrix" [3931,3939]
                                OBJECT [3940,3972]
                                    FIELD [3941,3971]
                                        String: "py_vers" [3941,3950]
                                        ARRAY [3951,3971]
                                            STRING [3952,3957]
                                                String: "3.8" [3952,3957]
                                            STRING [3958,3963]
                                                String: "3.9" [3958,3963]
                                            STRING [3964,3970]
                                                String: "3.10" [3964,3970]
                    FIELD [3974,6058]
                        String: "steps" [3974,3981]
                        ARRAY [3982,6058]
                            OBJECT [3983,4042]
                                FIELD [3984,4012]
                                    String: "name" [3984,3990]
                                    STRING [3991,4012]
                                        String: "Checkout repository" [3991,4012]
                                FIELD [4013,4041]
                                    String: "uses" [4013,4019]
                                    STRING [4020,4041]
                                        String: "actions/checkout@v2" [4020,4041]
                            OBJECT [4043,4319]
                                FIELD [4044,4089]
                                    String: "name" [4044,4050]
                                    STRING [4051,4089]
                                        String: "Set CHANNEL (only for tagged pushes)" [4051,4089]
                                FIELD [4090,4177]
                                    String: "if" [4090,4094]
                                    STRING [4095,4177]
                                        String: "${{ github.event_name == 'push' && startsWith(github.event.ref, 'refs/tags/') }}" [4095,4177]
                                FIELD [4178,4318]
                                    String: "run" [4178,4183]
                                    STRING [4184,4318]
                                        String: "# reference ends with an RC suffix\nif [[ ${GITHUB_REF_NAME} = *-rc[0-9]* ]]; then\n  echo \"CHANNEL=test\" >> \"$GITHUB_ENV\"\nfi\n" [4184,4318]
                            OBJECT [4320,4557]
                                FIELD [4321,4363]
                                    String: "name" [4321,4327]
                                    STRING [4328,4363]
                                        String: "Set CHANNEL Release (for release)" [4328,4363]
                                FIELD [4364,4505]
                                    String: "if" [4364,4368]
                                    STRING [4369,4505]
                                        String: "${{ (github.event_name == 'pull_request' && startsWith(github.base_ref, 'release')) || startsWith(github.ref, 'refs/heads/release') }}" [4369,4505]
                                FIELD [4506,4556]
                                    String: "run" [4506,4511]
                                    STRING [4512,4556]
                                        String: "echo \"CHANNEL=test\" >> \"$GITHUB_ENV\"\n" [4512,4556]
                            OBJECT [4558,4755]
                                FIELD [4559,4616]
                                    String: "name" [4559,4565]
                                    STRING [4566,4616]
                                        String: "Install conda-build and purge previous artifacts" [4566,4616]
                                FIELD [4617,4652]
                                    String: "shell" [4617,4624]
                                    STRING [4625,4652]
                                        String: "arch -arch arm64 bash {0}" [4625,4652]
                                FIELD [4653,4754]
                                    String: "run" [4653,4658]
                                    STRING [4659,4754]
                                        String: ". ~/miniconda3/etc/profile.d/conda.sh\nconda install -yq conda-build\nconda build purge-all\n" [4659,4754]
                            OBJECT [4756,5377]
                                FIELD [4757,4800]
                                    String: "name" [4757,4763]
                                    STRING [4764,4800]
                                        String: "Build TorchVision M1 conda package" [4764,4800]
                                FIELD [4801,4836]
                                    String: "shell" [4801,4808]
                                    STRING [4809,4836]
                                        String: "arch -arch arm64 bash {0}" [4809,4836]
                                FIELD [4837,4948]
                                    String: "env" [4837,4842]
                                    OBJECT [4843,4948]
                                        FIELD [4844,4887]
                                            String: "ENV_NAME" [4844,4854]
                                            STRING [4855,4887]
                                                String: "conda-env-${{ github.run_id }}" [4855,4887]
                                        FIELD [4888,4928]
                                            String: "PYTHON_VERSION" [4888,4904]
                                            STRING [4905,4928]
                                                String: "${{ matrix.py_vers }}" [4905,4928]
                                        FIELD [4929,4947]
                                            String: "CU_VERSION" [4929,4941]
                                            STRING [4942,4947]
                                                String: "cpu" [4942,4947]
                                FIELD [4949,5376]
                                    String: "run" [4949,4954]
                                    STRING [4955,5376]
                                        String: ". ~/miniconda3/etc/profile.d/conda.sh\nset -ex\n. packaging/pkg_helpers.bash\n\nif [[ $CHANNEL == \"test\" ]]; then\n  setup_base_build_version\nelse\n  setup_build_version\nfi\n\nsetup_conda_pytorch_constraint\nexport SOURCE_ROOT_DIR=$(pwd)\nconda build \\\n  -c defaults \\\n  $CONDA_CHANNEL_FLAGS \\\n  --no-anaconda-upload \\\n  --python \"$PYTHON_VERSION\" \\\n  --output-folder=dist/ \\\n  packaging/torchvision\n" [4955,5376]
                            OBJECT [5378,5535]
                                FIELD [5379,5412]
                                    String: "name" [5379,5385]
                                    STRING [5386,5412]
                                        String: "Upload package to GitHub" [5386,5412]
                                FIELD [5413,5448]
                                    String: "uses" [5413,5419]
                                    STRING [5420,5448]
                                        String: "actions/upload-artifact@v3" [5420,5448]
                                FIELD [5449,5534]
                                    String: "with" [5449,5455]
                                    OBJECT [5456,5534]
                                        FIELD [5457,5518]
                                            String: "name" [5457,5463]
                                            STRING [5464,5518]
                                                String: "torchvision-py${{ matrix.py_vers }}-macos11-m1-conda" [5464,5518]
                                        FIELD [5519,5533]
                                            String: "path" [5519,5525]
                                            STRING [5526,5533]
                                                String: "dist/" [5526,5533]
                            OBJECT [5536,6057]
                                FIELD [5537,5569]
                                    String: "name" [5537,5543]
                                    STRING [5544,5569]
                                        String: "Upload package to conda" [5544,5569]
                                FIELD [5570,5703]
                                    String: "if" [5570,5574]
                                    STRING [5575,5703]
                                        String: "${{ github.event_name == 'push' && (github.event.ref == 'refs/heads/nightly' || startsWith(github.event.ref, 'refs/tags/')) }}" [5575,5703]
                                FIELD [5704,5739]
                                    String: "shell" [5704,5711]
                                    STRING [5712,5739]
                                        String: "arch -arch arm64 bash {0}" [5712,5739]
                                FIELD [5740,5812]
                                    String: "env" [5740,5745]
                                    OBJECT [5746,5812]
                                        FIELD [5747,5811]
                                            String: "CONDA_PYTORCHBOT_TOKEN" [5747,5771]
                                            STRING [5772,5811]
                                                String: "${{ secrets.CONDA_PYTORCHBOT_TOKEN }}" [5772,5811]
                                FIELD [5813,6056]
                                    String: "run" [5813,5818]
                                    STRING [5819,6056]
                                        String: ". ~/miniconda3/etc/profile.d/conda.sh\nconda install -yq anaconda-client\nset -x\nanaconda  -t \"${CONDA_PYTORCHBOT_TOKEN}\" upload ~/miniconda3/conda-bld/osx-arm64/*.tar.bz2 -u \"pytorch-${CHANNEL}\" --label main --no-progress --force" [5819,6056]