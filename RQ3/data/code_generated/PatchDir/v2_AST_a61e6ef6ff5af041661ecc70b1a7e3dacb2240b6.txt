OBJECT [0,6060]
    FIELD [1,21]
        String: "name" [1,7]
        STRING [8,21]
            String: "Build on M1" [8,21]
    FIELD [22,215]
        String: "on" [22,26]
        OBJECT [27,215]
            FIELD [28,96]
                String: "pull_request" [28,42]
                OBJECT [43,96]
                    FIELD [44,95]
                        String: "paths" [44,51]
                        ARRAY [52,95]
                            STRING [53,94]
                                String: ".github/workflows/build-m1-binaries.yml" [53,94]
            FIELD [97,189]
                String: "push" [97,103]
                OBJECT [104,189]
                    FIELD [105,146]
                        String: "branches" [105,115]
                        ARRAY [116,146]
                            STRING [117,126]
                                String: "nightly" [117,126]
                            STRING [127,133]
                                String: "main" [127,133]
                            STRING [134,145]
                                String: "release/*" [134,145]
                    FIELD [147,188]
                        String: "tags" [147,153]
                        ARRAY [154,188]
                            STRING [155,187]
                                String: "v[0-9]+.[0-9]+.[0-9]+-rc[0-9]+" [155,187]
            FIELD [190,214]
                String: "workflow_dispatch" [190,209]
                NULL [210,214]
    FIELD [216,243]
        String: "env" [216,221]
        OBJECT [222,243]
            FIELD [223,242]
                String: "CHANNEL" [223,232]
                STRING [233,242]
                    String: "nightly" [233,242]
    FIELD [244,6059]
        String: "jobs" [244,250]
        OBJECT [251,6059]
            FIELD [252,3833]
                String: "build_wheels" [252,266]
                OBJECT [267,3833]
                    FIELD [268,304]
                        String: "name" [268,274]
                        STRING [275,304]
                            String: "Build TorchVision M1 wheels" [275,304]
                    FIELD [305,328]
                        String: "runs-on" [305,314]
                        STRING [315,328]
                            String: "macos-m1-12" [315,328]
                    FIELD [329,383]
                        String: "strategy" [329,339]
                        OBJECT [340,383]
                            FIELD [341,382]
                                String: "matrix" [341,349]
                                OBJECT [350,382]
                                    FIELD [351,381]
                                        String: "py_vers" [351,360]
                                        ARRAY [361,381]
                                            STRING [362,367]
                                                String: "3.8" [362,367]
                                            STRING [368,373]
                                                String: "3.9" [368,373]
                                            STRING [374,380]
                                                String: "3.10" [374,380]
                    FIELD [384,3832]
                        String: "steps" [384,391]
                        ARRAY [392,3832]
                            OBJECT [393,452]
                                FIELD [394,422]
                                    String: "name" [394,400]
                                    STRING [401,422]
                                        String: "Checkout repository" [401,422]
                                FIELD [423,451]
                                    String: "uses" [423,429]
                                    STRING [430,451]
                                        String: "actions/checkout@v2" [430,451]
                            OBJECT [453,729]
                                FIELD [454,499]
                                    String: "name" [454,460]
                                    STRING [461,499]
                                        String: "Set CHANNEL (only for tagged pushes)" [461,499]
                                FIELD [500,587]
                                    String: "if" [500,504]
                                    STRING [505,587]
                                        String: "${{ github.event_name == 'push' && startsWith(github.event.ref, 'refs/tags/') }}" [505,587]
                                FIELD [588,728]
                                    String: "run" [588,593]
                                    STRING [594,728]
                                        String: "# reference ends with an RC suffix\nif [[ ${GITHUB_REF_NAME} = *-rc[0-9]* ]]; then\n  echo \"CHANNEL=test\" >> \"$GITHUB_ENV\"\nfi\n" [594,728]
                            OBJECT [730,967]
                                FIELD [731,773]
                                    String: "name" [731,737]
                                    STRING [738,773]
                                        String: "Set Release CHANNEL (for release)" [738,773]
                                FIELD [774,915]
                                    String: "if" [774,778]
                                    STRING [779,915]
                                        String: "${{ (github.event_name == 'pull_request' && startsWith(github.base_ref, 'release')) || startsWith(github.ref, 'refs/heads/release') }}" [779,915]
                                FIELD [916,966]
                                    String: "run" [916,921]
                                    STRING [922,966]
                                        String: "echo \"CHANNEL=test\" >> \"$GITHUB_ENV\"\n" [922,966]
                            OBJECT [968,2178]
                                FIELD [969,1004]
                                    String: "name" [969,975]
                                    STRING [976,1004]
                                        String: "Build TorchVision M1 wheel" [976,1004]
                                FIELD [1005,1040]
                                    String: "shell" [1005,1012]
                                    STRING [1013,1040]
                                        String: "arch -arch arm64 bash {0}" [1013,1040]
                                FIELD [1041,1126]
                                    String: "env" [1041,1046]
                                    OBJECT [1047,1126]
                                        FIELD [1048,1091]
                                            String: "ENV_NAME" [1048,1058]
                                            STRING [1059,1091]
                                                String: "conda-env-${{ github.run_id }}" [1059,1091]
                                        FIELD [1092,1125]
                                            String: "PY_VERS" [1092,1101]
                                            STRING [1102,1125]
                                                String: "${{ matrix.py_vers }}" [1102,1125]
                                FIELD [1127,2177]
                                    String: "run" [1127,1132]
                                    STRING [1133,2177]
                                        String: ". ~/miniconda3/etc/profile.d/conda.sh\n# Needed for JPEG library detection as setup.py detects conda presence by running `shlex.which('conda')`\nexport PATH=~/miniconda3/bin:$PATH\nset -ex\n. packaging/pkg_helpers.bash\n# if we are uploading to test channell, our version consist only of the base: 0.x.x - no date string or suffix added\nif [[ $CHANNEL == \"test\" ]]; then\n  setup_base_build_version\nelse\n  setup_build_version\nfi\n\nconda create -yp ${ENV_NAME} python=${PY_VERS} numpy libpng jpeg wheel pkg-config\nconda run -p ${ENV_NAME} python3 -mpip install torch --pre --extra-index-url=https://download.pytorch.org/whl/${CHANNEL}\nconda run -p ${ENV_NAME} python3 -mpip install delocate\nconda run -p ${ENV_NAME} python3 setup.py bdist_wheel\nexport PYTORCH_VERSION=\"$(conda run -p ${ENV_NAME} python3 -mpip show torch | grep ^Version: | sed 's/Version:  *//')\"\nconda run -p ${ENV_NAME} DYLD_FALLBACK_LIBRARY_PATH=\"${ENV_NAME}/lib\" delocate-wheel -v --ignore-missing-dependencies dist/*.whl\nconda env remove -p ${ENV_NAME}\n" [1133,2177]
                            OBJECT [2179,3206]
                                FIELD [2180,2199]
                                    String: "name" [2180,2186]
                                    STRING [2187,2199]
                                        String: "Test wheel" [2187,2199]
                                FIELD [2200,2235]
                                    String: "shell" [2200,2207]
                                    STRING [2208,2235]
                                        String: "arch -arch arm64 bash {0}" [2208,2235]
                                FIELD [2236,2326]
                                    String: "env" [2236,2241]
                                    OBJECT [2242,2326]
                                        FIELD [2243,2291]
                                            String: "ENV_NAME" [2243,2253]
                                            STRING [2254,2291]
                                                String: "conda-test-env-${{ github.run_id }}" [2254,2291]
                                        FIELD [2292,2325]
                                            String: "PY_VERS" [2292,2301]
                                            STRING [2302,2325]
                                                String: "${{ matrix.py_vers }}" [2302,2325]
                                FIELD [2327,3205]
                                    String: "run" [2327,2332]
                                    STRING [2333,3205]
                                        String: ". ~/miniconda3/etc/profile.d/conda.sh\nset -ex\nconda create -yp ${ENV_NAME} python=${PY_VERS} numpy\nconda run -p ${ENV_NAME} python3 -mpip install torch --pre --extra-index-url=https://download.pytorch.org/whl/${CHANNEL}\nconda run -p ${ENV_NAME} python3 -mpip install dist/*.whl\n# Test torch is importable, by changing cwd and running import commands\nconda run --cwd /tmp -p ${ENV_NAME} python3 -c \"import torchvision;print('torchvision version is ', torchvision.__version__)\"\nconda run --cwd /tmp -p ${ENV_NAME} python3 -c \"import torch;import torchvision;print('Is torchvision useable?', all(x is not None for x in [torch.ops.image.decode_png, torch.ops.torchvision.roi_align]))\"\nconda run --cwd /tmp -p ${ENV_NAME} python3 -c \"import torchvision;print(torchvision.io.read_image('${PWD}/gallery/assets/dog1.jpg').shape)\"\nconda env remove -p ${ENV_NAME}\n" [2333,3205]
                            OBJECT [3207,3356]
                                FIELD [3208,3239]
                                    String: "name" [3208,3214]
                                    STRING [3215,3239]
                                        String: "Upload wheel to GitHub" [3215,3239]
                                FIELD [3240,3275]
                                    String: "uses" [3240,3246]
                                    STRING [3247,3275]
                                        String: "actions/upload-artifact@v3" [3247,3275]
                                FIELD [3276,3355]
                                    String: "with" [3276,3282]
                                    OBJECT [3283,3355]
                                        FIELD [3284,3339]
                                            String: "name" [3284,3290]
                                            STRING [3291,3339]
                                                String: "torchvision-py${{ matrix.py_vers }}-macos11-m1" [3291,3339]
                                        FIELD [3340,3354]
                                            String: "path" [3340,3346]
                                            STRING [3347,3354]
                                                String: "dist/" [3347,3354]
                            OBJECT [3357,3831]
                                FIELD [3358,3385]
                                    String: "name" [3358,3364]
                                    STRING [3365,3385]
                                        String: "Upload wheel to S3" [3365,3385]
                                FIELD [3386,3519]
                                    String: "if" [3386,3390]
                                    STRING [3391,3519]
                                        String: "${{ github.event_name == 'push' && (github.event.ref == 'refs/heads/nightly' || startsWith(github.event.ref, 'refs/tags/')) }}" [3391,3519]
                                FIELD [3520,3555]
                                    String: "shell" [3520,3527]
                                    STRING [3528,3555]
                                        String: "arch -arch arm64 bash {0}" [3528,3555]
                                FIELD [3556,3715]
                                    String: "env" [3556,3561]
                                    OBJECT [3562,3715]
                                        FIELD [3563,3634]
                                            String: "AWS_ACCESS_KEY_ID" [3563,3582]
                                            STRING [3583,3634]
                                                String: "${{ secrets.AWS_PYTORCH_UPLOADER_ACCESS_KEY_ID }}" [3583,3634]
                                        FIELD [3635,3714]
                                            String: "AWS_SECRET_ACCESS_KEY" [3635,3658]
                                            STRING [3659,3714]
                                                String: "${{ secrets.AWS_PYTORCH_UPLOADER_SECRET_ACCESS_KEY }}" [3659,3714]
                                FIELD [3716,3830]
                                    String: "run" [3716,3721]
                                    STRING [3722,3830]
                                        String: "for pkg in dist/*; do\n  aws s3 cp \"$pkg\" \"s3://pytorch/whl/${CHANNEL}/cpu/\" --acl public-read\ndone\n" [3722,3830]
            FIELD [3834,6058]
                String: "build_conda" [3834,3847]
                OBJECT [3848,6058]
                    FIELD [3849,3893]
                        String: "name" [3849,3855]
                        STRING [3856,3893]
                            String: "Build TorchVision M1 conda packages" [3856,3893]
                    FIELD [3894,3917]
                        String: "runs-on" [3894,3903]
                        STRING [3904,3917]
                            String: "macos-m1-12" [3904,3917]
                    FIELD [3918,3972]
                        String: "strategy" [3918,3928]
                        OBJECT [3929,3972]
                            FIELD [3930,3971]
                                String: "matrix" [3930,3938]
                                OBJECT [3939,3971]
                                    FIELD [3940,3970]
                                        String: "py_vers" [3940,3949]
                                        ARRAY [3950,3970]
                                            STRING [3951,3956]
                                                String: "3.8" [3951,3956]
                                            STRING [3957,3962]
                                                String: "3.9" [3957,3962]
                                            STRING [3963,3969]
                                                String: "3.10" [3963,3969]
                    FIELD [3973,6057]
                        String: "steps" [3973,3980]
                        ARRAY [3981,6057]
                            OBJECT [3982,4041]
                                FIELD [3983,4011]
                                    String: "name" [3983,3989]
                                    STRING [3990,4011]
                                        String: "Checkout repository" [3990,4011]
                                FIELD [4012,4040]
                                    String: "uses" [4012,4018]
                                    STRING [4019,4040]
                                        String: "actions/checkout@v2" [4019,4040]
                            OBJECT [4042,4318]
                                FIELD [4043,4088]
                                    String: "name" [4043,4049]
                                    STRING [4050,4088]
                                        String: "Set CHANNEL (only for tagged pushes)" [4050,4088]
                                FIELD [4089,4176]
                                    String: "if" [4089,4093]
                                    STRING [4094,4176]
                                        String: "${{ github.event_name == 'push' && startsWith(github.event.ref, 'refs/tags/') }}" [4094,4176]
                                FIELD [4177,4317]
                                    String: "run" [4177,4182]
                                    STRING [4183,4317]
                                        String: "# reference ends with an RC suffix\nif [[ ${GITHUB_REF_NAME} = *-rc[0-9]* ]]; then\n  echo \"CHANNEL=test\" >> \"$GITHUB_ENV\"\nfi\n" [4183,4317]
                            OBJECT [4319,4556]
                                FIELD [4320,4362]
                                    String: "name" [4320,4326]
                                    STRING [4327,4362]
                                        String: "Set CHANNEL Release (for release)" [4327,4362]
                                FIELD [4363,4504]
                                    String: "if" [4363,4367]
                                    STRING [4368,4504]
                                        String: "${{ (github.event_name == 'pull_request' && startsWith(github.base_ref, 'release')) || startsWith(github.ref, 'refs/heads/release') }}" [4368,4504]
                                FIELD [4505,4555]
                                    String: "run" [4505,4510]
                                    STRING [4511,4555]
                                        String: "echo \"CHANNEL=test\" >> \"$GITHUB_ENV\"\n" [4511,4555]
                            OBJECT [4557,4754]
                                FIELD [4558,4615]
                                    String: "name" [4558,4564]
                                    STRING [4565,4615]
                                        String: "Install conda-build and purge previous artifacts" [4565,4615]
                                FIELD [4616,4651]
                                    String: "shell" [4616,4623]
                                    STRING [4624,4651]
                                        String: "arch -arch arm64 bash {0}" [4624,4651]
                                FIELD [4652,4753]
                                    String: "run" [4652,4657]
                                    STRING [4658,4753]
                                        String: ". ~/miniconda3/etc/profile.d/conda.sh\nconda install -yq conda-build\nconda build purge-all\n" [4658,4753]
                            OBJECT [4755,5376]
                                FIELD [4756,4799]
                                    String: "name" [4756,4762]
                                    STRING [4763,4799]
                                        String: "Build TorchVision M1 conda package" [4763,4799]
                                FIELD [4800,4835]
                                    String: "shell" [4800,4807]
                                    STRING [4808,4835]
                                        String: "arch -arch arm64 bash {0}" [4808,4835]
                                FIELD [4836,4947]
                                    String: "env" [4836,4841]
                                    OBJECT [4842,4947]
                                        FIELD [4843,4886]
                                            String: "ENV_NAME" [4843,4853]
                                            STRING [4854,4886]
                                                String: "conda-env-${{ github.run_id }}" [4854,4886]
                                        FIELD [4887,4927]
                                            String: "PYTHON_VERSION" [4887,4903]
                                            STRING [4904,4927]
                                                String: "${{ matrix.py_vers }}" [4904,4927]
                                        FIELD [4928,4946]
                                            String: "CU_VERSION" [4928,4940]
                                            STRING [4941,4946]
                                                String: "cpu" [4941,4946]
                                FIELD [4948,5375]
                                    String: "run" [4948,4953]
                                    STRING [4954,5375]
                                        String: ". ~/miniconda3/etc/profile.d/conda.sh\nset -ex\n. packaging/pkg_helpers.bash\n\nif [[ $CHANNEL == \"test\" ]]; then\n  setup_base_build_version\nelse\n  setup_build_version\nfi\n\nsetup_conda_pytorch_constraint\nexport SOURCE_ROOT_DIR=$(pwd)\nconda build \\\n  -c defaults \\\n  $CONDA_CHANNEL_FLAGS \\\n  --no-anaconda-upload \\\n  --python \"$PYTHON_VERSION\" \\\n  --output-folder=dist/ \\\n  packaging/torchvision\n" [4954,5375]
                            OBJECT [5377,5534]
                                FIELD [5378,5411]
                                    String: "name" [5378,5384]
                                    STRING [5385,5411]
                                        String: "Upload package to GitHub" [5385,5411]
                                FIELD [5412,5447]
                                    String: "uses" [5412,5418]
                                    STRING [5419,5447]
                                        String: "actions/upload-artifact@v3" [5419,5447]
                                FIELD [5448,5533]
                                    String: "with" [5448,5454]
                                    OBJECT [5455,5533]
                                        FIELD [5456,5517]
                                            String: "name" [5456,5462]
                                            STRING [5463,5517]
                                                String: "torchvision-py${{ matrix.py_vers }}-macos11-m1-conda" [5463,5517]
                                        FIELD [5518,5532]
                                            String: "path" [5518,5524]
                                            STRING [5525,5532]
                                                String: "dist/" [5525,5532]
                            OBJECT [5535,6056]
                                FIELD [5536,5568]
                                    String: "name" [5536,5542]
                                    STRING [5543,5568]
                                        String: "Upload package to conda" [5543,5568]
                                FIELD [5569,5702]
                                    String: "if" [5569,5573]
                                    STRING [5574,5702]
                                        String: "${{ github.event_name == 'push' && (github.event.ref == 'refs/heads/nightly' || startsWith(github.event.ref, 'refs/tags/')) }}" [5574,5702]
                                FIELD [5703,5738]
                                    String: "shell" [5703,5710]
                                    STRING [5711,5738]
                                        String: "arch -arch arm64 bash {0}" [5711,5738]
                                FIELD [5739,5811]
                                    String: "env" [5739,5744]
                                    OBJECT [5745,5811]
                                        FIELD [5746,5810]
                                            String: "CONDA_PYTORCHBOT_TOKEN" [5746,5770]
                                            STRING [5771,5810]
                                                String: "${{ secrets.CONDA_PYTORCHBOT_TOKEN }}" [5771,5810]
                                FIELD [5812,6055]
                                    String: "run" [5812,5817]
                                    STRING [5818,6055]
                                        String: ". ~/miniconda3/etc/profile.d/conda.sh\nconda install -yq anaconda-client\nset -x\nanaconda  -t \"${CONDA_PYTORCHBOT_TOKEN}\" upload ~/miniconda3/conda-bld/osx-arm64/*.tar.bz2 -u \"pytorch-${CHANNEL}\" --label main --no-progress --force" [5818,6055]