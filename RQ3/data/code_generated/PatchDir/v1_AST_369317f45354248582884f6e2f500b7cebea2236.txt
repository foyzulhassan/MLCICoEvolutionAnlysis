OBJECT [0,6139]
    FIELD [1,21]
        String: "name" [1,7]
        STRING [8,21]
            String: "Build on M1" [8,21]
    FIELD [22,215]
        String: "on" [22,26]
        OBJECT [27,215]
            FIELD [28,96]
                String: "pull_request" [28,42]
                OBJECT [43,96]
                    FIELD [44,95]
                        String: "paths" [44,51]
                        ARRAY [52,95]
                            STRING [53,94]
                                String: ".github/workflows/build-m1-binaries.yml" [53,94]
            FIELD [97,189]
                String: "push" [97,103]
                OBJECT [104,189]
                    FIELD [105,146]
                        String: "branches" [105,115]
                        ARRAY [116,146]
                            STRING [117,126]
                                String: "nightly" [117,126]
                            STRING [127,133]
                                String: "main" [127,133]
                            STRING [134,145]
                                String: "release/*" [134,145]
                    FIELD [147,188]
                        String: "tags" [147,153]
                        ARRAY [154,188]
                            STRING [155,187]
                                String: "v[0-9]+.[0-9]+.[0-9]+-rc[0-9]+" [155,187]
            FIELD [190,214]
                String: "workflow_dispatch" [190,209]
                NULL [210,214]
    FIELD [216,243]
        String: "env" [216,221]
        OBJECT [222,243]
            FIELD [223,242]
                String: "CHANNEL" [223,232]
                STRING [233,242]
                    String: "nightly" [233,242]
    FIELD [244,6138]
        String: "jobs" [244,250]
        OBJECT [251,6138]
            FIELD [252,3916]
                String: "build_wheels" [252,266]
                OBJECT [267,3916]
                    FIELD [268,304]
                        String: "name" [268,274]
                        STRING [275,304]
                            String: "Build TorchVision M1 wheels" [275,304]
                    FIELD [305,325]
                        String: "runs-on" [305,314]
                        STRING [315,325]
                            String: "macos-m1" [315,325]
                    FIELD [326,380]
                        String: "strategy" [326,336]
                        OBJECT [337,380]
                            FIELD [338,379]
                                String: "matrix" [338,346]
                                OBJECT [347,379]
                                    FIELD [348,378]
                                        String: "py_vers" [348,357]
                                        ARRAY [358,378]
                                            STRING [359,364]
                                                String: "3.8" [359,364]
                                            STRING [365,370]
                                                String: "3.9" [365,370]
                                            STRING [371,377]
                                                String: "3.10" [371,377]
                    FIELD [381,3915]
                        String: "steps" [381,388]
                        ARRAY [389,3915]
                            OBJECT [390,449]
                                FIELD [391,419]
                                    String: "name" [391,397]
                                    STRING [398,419]
                                        String: "Checkout repository" [398,419]
                                FIELD [420,448]
                                    String: "uses" [420,426]
                                    STRING [427,448]
                                        String: "actions/checkout@v2" [427,448]
                            OBJECT [450,726]
                                FIELD [451,496]
                                    String: "name" [451,457]
                                    STRING [458,496]
                                        String: "Set CHANNEL (only for tagged pushes)" [458,496]
                                FIELD [497,584]
                                    String: "if" [497,501]
                                    STRING [502,584]
                                        String: "${{ github.event_name == 'push' && startsWith(github.event.ref, 'refs/tags/') }}" [502,584]
                                FIELD [585,725]
                                    String: "run" [585,590]
                                    STRING [591,725]
                                        String: "# reference ends with an RC suffix\nif [[ ${GITHUB_REF_NAME} = *-rc[0-9]* ]]; then\n  echo \"CHANNEL=test\" >> \"$GITHUB_ENV\"\nfi\n" [591,725]
                            OBJECT [727,953]
                                FIELD [728,770]
                                    String: "name" [728,734]
                                    STRING [735,770]
                                        String: "Set Release CHANNEL (for release)" [735,770]
                                FIELD [771,901]
                                    String: "if" [771,775]
                                    STRING [776,901]
                                        String: "${{ (github.event_name == 'pull_request' && startsWith(github.base_ref, 'release')) || startsWith(github.ref, 'release') }}" [776,901]
                                FIELD [902,952]
                                    String: "run" [902,907]
                                    STRING [908,952]
                                        String: "echo \"CHANNEL=test\" >> \"$GITHUB_ENV\"\n" [908,952]
                            OBJECT [954,2261]
                                FIELD [955,990]
                                    String: "name" [955,961]
                                    STRING [962,990]
                                        String: "Build TorchVision M1 wheel" [962,990]
                                FIELD [991,1026]
                                    String: "shell" [991,998]
                                    STRING [999,1026]
                                        String: "arch -arch arm64 bash {0}" [999,1026]
                                FIELD [1027,1112]
                                    String: "env" [1027,1032]
                                    OBJECT [1033,1112]
                                        FIELD [1034,1077]
                                            String: "ENV_NAME" [1034,1044]
                                            STRING [1045,1077]
                                                String: "conda-env-${{ github.run_id }}" [1045,1077]
                                        FIELD [1078,1111]
                                            String: "PY_VERS" [1078,1087]
                                            STRING [1088,1111]
                                                String: "${{ matrix.py_vers }}" [1088,1111]
                                FIELD [1113,2260]
                                    String: "run" [1113,1118]
                                    STRING [1119,2260]
                                        String: ". ~/miniconda3/etc/profile.d/conda.sh\n# Needed for JPEG library detection as setup.py detects conda presence by running `shlex.which('conda')`\nexport PATH=~/miniconda3/bin:$PATH\nset -ex\n. packaging/pkg_helpers.bash\n# if we are uploading to test channell, our version consist only of the base: 0.x.x - no date string or suffix added\nif [[ $CHANNEL == \"test\" ]]; then\n  setup_base_build_version\nelse\n  setup_build_version\nfi\n\nWHL_NAME=torchvision-${BUILD_VERSION}-cp${PY_VERS/.}-cp${PY_VERS/.}-macosx_11_0_arm64.whl\nconda create -yp ${ENV_NAME} python=${PY_VERS} numpy libpng jpeg wheel pkg-config\nconda run -p ${ENV_NAME} python3 -mpip install torch --pre --extra-index-url=https://download.pytorch.org/whl/${CHANNEL}\nconda run -p ${ENV_NAME} python3 -mpip install delocate\nconda run -p ${ENV_NAME} python3 setup.py bdist_wheel\nexport PYTORCH_VERSION=\"$(conda run -p ${ENV_NAME} python3 -mpip show torch | grep ^Version: | sed 's/Version:  *//')\"\nconda run -p ${ENV_NAME} DYLD_FALLBACK_LIBRARY_PATH=\"${ENV_NAME}/lib\" delocate-wheel -v --ignore-missing-dependencies dist/${WHL_NAME}\nconda env remove -p ${ENV_NAME}\n" [1119,2260]
                            OBJECT [2262,3289]
                                FIELD [2263,2282]
                                    String: "name" [2263,2269]
                                    STRING [2270,2282]
                                        String: "Test wheel" [2270,2282]
                                FIELD [2283,2318]
                                    String: "shell" [2283,2290]
                                    STRING [2291,2318]
                                        String: "arch -arch arm64 bash {0}" [2291,2318]
                                FIELD [2319,2409]
                                    String: "env" [2319,2324]
                                    OBJECT [2325,2409]
                                        FIELD [2326,2374]
                                            String: "ENV_NAME" [2326,2336]
                                            STRING [2337,2374]
                                                String: "conda-test-env-${{ github.run_id }}" [2337,2374]
                                        FIELD [2375,2408]
                                            String: "PY_VERS" [2375,2384]
                                            STRING [2385,2408]
                                                String: "${{ matrix.py_vers }}" [2385,2408]
                                FIELD [2410,3288]
                                    String: "run" [2410,2415]
                                    STRING [2416,3288]
                                        String: ". ~/miniconda3/etc/profile.d/conda.sh\nset -ex\nconda create -yp ${ENV_NAME} python=${PY_VERS} numpy\nconda run -p ${ENV_NAME} python3 -mpip install torch --pre --extra-index-url=https://download.pytorch.org/whl/${CHANNEL}\nconda run -p ${ENV_NAME} python3 -mpip install dist/*.whl\n# Test torch is importable, by changing cwd and running import commands\nconda run --cwd /tmp -p ${ENV_NAME} python3 -c \"import torchvision;print('torchvision version is ', torchvision.__version__)\"\nconda run --cwd /tmp -p ${ENV_NAME} python3 -c \"import torch;import torchvision;print('Is torchvision useable?', all(x is not None for x in [torch.ops.image.decode_png, torch.ops.torchvision.roi_align]))\"\nconda run --cwd /tmp -p ${ENV_NAME} python3 -c \"import torchvision;print(torchvision.io.read_image('${PWD}/gallery/assets/dog1.jpg').shape)\"\nconda env remove -p ${ENV_NAME}\n" [2416,3288]
                            OBJECT [3290,3439]
                                FIELD [3291,3322]
                                    String: "name" [3291,3297]
                                    STRING [3298,3322]
                                        String: "Upload wheel to GitHub" [3298,3322]
                                FIELD [3323,3358]
                                    String: "uses" [3323,3329]
                                    STRING [3330,3358]
                                        String: "actions/upload-artifact@v3" [3330,3358]
                                FIELD [3359,3438]
                                    String: "with" [3359,3365]
                                    OBJECT [3366,3438]
                                        FIELD [3367,3422]
                                            String: "name" [3367,3373]
                                            STRING [3374,3422]
                                                String: "torchvision-py${{ matrix.py_vers }}-macos11-m1" [3374,3422]
                                        FIELD [3423,3437]
                                            String: "path" [3423,3429]
                                            STRING [3430,3437]
                                                String: "dist/" [3430,3437]
                            OBJECT [3440,3914]
                                FIELD [3441,3468]
                                    String: "name" [3441,3447]
                                    STRING [3448,3468]
                                        String: "Upload wheel to S3" [3448,3468]
                                FIELD [3469,3602]
                                    String: "if" [3469,3473]
                                    STRING [3474,3602]
                                        String: "${{ github.event_name == 'push' && (github.event.ref == 'refs/heads/nightly' || startsWith(github.event.ref, 'refs/tags/')) }}" [3474,3602]
                                FIELD [3603,3638]
                                    String: "shell" [3603,3610]
                                    STRING [3611,3638]
                                        String: "arch -arch arm64 bash {0}" [3611,3638]
                                FIELD [3639,3798]
                                    String: "env" [3639,3644]
                                    OBJECT [3645,3798]
                                        FIELD [3646,3717]
                                            String: "AWS_ACCESS_KEY_ID" [3646,3665]
                                            STRING [3666,3717]
                                                String: "${{ secrets.AWS_PYTORCH_UPLOADER_ACCESS_KEY_ID }}" [3666,3717]
                                        FIELD [3718,3797]
                                            String: "AWS_SECRET_ACCESS_KEY" [3718,3741]
                                            STRING [3742,3797]
                                                String: "${{ secrets.AWS_PYTORCH_UPLOADER_SECRET_ACCESS_KEY }}" [3742,3797]
                                FIELD [3799,3913]
                                    String: "run" [3799,3804]
                                    STRING [3805,3913]
                                        String: "for pkg in dist/*; do\n  aws s3 cp \"$pkg\" \"s3://pytorch/whl/${CHANNEL}/cpu/\" --acl public-read\ndone\n" [3805,3913]
            FIELD [3917,6137]
                String: "build_conda" [3917,3930]
                OBJECT [3931,6137]
                    FIELD [3932,3976]
                        String: "name" [3932,3938]
                        STRING [3939,3976]
                            String: "Build TorchVision M1 conda packages" [3939,3976]
                    FIELD [3977,3997]
                        String: "runs-on" [3977,3986]
                        STRING [3987,3997]
                            String: "macos-m1" [3987,3997]
                    FIELD [3998,4052]
                        String: "strategy" [3998,4008]
                        OBJECT [4009,4052]
                            FIELD [4010,4051]
                                String: "matrix" [4010,4018]
                                OBJECT [4019,4051]
                                    FIELD [4020,4050]
                                        String: "py_vers" [4020,4029]
                                        ARRAY [4030,4050]
                                            STRING [4031,4036]
                                                String: "3.8" [4031,4036]
                                            STRING [4037,4042]
                                                String: "3.9" [4037,4042]
                                            STRING [4043,4049]
                                                String: "3.10" [4043,4049]
                    FIELD [4053,6136]
                        String: "steps" [4053,4060]
                        ARRAY [4061,6136]
                            OBJECT [4062,4121]
                                FIELD [4063,4091]
                                    String: "name" [4063,4069]
                                    STRING [4070,4091]
                                        String: "Checkout repository" [4070,4091]
                                FIELD [4092,4120]
                                    String: "uses" [4092,4098]
                                    STRING [4099,4120]
                                        String: "actions/checkout@v2" [4099,4120]
                            OBJECT [4122,4398]
                                FIELD [4123,4168]
                                    String: "name" [4123,4129]
                                    STRING [4130,4168]
                                        String: "Set CHANNEL (only for tagged pushes)" [4130,4168]
                                FIELD [4169,4256]
                                    String: "if" [4169,4173]
                                    STRING [4174,4256]
                                        String: "${{ github.event_name == 'push' && startsWith(github.event.ref, 'refs/tags/') }}" [4174,4256]
                                FIELD [4257,4397]
                                    String: "run" [4257,4262]
                                    STRING [4263,4397]
                                        String: "# reference ends with an RC suffix\nif [[ ${GITHUB_REF_NAME} = *-rc[0-9]* ]]; then\n  echo \"CHANNEL=test\" >> \"$GITHUB_ENV\"\nfi\n" [4263,4397]
                            OBJECT [4399,4625]
                                FIELD [4400,4442]
                                    String: "name" [4400,4406]
                                    STRING [4407,4442]
                                        String: "Set CHANNEL Release (for release)" [4407,4442]
                                FIELD [4443,4573]
                                    String: "if" [4443,4447]
                                    STRING [4448,4573]
                                        String: "${{ (github.event_name == 'pull_request' && startsWith(github.base_ref, 'release')) || startsWith(github.ref, 'release') }}" [4448,4573]
                                FIELD [4574,4624]
                                    String: "run" [4574,4579]
                                    STRING [4580,4624]
                                        String: "echo \"CHANNEL=test\" >> \"$GITHUB_ENV\"\n" [4580,4624]
                            OBJECT [4626,4823]
                                FIELD [4627,4684]
                                    String: "name" [4627,4633]
                                    STRING [4634,4684]
                                        String: "Install conda-build and purge previous artifacts" [4634,4684]
                                FIELD [4685,4720]
                                    String: "shell" [4685,4692]
                                    STRING [4693,4720]
                                        String: "arch -arch arm64 bash {0}" [4693,4720]
                                FIELD [4721,4822]
                                    String: "run" [4721,4726]
                                    STRING [4727,4822]
                                        String: ". ~/miniconda3/etc/profile.d/conda.sh\nconda install -yq conda-build\nconda build purge-all\n" [4727,4822]
                            OBJECT [4824,5455]
                                FIELD [4825,4868]
                                    String: "name" [4825,4831]
                                    STRING [4832,4868]
                                        String: "Build TorchVision M1 conda package" [4832,4868]
                                FIELD [4869,4904]
                                    String: "shell" [4869,4876]
                                    STRING [4877,4904]
                                        String: "arch -arch arm64 bash {0}" [4877,4904]
                                FIELD [4905,5016]
                                    String: "env" [4905,4910]
                                    OBJECT [4911,5016]
                                        FIELD [4912,4955]
                                            String: "ENV_NAME" [4912,4922]
                                            STRING [4923,4955]
                                                String: "conda-env-${{ github.run_id }}" [4923,4955]
                                        FIELD [4956,4996]
                                            String: "PYTHON_VERSION" [4956,4972]
                                            STRING [4973,4996]
                                                String: "${{ matrix.py_vers }}" [4973,4996]
                                        FIELD [4997,5015]
                                            String: "CU_VERSION" [4997,5009]
                                            STRING [5010,5015]
                                                String: "cpu" [5010,5015]
                                FIELD [5017,5454]
                                    String: "run" [5017,5022]
                                    STRING [5023,5454]
                                        String: ". ~/miniconda3/etc/profile.d/conda.sh\nset -ex\n. packaging/pkg_helpers.bash\n\nif [[ $CHANNEL == \"test\" ]]; then\n  setup_base_build_version\nelse\n  setup_build_version\nfi\n\nsetup_conda_pytorch_constraint\nexport SOURCE_ROOT_DIR=$(pwd)\nconda build -c defaults $CONDA_CHANNEL_FLAGS --no-anaconda-upload --python \"$PYTHON_VERSION\" packaging/torchvision\nmkdir -p dist\ncp ~/miniconda3/conda-bld/osx-arm64/*.tar.bz2 dist/\n" [5023,5454]
                            OBJECT [5456,5613]
                                FIELD [5457,5490]
                                    String: "name" [5457,5463]
                                    STRING [5464,5490]
                                        String: "Upload package to GitHub" [5464,5490]
                                FIELD [5491,5526]
                                    String: "uses" [5491,5497]
                                    STRING [5498,5526]
                                        String: "actions/upload-artifact@v3" [5498,5526]
                                FIELD [5527,5612]
                                    String: "with" [5527,5533]
                                    OBJECT [5534,5612]
                                        FIELD [5535,5596]
                                            String: "name" [5535,5541]
                                            STRING [5542,5596]
                                                String: "torchvision-py${{ matrix.py_vers }}-macos11-m1-conda" [5542,5596]
                                        FIELD [5597,5611]
                                            String: "path" [5597,5603]
                                            STRING [5604,5611]
                                                String: "dist/" [5604,5611]
                            OBJECT [5614,6135]
                                FIELD [5615,5647]
                                    String: "name" [5615,5621]
                                    STRING [5622,5647]
                                        String: "Upload package to conda" [5622,5647]
                                FIELD [5648,5781]
                                    String: "if" [5648,5652]
                                    STRING [5653,5781]
                                        String: "${{ github.event_name == 'push' && (github.event.ref == 'refs/heads/nightly' || startsWith(github.event.ref, 'refs/tags/')) }}" [5653,5781]
                                FIELD [5782,5817]
                                    String: "shell" [5782,5789]
                                    STRING [5790,5817]
                                        String: "arch -arch arm64 bash {0}" [5790,5817]
                                FIELD [5818,5890]
                                    String: "env" [5818,5823]
                                    OBJECT [5824,5890]
                                        FIELD [5825,5889]
                                            String: "CONDA_PYTORCHBOT_TOKEN" [5825,5849]
                                            STRING [5850,5889]
                                                String: "${{ secrets.CONDA_PYTORCHBOT_TOKEN }}" [5850,5889]
                                FIELD [5891,6134]
                                    String: "run" [5891,5896]
                                    STRING [5897,6134]
                                        String: ". ~/miniconda3/etc/profile.d/conda.sh\nconda install -yq anaconda-client\nset -x\nanaconda  -t \"${CONDA_PYTORCHBOT_TOKEN}\" upload ~/miniconda3/conda-bld/osx-arm64/*.tar.bz2 -u \"pytorch-${CHANNEL}\" --label main --no-progress --force" [5897,6134]