OBJECT [0,5583]
    FIELD [1,21]
        String: "name" [1,7]
        STRING [8,21]
            String: "Build on M1" [8,21]
    FIELD [22,215]
        String: "on" [22,26]
        OBJECT [27,215]
            FIELD [28,96]
                String: "pull_request" [28,42]
                OBJECT [43,96]
                    FIELD [44,95]
                        String: "paths" [44,51]
                        ARRAY [52,95]
                            STRING [53,94]
                                String: ".github/workflows/build-m1-binaries.yml" [53,94]
            FIELD [97,189]
                String: "push" [97,103]
                OBJECT [104,189]
                    FIELD [105,146]
                        String: "branches" [105,115]
                        ARRAY [116,146]
                            STRING [117,126]
                                String: "nightly" [117,126]
                            STRING [127,133]
                                String: "main" [127,133]
                            STRING [134,145]
                                String: "release/*" [134,145]
                    FIELD [147,188]
                        String: "tags" [147,153]
                        ARRAY [154,188]
                            STRING [155,187]
                                String: "v[0-9]+.[0-9]+.[0-9]+-rc[0-9]+" [155,187]
            FIELD [190,214]
                String: "workflow_dispatch" [190,209]
                NULL [210,214]
    FIELD [216,243]
        String: "env" [216,221]
        OBJECT [222,243]
            FIELD [223,242]
                String: "CHANNEL" [223,232]
                STRING [233,242]
                    String: "nightly" [233,242]
    FIELD [244,5582]
        String: "jobs" [244,250]
        OBJECT [251,5582]
            FIELD [252,3337]
                String: "build_wheels" [252,266]
                OBJECT [267,3337]
                    FIELD [268,304]
                        String: "name" [268,274]
                        STRING [275,304]
                            String: "Build TorchVision M1 wheels" [275,304]
                    FIELD [305,328]
                        String: "runs-on" [305,314]
                        STRING [315,328]
                            String: "macos-m1-12" [315,328]
                    FIELD [329,383]
                        String: "strategy" [329,339]
                        OBJECT [340,383]
                            FIELD [341,382]
                                String: "matrix" [341,349]
                                OBJECT [350,382]
                                    FIELD [351,381]
                                        String: "py_vers" [351,360]
                                        ARRAY [361,381]
                                            STRING [362,367]
                                                String: "3.8" [362,367]
                                            STRING [368,373]
                                                String: "3.9" [368,373]
                                            STRING [374,380]
                                                String: "3.10" [374,380]
                    FIELD [384,3336]
                        String: "steps" [384,391]
                        ARRAY [392,3336]
                            OBJECT [393,452]
                                FIELD [394,422]
                                    String: "name" [394,400]
                                    STRING [401,422]
                                        String: "Checkout repository" [401,422]
                                FIELD [423,451]
                                    String: "uses" [423,429]
                                    STRING [430,451]
                                        String: "actions/checkout@v2" [430,451]
                            OBJECT [453,729]
                                FIELD [454,499]
                                    String: "name" [454,460]
                                    STRING [461,499]
                                        String: "Set CHANNEL (only for tagged pushes)" [461,499]
                                FIELD [500,587]
                                    String: "if" [500,504]
                                    STRING [505,587]
                                        String: "${{ github.event_name == 'push' && startsWith(github.event.ref, 'refs/tags/') }}" [505,587]
                                FIELD [588,728]
                                    String: "run" [588,593]
                                    STRING [594,728]
                                        String: "# reference ends with an RC suffix\nif [[ ${GITHUB_REF_NAME} = *-rc[0-9]* ]]; then\n  echo \"CHANNEL=test\" >> \"$GITHUB_ENV\"\nfi\n" [594,728]
                            OBJECT [730,967]
                                FIELD [731,773]
                                    String: "name" [731,737]
                                    STRING [738,773]
                                        String: "Set Release CHANNEL (for release)" [738,773]
                                FIELD [774,915]
                                    String: "if" [774,778]
                                    STRING [779,915]
                                        String: "${{ (github.event_name == 'pull_request' && startsWith(github.base_ref, 'release')) || startsWith(github.ref, 'refs/heads/release') }}" [779,915]
                                FIELD [916,966]
                                    String: "run" [916,921]
                                    STRING [922,966]
                                        String: "echo \"CHANNEL=test\" >> \"$GITHUB_ENV\"\n" [922,966]
                            OBJECT [968,1059]
                                FIELD [969,993]
                                    String: "name" [969,975]
                                    STRING [976,993]
                                        String: "Setup miniconda" [976,993]
                                FIELD [994,1058]
                                    String: "uses" [994,1000]
                                    STRING [1001,1058]
                                        String: "pytorch/test-infra/.github/actions/setup-miniconda@main" [1001,1058]
                            OBJECT [1060,2196]
                                FIELD [1061,1096]
                                    String: "name" [1061,1067]
                                    STRING [1068,1096]
                                        String: "Build TorchVision M1 wheel" [1068,1096]
                                FIELD [1097,1132]
                                    String: "shell" [1097,1104]
                                    STRING [1105,1132]
                                        String: "arch -arch arm64 bash {0}" [1105,1132]
                                FIELD [1133,1218]
                                    String: "env" [1133,1138]
                                    OBJECT [1139,1218]
                                        FIELD [1140,1183]
                                            String: "ENV_NAME" [1140,1150]
                                            STRING [1151,1183]
                                                String: "conda-env-${{ github.run_id }}" [1151,1183]
                                        FIELD [1184,1217]
                                            String: "PY_VERS" [1184,1193]
                                            STRING [1194,1217]
                                                String: "${{ matrix.py_vers }}" [1194,1217]
                                FIELD [1219,2195]
                                    String: "run" [1219,1224]
                                    STRING [1225,2195]
                                        String: "# Needed for JPEG library detection as setup.py detects conda presence by running `shutil.which('conda')`\nset -ex\n. packaging/pkg_helpers.bash\n# if we are uploading to test channell, our version consist only of the base: 0.x.x - no date string or suffix added\nif [[ $CHANNEL == \"test\" ]]; then\n  setup_base_build_version\nelse\n  setup_build_version\nfi\n\nconda create -yp ${ENV_NAME} python=${PY_VERS} numpy libpng jpeg wheel pkg-config\nconda run -p ${ENV_NAME} python3 -mpip install torch --pre --extra-index-url=https://download.pytorch.org/whl/${CHANNEL}\nconda run -p ${ENV_NAME} python3 -mpip install delocate\nconda run -p ${ENV_NAME} python3 setup.py bdist_wheel\nexport PYTORCH_VERSION=\"$(conda run -p ${ENV_NAME} python3 -mpip show torch | grep ^Version: | sed 's/Version:  *//')\"\nconda run -p ${ENV_NAME} DYLD_FALLBACK_LIBRARY_PATH=\"${ENV_NAME}/lib\" delocate-wheel -v --ignore-missing-dependencies dist/*.whl\nconda env remove -p ${ENV_NAME}\n" [1225,2195]
                            OBJECT [2197,3185]
                                FIELD [2198,2217]
                                    String: "name" [2198,2204]
                                    STRING [2205,2217]
                                        String: "Test wheel" [2205,2217]
                                FIELD [2218,2253]
                                    String: "shell" [2218,2225]
                                    STRING [2226,2253]
                                        String: "arch -arch arm64 bash {0}" [2226,2253]
                                FIELD [2254,2344]
                                    String: "env" [2254,2259]
                                    OBJECT [2260,2344]
                                        FIELD [2261,2309]
                                            String: "ENV_NAME" [2261,2271]
                                            STRING [2272,2309]
                                                String: "conda-test-env-${{ github.run_id }}" [2272,2309]
                                        FIELD [2310,2343]
                                            String: "PY_VERS" [2310,2319]
                                            STRING [2320,2343]
                                                String: "${{ matrix.py_vers }}" [2320,2343]
                                FIELD [2345,3184]
                                    String: "run" [2345,2350]
                                    STRING [2351,3184]
                                        String: "set -ex\nconda create -yp ${ENV_NAME} python=${PY_VERS} numpy\nconda run -p ${ENV_NAME} python3 -mpip install torch --pre --extra-index-url=https://download.pytorch.org/whl/${CHANNEL}\nconda run -p ${ENV_NAME} python3 -mpip install dist/*.whl\n# Test torch is importable, by changing cwd and running import commands\nconda run --cwd /tmp -p ${ENV_NAME} python3 -c \"import torchvision;print('torchvision version is ', torchvision.__version__)\"\nconda run --cwd /tmp -p ${ENV_NAME} python3 -c \"import torch;import torchvision;print('Is torchvision useable?', all(x is not None for x in [torch.ops.image.decode_png, torch.ops.torchvision.roi_align]))\"\nconda run --cwd /tmp -p ${ENV_NAME} python3 -c \"import torchvision;print(torchvision.io.read_image('${PWD}/gallery/assets/dog1.jpg').shape)\"\nconda env remove -p ${ENV_NAME}\n" [2351,3184]
                            OBJECT [3186,3335]
                                FIELD [3187,3218]
                                    String: "name" [3187,3193]
                                    STRING [3194,3218]
                                        String: "Upload wheel to GitHub" [3194,3218]
                                FIELD [3219,3254]
                                    String: "uses" [3219,3225]
                                    STRING [3226,3254]
                                        String: "actions/upload-artifact@v3" [3226,3254]
                                FIELD [3255,3334]
                                    String: "with" [3255,3261]
                                    OBJECT [3262,3334]
                                        FIELD [3263,3318]
                                            String: "name" [3263,3269]
                                            STRING [3270,3318]
                                                String: "torchvision-py${{ matrix.py_vers }}-macos11-m1" [3270,3318]
                                        FIELD [3319,3333]
                                            String: "path" [3319,3325]
                                            STRING [3326,3333]
                                                String: "dist/" [3326,3333]
            FIELD [3338,5581]
                String: "build_conda" [3338,3351]
                OBJECT [3352,5581]
                    FIELD [3353,3397]
                        String: "name" [3353,3359]
                        STRING [3360,3397]
                            String: "Build TorchVision M1 conda packages" [3360,3397]
                    FIELD [3398,3421]
                        String: "runs-on" [3398,3407]
                        STRING [3408,3421]
                            String: "macos-m1-12" [3408,3421]
                    FIELD [3422,3476]
                        String: "strategy" [3422,3432]
                        OBJECT [3433,3476]
                            FIELD [3434,3475]
                                String: "matrix" [3434,3442]
                                OBJECT [3443,3475]
                                    FIELD [3444,3474]
                                        String: "py_vers" [3444,3453]
                                        ARRAY [3454,3474]
                                            STRING [3455,3460]
                                                String: "3.8" [3455,3460]
                                            STRING [3461,3466]
                                                String: "3.9" [3461,3466]
                                            STRING [3467,3473]
                                                String: "3.10" [3467,3473]
                    FIELD [3477,5580]
                        String: "steps" [3477,3484]
                        ARRAY [3485,5580]
                            OBJECT [3486,3545]
                                FIELD [3487,3515]
                                    String: "name" [3487,3493]
                                    STRING [3494,3515]
                                        String: "Checkout repository" [3494,3515]
                                FIELD [3516,3544]
                                    String: "uses" [3516,3522]
                                    STRING [3523,3544]
                                        String: "actions/checkout@v2" [3523,3544]
                            OBJECT [3546,3822]
                                FIELD [3547,3592]
                                    String: "name" [3547,3553]
                                    STRING [3554,3592]
                                        String: "Set CHANNEL (only for tagged pushes)" [3554,3592]
                                FIELD [3593,3680]
                                    String: "if" [3593,3597]
                                    STRING [3598,3680]
                                        String: "${{ github.event_name == 'push' && startsWith(github.event.ref, 'refs/tags/') }}" [3598,3680]
                                FIELD [3681,3821]
                                    String: "run" [3681,3686]
                                    STRING [3687,3821]
                                        String: "# reference ends with an RC suffix\nif [[ ${GITHUB_REF_NAME} = *-rc[0-9]* ]]; then\n  echo \"CHANNEL=test\" >> \"$GITHUB_ENV\"\nfi\n" [3687,3821]
                            OBJECT [3823,4060]
                                FIELD [3824,3866]
                                    String: "name" [3824,3830]
                                    STRING [3831,3866]
                                        String: "Set CHANNEL Release (for release)" [3831,3866]
                                FIELD [3867,4008]
                                    String: "if" [3867,3871]
                                    STRING [3872,4008]
                                        String: "${{ (github.event_name == 'pull_request' && startsWith(github.base_ref, 'release')) || startsWith(github.ref, 'refs/heads/release') }}" [3872,4008]
                                FIELD [4009,4059]
                                    String: "run" [4009,4014]
                                    STRING [4015,4059]
                                        String: "echo \"CHANNEL=test\" >> \"$GITHUB_ENV\"\n" [4015,4059]
                            OBJECT [4061,4152]
                                FIELD [4062,4086]
                                    String: "name" [4062,4068]
                                    STRING [4069,4086]
                                        String: "Setup miniconda" [4069,4086]
                                FIELD [4087,4151]
                                    String: "uses" [4087,4093]
                                    STRING [4094,4151]
                                        String: "pytorch/test-infra/.github/actions/setup-miniconda@main" [4094,4151]
                            OBJECT [4153,4311]
                                FIELD [4154,4211]
                                    String: "name" [4154,4160]
                                    STRING [4161,4211]
                                        String: "Install conda-build and purge previous artifacts" [4161,4211]
                                FIELD [4212,4247]
                                    String: "shell" [4212,4219]
                                    STRING [4220,4247]
                                        String: "arch -arch arm64 bash {0}" [4220,4247]
                                FIELD [4248,4310]
                                    String: "run" [4248,4253]
                                    STRING [4254,4310]
                                        String: "conda install -yq conda-build\nconda build purge-all\n" [4254,4310]
                            OBJECT [4312,4894]
                                FIELD [4313,4356]
                                    String: "name" [4313,4319]
                                    STRING [4320,4356]
                                        String: "Build TorchVision M1 conda package" [4320,4356]
                                FIELD [4357,4392]
                                    String: "shell" [4357,4364]
                                    STRING [4365,4392]
                                        String: "arch -arch arm64 bash {0}" [4365,4392]
                                FIELD [4393,4504]
                                    String: "env" [4393,4398]
                                    OBJECT [4399,4504]
                                        FIELD [4400,4443]
                                            String: "ENV_NAME" [4400,4410]
                                            STRING [4411,4443]
                                                String: "conda-env-${{ github.run_id }}" [4411,4443]
                                        FIELD [4444,4484]
                                            String: "PYTHON_VERSION" [4444,4460]
                                            STRING [4461,4484]
                                                String: "${{ matrix.py_vers }}" [4461,4484]
                                        FIELD [4485,4503]
                                            String: "CU_VERSION" [4485,4497]
                                            STRING [4498,4503]
                                                String: "cpu" [4498,4503]
                                FIELD [4505,4893]
                                    String: "run" [4505,4510]
                                    STRING [4511,4893]
                                        String: "set -ex\n. packaging/pkg_helpers.bash\n\nif [[ $CHANNEL == \"test\" ]]; then\n  setup_base_build_version\nelse\n  setup_build_version\nfi\n\nsetup_conda_pytorch_constraint\nexport SOURCE_ROOT_DIR=$(pwd)\nconda build \\\n  -c defaults \\\n  $CONDA_CHANNEL_FLAGS \\\n  --no-anaconda-upload \\\n  --python \"$PYTHON_VERSION\" \\\n  --output-folder=dist/ \\\n  packaging/torchvision\n" [4511,4893]
                            OBJECT [4895,5052]
                                FIELD [4896,4929]
                                    String: "name" [4896,4902]
                                    STRING [4903,4929]
                                        String: "Upload package to GitHub" [4903,4929]
                                FIELD [4930,4965]
                                    String: "uses" [4930,4936]
                                    STRING [4937,4965]
                                        String: "actions/upload-artifact@v3" [4937,4965]
                                FIELD [4966,5051]
                                    String: "with" [4966,4972]
                                    OBJECT [4973,5051]
                                        FIELD [4974,5035]
                                            String: "name" [4974,4980]
                                            STRING [4981,5035]
                                                String: "torchvision-py${{ matrix.py_vers }}-macos11-m1-conda" [4981,5035]
                                        FIELD [5036,5050]
                                            String: "path" [5036,5042]
                                            STRING [5043,5050]
                                                String: "dist/" [5043,5050]
                            OBJECT [5053,5579]
                                FIELD [5054,5086]
                                    String: "name" [5054,5060]
                                    STRING [5061,5086]
                                        String: "Upload package to conda" [5061,5086]
                                FIELD [5087,5220]
                                    String: "if" [5087,5091]
                                    STRING [5092,5220]
                                        String: "${{ github.event_name == 'push' && (github.event.ref == 'refs/heads/nightly' || startsWith(github.event.ref, 'refs/tags/')) }}" [5092,5220]
                                FIELD [5221,5256]
                                    String: "shell" [5221,5228]
                                    STRING [5229,5256]
                                        String: "arch -arch arm64 bash {0}" [5229,5256]
                                FIELD [5257,5329]
                                    String: "env" [5257,5262]
                                    OBJECT [5263,5329]
                                        FIELD [5264,5328]
                                            String: "CONDA_PYTORCHBOT_TOKEN" [5264,5288]
                                            STRING [5289,5328]
                                                String: "${{ secrets.CONDA_PYTORCHBOT_TOKEN }}" [5289,5328]
                                FIELD [5330,5578]
                                    String: "run" [5330,5335]
                                    STRING [5336,5578]
                                        String: "conda install -yq anaconda-client\nset -x\nexport ANACONDA_PATH=$(conda info --base)/bin\n$ANACONDA_PATH/anaconda  -t \"${CONDA_PYTORCHBOT_TOKEN}\" upload dist/osx-arm64/*.tar.bz2 -u \"pytorch-${CHANNEL}\" --label main --no-progress --force" [5336,5578]