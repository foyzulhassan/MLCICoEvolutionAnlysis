OBJECT [0,4160]
    FIELD [1,20]
        String: "name" [1,7]
        STRING [8,20]
            String: "model jobs" [8,20]
    FIELD [21,286]
        String: "on" [21,25]
        OBJECT [26,286]
            FIELD [27,285]
                String: "workflow_call" [27,42]
                OBJECT [43,285]
                    FIELD [44,284]
                        String: "inputs" [44,52]
                        OBJECT [53,284]
                            FIELD [54,103]
                                String: "folder_slices" [54,69]
                                OBJECT [70,103]
                                    FIELD [71,86]
                                        String: "required" [71,81]
                                        TRUE [82,86]
                                    FIELD [87,102]
                                        String: "type" [87,93]
                                        STRING [94,102]
                                            String: "string" [94,102]
                            FIELD [104,152]
                                String: "machine_type" [104,118]
                                OBJECT [119,152]
                                    FIELD [120,135]
                                        String: "required" [120,130]
                                        TRUE [131,135]
                                    FIELD [136,151]
                                        String: "type" [136,142]
                                        STRING [143,151]
                                            String: "string" [143,151]
                            FIELD [153,197]
                                String: "slice_id" [153,163]
                                OBJECT [164,197]
                                    FIELD [165,180]
                                        String: "required" [165,175]
                                        TRUE [176,180]
                                    FIELD [181,196]
                                        String: "type" [181,187]
                                        STRING [188,196]
                                            String: "number" [188,196]
                            FIELD [198,240]
                                String: "runner" [198,206]
                                OBJECT [207,240]
                                    FIELD [208,223]
                                        String: "required" [208,218]
                                        TRUE [219,223]
                                    FIELD [224,239]
                                        String: "type" [224,230]
                                        STRING [231,239]
                                            String: "string" [231,239]
                            FIELD [241,283]
                                String: "docker" [241,249]
                                OBJECT [250,283]
                                    FIELD [251,266]
                                        String: "required" [251,261]
                                        TRUE [262,266]
                                    FIELD [267,282]
                                        String: "type" [267,273]
                                        STRING [274,282]
                                            String: "string" [274,282]
    FIELD [287,595]
        String: "env" [287,292]
        OBJECT [293,595]
            FIELD [294,316]
                String: "HF_HOME" [294,303]
                STRING [304,316]
                    String: "/mnt/cache" [304,316]
            FIELD [317,342]
                String: "TRANSFORMERS_IS_CI" [317,337]
                TRUE [338,342]
            FIELD [343,362]
                String: "OMP_NUM_THREADS" [343,360]
                NUMBER [361,362]
                    Number: 8 [361,362]
            FIELD [363,382]
                String: "MKL_NUM_THREADS" [363,380]
                NUMBER [381,382]
                    Number: 8 [381,382]
            FIELD [383,398]
                String: "RUN_SLOW" [383,393]
                TRUE [394,398]
            FIELD [399,453]
                String: "HF_HUB_READ_TOKEN" [399,418]
                STRING [419,453]
                    String: "${{ secrets.HF_HUB_READ_TOKEN }}" [419,453]
            FIELD [454,506]
                String: "SIGOPT_API_TOKEN" [454,472]
                STRING [473,506]
                    String: "${{ secrets.SIGOPT_API_TOKEN }}" [473,506]
            FIELD [507,539]
                String: "TF_FORCE_GPU_ALLOW_GROWTH" [507,534]
                TRUE [535,539]
            FIELD [540,565]
                String: "RUN_PT_TF_CROSS_TESTS" [540,563]
                NUMBER [564,565]
                    Number: 1 [564,565]
            FIELD [566,594]
                String: "CUDA_VISIBLE_DEVICES" [566,588]
                STRING [589,594]
                    String: "0,1" [589,594]
    FIELD [596,4159]
        String: "jobs" [596,602]
        OBJECT [603,4159]
            FIELD [604,4158]
                String: "run_models_gpu" [604,620]
                OBJECT [621,4158]
                    FIELD [622,632]
                        String: "name" [622,628]
                        STRING [629,632]
                            String: " " [629,632]
                    FIELD [633,758]
                        String: "strategy" [633,643]
                        OBJECT [644,758]
                            FIELD [645,661]
                                String: "max-parallel" [645,659]
                                NUMBER [660,661]
                                    Number: 8 [660,661]
                            FIELD [662,679]
                                String: "fail-fast" [662,673]
                                FALSE [674,679]
                            FIELD [680,757]
                                String: "matrix" [680,688]
                                OBJECT [689,757]
                                    FIELD [690,756]
                                        String: "folders" [690,699]
                                        STRING [700,756]
                                            String: "${{ fromJson(inputs.folder_slices)[inputs.slice_id] }}" [700,756]
                    FIELD [759,807]
                        String: "runs-on" [759,768]
                        OBJECT [769,807]
                            FIELD [770,806]
                                String: "group" [770,777]
                                STRING [778,806]
                                    String: "${{ inputs.machine_type }}" [778,806]
                    FIELD [808,951]
                        String: "container" [808,819]
                        OBJECT [820,951]
                            FIELD [821,851]
                                String: "image" [821,828]
                                STRING [829,851]
                                    String: "${{ inputs.docker }}" [829,851]
                            FIELD [852,950]
                                String: "options" [852,861]
                                STRING [862,950]
                                    String: "--gpus all --shm-size \"16gb\" --ipc host -v /mnt/cache/.cache/huggingface:/mnt/cache/" [862,950]
                    FIELD [952,4157]
                        String: "steps" [952,959]
                        ARRAY [960,4157]
                            OBJECT [961,1165]
                                FIELD [962,997]
                                    String: "name" [962,968]
                                    STRING [969,997]
                                        String: "Echo input and matrix info" [969,997]
                                FIELD [998,1012]
                                    String: "shell" [998,1005]
                                    STRING [1006,1012]
                                        String: "bash" [1006,1012]
                                FIELD [1013,1164]
                                    String: "run" [1013,1018]
                                    STRING [1019,1164]
                                        String: "echo \"${{ inputs.folder_slices }}\"\necho \"${{ matrix.folders }}\"\necho \"${{ toJson(fromJson(inputs.folder_slices)[inputs.slice_id]) }}\"\n" [1019,1164]
                            OBJECT [1166,1440]
                                FIELD [1167,1209]
                                    String: "name" [1167,1173]
                                    STRING [1174,1209]
                                        String: "Echo folder ${{ matrix.folders }}" [1174,1209]
                                FIELD [1210,1224]
                                    String: "shell" [1210,1217]
                                    STRING [1218,1224]
                                        String: "bash" [1218,1224]
                                FIELD [1225,1439]
                                    String: "run" [1225,1230]
                                    STRING [1231,1439]
                                        String: "echo \"${{ matrix.folders }}\"\nmatrix_folders=${{ matrix.folders }}\nmatrix_folders=${matrix_folders/'models/'/'models_'}\necho \"$matrix_folders\"\necho \"matrix_folders=$matrix_folders\" >> $GITHUB_ENV\n" [1231,1439]
                            OBJECT [1441,1552]
                                FIELD [1442,1463]
                                    String: "name" [1442,1448]
                                    STRING [1449,1463]
                                        String: "Update clone" [1449,1463]
                                FIELD [1464,1499]
                                    String: "working-directory" [1464,1483]
                                    STRING [1484,1499]
                                        String: "/transformers" [1484,1499]
                                FIELD [1500,1551]
                                    String: "run" [1500,1505]
                                    STRING [1506,1551]
                                        String: "git fetch && git checkout ${{ github.sha }}" [1506,1551]
                            OBJECT [1553,1768]
                                FIELD [1554,1651]
                                    String: "name" [1554,1560]
                                    STRING [1561,1651]
                                        String: "Reinstall transformers in edit mode (remove the one installed during docker image build)" [1561,1651]
                                FIELD [1652,1687]
                                    String: "working-directory" [1652,1671]
                                    STRING [1672,1687]
                                        String: "/transformers" [1672,1687]
                                FIELD [1688,1767]
                                    String: "run" [1688,1693]
                                    STRING [1694,1767]
                                        String: "python3 -m pip uninstall -y transformers && python3 -m pip install -e ." [1694,1767]
                            OBJECT [1769,1953]
                                FIELD [1770,1823]
                                    String: "name" [1770,1776]
                                    STRING [1777,1823]
                                        String: "Update / Install some packages (for Past CI)" [1777,1823]
                                FIELD [1824,1871]
                                    String: "if" [1824,1828]
                                    STRING [1829,1871]
                                        String: "${{ contains(inputs.docker, '-past-') }}" [1829,1871]
                                FIELD [1872,1907]
                                    String: "working-directory" [1872,1891]
                                    STRING [1892,1907]
                                        String: "/transformers" [1892,1907]
                                FIELD [1908,1952]
                                    String: "run" [1908,1913]
                                    STRING [1914,1952]
                                        String: "python3 -m pip install -U datasets\n" [1914,1952]
                            OBJECT [1954,2247]
                                FIELD [1955,2008]
                                    String: "name" [1955,1961]
                                    STRING [1962,2008]
                                        String: "Update / Install some packages (for Past CI)" [1962,2008]
                                FIELD [2009,2096]
                                    String: "if" [2009,2013]
                                    STRING [2014,2096]
                                        String: "${{ contains(inputs.docker, '-past-') && contains(inputs.docker, '-pytorch-') }}" [2014,2096]
                                FIELD [2097,2132]
                                    String: "working-directory" [2097,2116]
                                    STRING [2117,2132]
                                        String: "/transformers" [2117,2132]
                                FIELD [2133,2246]
                                    String: "run" [2133,2138]
                                    STRING [2139,2246]
                                        String: "python3 -m pip install --no-cache-dir git+https://github.com/huggingface/accelerate@main#egg=accelerate\n" [2139,2246]
                            OBJECT [2248,2290]
                                FIELD [2249,2268]
                                    String: "name" [2249,2255]
                                    STRING [2256,2268]
                                        String: "NVIDIA-SMI" [2256,2268]
                                FIELD [2269,2289]
                                    String: "run" [2269,2274]
                                    STRING [2275,2289]
                                        String: "nvidia-smi\n" [2275,2289]
                            OBJECT [2291,2386]
                                FIELD [2292,2312]
                                    String: "name" [2292,2298]
                                    STRING [2299,2312]
                                        String: "Environment" [2299,2312]
                                FIELD [2313,2348]
                                    String: "working-directory" [2313,2332]
                                    STRING [2333,2348]
                                        String: "/transformers" [2333,2348]
                                FIELD [2349,2385]
                                    String: "run" [2349,2354]
                                    STRING [2355,2385]
                                        String: "python3 utils/print_env.py\n" [2355,2385]
                            OBJECT [2387,2496]
                                FIELD [2388,2440]
                                    String: "name" [2388,2394]
                                    STRING [2395,2440]
                                        String: "Show installed libraries and their versions" [2395,2440]
                                FIELD [2441,2476]
                                    String: "working-directory" [2441,2460]
                                    STRING [2461,2476]
                                        String: "/transformers" [2461,2476]
                                FIELD [2477,2495]
                                    String: "run" [2477,2482]
                                    STRING [2483,2495]
                                        String: "pip freeze" [2483,2495]
                            OBJECT [2497,2990]
                                FIELD [2498,2555]
                                    String: "name" [2498,2504]
                                    STRING [2505,2555]
                                        String: "Set `machine_type` for report and artifact names" [2505,2555]
                                FIELD [2556,2591]
                                    String: "working-directory" [2556,2575]
                                    STRING [2576,2591]
                                        String: "/transformers" [2576,2591]
                                FIELD [2592,2606]
                                    String: "shell" [2592,2599]
                                    STRING [2600,2606]
                                        String: "bash" [2600,2606]
                                FIELD [2607,2989]
                                    String: "run" [2607,2612]
                                    STRING [2613,2989]
                                        String: "echo \"${{ inputs.machine_type }}\"\n\nif [ \"${{ inputs.machine_type }}\" = \"aws-g4dn-2xlarge-cache\" ]; then\n  machine_type=single-gpu\nelif [ \"${{ inputs.machine_type }}\" = \"aws-g4dn-12xlarge-cache\" ]; then\n  machine_type=multi-gpu\nelse\n  machine_type=${{ inputs.machine_type }}\nfi\n\necho \"$machine_type\"\necho \"machine_type=$machine_type\" >> $GITHUB_ENV\n" [2613,2989]
                            OBJECT [2991,3210]
                                FIELD [2992,3021]
                                    String: "name" [2992,2998]
                                    STRING [2999,3021]
                                        String: "Run all tests on GPU" [2999,3021]
                                FIELD [3022,3057]
                                    String: "working-directory" [3022,3041]
                                    STRING [3042,3057]
                                        String: "/transformers" [3042,3057]
                                FIELD [3058,3209]
                                    String: "run" [3058,3063]
                                    STRING [3064,3209]
                                        String: "python3 -m pytest -rsfE -v --make-reports=${{ env.machine_type }}_run_models_gpu_${{ matrix.folders }}_test_reports tests/${{ matrix.folders }}" [3064,3209]
                            OBJECT [3211,3419]
                                FIELD [3212,3242]
                                    String: "name" [3212,3218]
                                    STRING [3219,3242]
                                        String: "Failure short reports" [3219,3242]
                                FIELD [3243,3266]
                                    String: "if" [3243,3247]
                                    STRING [3248,3266]
                                        String: "${{ failure() }}" [3248,3266]
                                FIELD [3267,3291]
                                    String: "continue-on-error" [3267,3286]
                                    TRUE [3287,3291]
                                FIELD [3292,3418]
                                    String: "run" [3292,3297]
                                    STRING [3298,3418]
                                        String: "cat /transformers/reports/${{ env.machine_type }}_run_models_gpu_${{ matrix.folders }}_test_reports/failures_short.txt" [3298,3418]
                            OBJECT [3420,3777]
                                FIELD [3421,3438]
                                    String: "name" [3421,3427]
                                    STRING [3428,3438]
                                        String: "Run test" [3428,3438]
                                FIELD [3439,3453]
                                    String: "shell" [3439,3446]
                                    STRING [3447,3453]
                                        String: "bash" [3447,3453]
                                FIELD [3454,3776]
                                    String: "run" [3454,3459]
                                    STRING [3460,3776]
                                        String: "mkdir -p /transformers/reports/${{ env.machine_type }}_run_models_gpu_${{ matrix.folders }}_test_reports\necho \"hello\" > /transformers/reports/${{ env.machine_type }}_run_models_gpu_${{ matrix.folders }}_test_reports/hello.txt\necho \"${{ env.machine_type }}_run_models_gpu_${{ matrix.folders }}_test_reports\"\n" [3460,3776]
                            OBJECT [3778,4156]
                                FIELD [3779,3895]
                                    String: "name" [3779,3785]
                                    STRING [3786,3895]
                                        String: "Test suite reports artifacts: ${{ env.machine_type }}_run_models_gpu_${{ env.matrix_folders }}_test_reports" [3786,3895]
                                FIELD [3896,3918]
                                    String: "if" [3896,3900]
                                    STRING [3901,3918]
                                        String: "${{ always() }}" [3901,3918]
                                FIELD [3919,3954]
                                    String: "uses" [3919,3925]
                                    STRING [3926,3954]
                                        String: "actions/upload-artifact@v4" [3926,3954]
                                FIELD [3955,4155]
                                    String: "with" [3955,3961]
                                    OBJECT [3962,4155]
                                        FIELD [3963,4049]
                                            String: "name" [3963,3969]
                                            STRING [3970,4049]
                                                String: "${{ env.machine_type }}_run_models_gpu_${{ env.matrix_folders }}_test_reports" [3970,4049]
                                        FIELD [4050,4154]
                                            String: "path" [4050,4056]
                                            STRING [4057,4154]
                                                String: "/transformers/reports/${{ env.machine_type }}_run_models_gpu_${{ matrix.folders }}_test_reports" [4057,4154]