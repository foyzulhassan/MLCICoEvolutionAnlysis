OBJECT [0,6161]
    FIELD [1,21]
        String: "name" [1,7]
        STRING [8,21]
            String: "Build on M1" [8,21]
    FIELD [22,215]
        String: "on" [22,26]
        OBJECT [27,215]
            FIELD [28,96]
                String: "pull_request" [28,42]
                OBJECT [43,96]
                    FIELD [44,95]
                        String: "paths" [44,51]
                        ARRAY [52,95]
                            STRING [53,94]
                                String: ".github/workflows/build-m1-binaries.yml" [53,94]
            FIELD [97,189]
                String: "push" [97,103]
                OBJECT [104,189]
                    FIELD [105,146]
                        String: "branches" [105,115]
                        ARRAY [116,146]
                            STRING [117,126]
                                String: "nightly" [117,126]
                            STRING [127,133]
                                String: "main" [127,133]
                            STRING [134,145]
                                String: "release/*" [134,145]
                    FIELD [147,188]
                        String: "tags" [147,153]
                        ARRAY [154,188]
                            STRING [155,187]
                                String: "v[0-9]+.[0-9]+.[0-9]+-rc[0-9]+" [155,187]
            FIELD [190,214]
                String: "workflow_dispatch" [190,209]
                NULL [210,214]
    FIELD [216,243]
        String: "env" [216,221]
        OBJECT [222,243]
            FIELD [223,242]
                String: "CHANNEL" [223,232]
                STRING [233,242]
                    String: "nightly" [233,242]
    FIELD [244,6160]
        String: "jobs" [244,250]
        OBJECT [251,6160]
            FIELD [252,3927]
                String: "build_wheels" [252,266]
                OBJECT [267,3927]
                    FIELD [268,304]
                        String: "name" [268,274]
                        STRING [275,304]
                            String: "Build TorchVision M1 wheels" [275,304]
                    FIELD [305,325]
                        String: "runs-on" [305,314]
                        STRING [315,325]
                            String: "macos-m1" [315,325]
                    FIELD [326,380]
                        String: "strategy" [326,336]
                        OBJECT [337,380]
                            FIELD [338,379]
                                String: "matrix" [338,346]
                                OBJECT [347,379]
                                    FIELD [348,378]
                                        String: "py_vers" [348,357]
                                        ARRAY [358,378]
                                            STRING [359,364]
                                                String: "3.8" [359,364]
                                            STRING [365,370]
                                                String: "3.9" [365,370]
                                            STRING [371,377]
                                                String: "3.10" [371,377]
                    FIELD [381,3926]
                        String: "steps" [381,388]
                        ARRAY [389,3926]
                            OBJECT [390,449]
                                FIELD [391,419]
                                    String: "name" [391,397]
                                    STRING [398,419]
                                        String: "Checkout repository" [398,419]
                                FIELD [420,448]
                                    String: "uses" [420,426]
                                    STRING [427,448]
                                        String: "actions/checkout@v2" [427,448]
                            OBJECT [450,726]
                                FIELD [451,496]
                                    String: "name" [451,457]
                                    STRING [458,496]
                                        String: "Set CHANNEL (only for tagged pushes)" [458,496]
                                FIELD [497,584]
                                    String: "if" [497,501]
                                    STRING [502,584]
                                        String: "${{ github.event_name == 'push' && startsWith(github.event.ref, 'refs/tags/') }}" [502,584]
                                FIELD [585,725]
                                    String: "run" [585,590]
                                    STRING [591,725]
                                        String: "# reference ends with an RC suffix\nif [[ ${GITHUB_REF_NAME} = *-rc[0-9]* ]]; then\n  echo \"CHANNEL=test\" >> \"$GITHUB_ENV\"\nfi\n" [591,725]
                            OBJECT [727,964]
                                FIELD [728,770]
                                    String: "name" [728,734]
                                    STRING [735,770]
                                        String: "Set Release CHANNEL (for release)" [735,770]
                                FIELD [771,912]
                                    String: "if" [771,775]
                                    STRING [776,912]
                                        String: "${{ (github.event_name == 'pull_request' && startsWith(github.base_ref, 'release')) || startsWith(github.ref, 'refs/heads/release') }}" [776,912]
                                FIELD [913,963]
                                    String: "run" [913,918]
                                    STRING [919,963]
                                        String: "echo \"CHANNEL=test\" >> \"$GITHUB_ENV\"\n" [919,963]
                            OBJECT [965,2272]
                                FIELD [966,1001]
                                    String: "name" [966,972]
                                    STRING [973,1001]
                                        String: "Build TorchVision M1 wheel" [973,1001]
                                FIELD [1002,1037]
                                    String: "shell" [1002,1009]
                                    STRING [1010,1037]
                                        String: "arch -arch arm64 bash {0}" [1010,1037]
                                FIELD [1038,1123]
                                    String: "env" [1038,1043]
                                    OBJECT [1044,1123]
                                        FIELD [1045,1088]
                                            String: "ENV_NAME" [1045,1055]
                                            STRING [1056,1088]
                                                String: "conda-env-${{ github.run_id }}" [1056,1088]
                                        FIELD [1089,1122]
                                            String: "PY_VERS" [1089,1098]
                                            STRING [1099,1122]
                                                String: "${{ matrix.py_vers }}" [1099,1122]
                                FIELD [1124,2271]
                                    String: "run" [1124,1129]
                                    STRING [1130,2271]
                                        String: ". ~/miniconda3/etc/profile.d/conda.sh\n# Needed for JPEG library detection as setup.py detects conda presence by running `shlex.which('conda')`\nexport PATH=~/miniconda3/bin:$PATH\nset -ex\n. packaging/pkg_helpers.bash\n# if we are uploading to test channell, our version consist only of the base: 0.x.x - no date string or suffix added\nif [[ $CHANNEL == \"test\" ]]; then\n  setup_base_build_version\nelse\n  setup_build_version\nfi\n\nWHL_NAME=torchvision-${BUILD_VERSION}-cp${PY_VERS/.}-cp${PY_VERS/.}-macosx_11_0_arm64.whl\nconda create -yp ${ENV_NAME} python=${PY_VERS} numpy libpng jpeg wheel pkg-config\nconda run -p ${ENV_NAME} python3 -mpip install torch --pre --extra-index-url=https://download.pytorch.org/whl/${CHANNEL}\nconda run -p ${ENV_NAME} python3 -mpip install delocate\nconda run -p ${ENV_NAME} python3 setup.py bdist_wheel\nexport PYTORCH_VERSION=\"$(conda run -p ${ENV_NAME} python3 -mpip show torch | grep ^Version: | sed 's/Version:  *//')\"\nconda run -p ${ENV_NAME} DYLD_FALLBACK_LIBRARY_PATH=\"${ENV_NAME}/lib\" delocate-wheel -v --ignore-missing-dependencies dist/${WHL_NAME}\nconda env remove -p ${ENV_NAME}\n" [1130,2271]
                            OBJECT [2273,3300]
                                FIELD [2274,2293]
                                    String: "name" [2274,2280]
                                    STRING [2281,2293]
                                        String: "Test wheel" [2281,2293]
                                FIELD [2294,2329]
                                    String: "shell" [2294,2301]
                                    STRING [2302,2329]
                                        String: "arch -arch arm64 bash {0}" [2302,2329]
                                FIELD [2330,2420]
                                    String: "env" [2330,2335]
                                    OBJECT [2336,2420]
                                        FIELD [2337,2385]
                                            String: "ENV_NAME" [2337,2347]
                                            STRING [2348,2385]
                                                String: "conda-test-env-${{ github.run_id }}" [2348,2385]
                                        FIELD [2386,2419]
                                            String: "PY_VERS" [2386,2395]
                                            STRING [2396,2419]
                                                String: "${{ matrix.py_vers }}" [2396,2419]
                                FIELD [2421,3299]
                                    String: "run" [2421,2426]
                                    STRING [2427,3299]
                                        String: ". ~/miniconda3/etc/profile.d/conda.sh\nset -ex\nconda create -yp ${ENV_NAME} python=${PY_VERS} numpy\nconda run -p ${ENV_NAME} python3 -mpip install torch --pre --extra-index-url=https://download.pytorch.org/whl/${CHANNEL}\nconda run -p ${ENV_NAME} python3 -mpip install dist/*.whl\n# Test torch is importable, by changing cwd and running import commands\nconda run --cwd /tmp -p ${ENV_NAME} python3 -c \"import torchvision;print('torchvision version is ', torchvision.__version__)\"\nconda run --cwd /tmp -p ${ENV_NAME} python3 -c \"import torch;import torchvision;print('Is torchvision useable?', all(x is not None for x in [torch.ops.image.decode_png, torch.ops.torchvision.roi_align]))\"\nconda run --cwd /tmp -p ${ENV_NAME} python3 -c \"import torchvision;print(torchvision.io.read_image('${PWD}/gallery/assets/dog1.jpg').shape)\"\nconda env remove -p ${ENV_NAME}\n" [2427,3299]
                            OBJECT [3301,3450]
                                FIELD [3302,3333]
                                    String: "name" [3302,3308]
                                    STRING [3309,3333]
                                        String: "Upload wheel to GitHub" [3309,3333]
                                FIELD [3334,3369]
                                    String: "uses" [3334,3340]
                                    STRING [3341,3369]
                                        String: "actions/upload-artifact@v3" [3341,3369]
                                FIELD [3370,3449]
                                    String: "with" [3370,3376]
                                    OBJECT [3377,3449]
                                        FIELD [3378,3433]
                                            String: "name" [3378,3384]
                                            STRING [3385,3433]
                                                String: "torchvision-py${{ matrix.py_vers }}-macos11-m1" [3385,3433]
                                        FIELD [3434,3448]
                                            String: "path" [3434,3440]
                                            STRING [3441,3448]
                                                String: "dist/" [3441,3448]
                            OBJECT [3451,3925]
                                FIELD [3452,3479]
                                    String: "name" [3452,3458]
                                    STRING [3459,3479]
                                        String: "Upload wheel to S3" [3459,3479]
                                FIELD [3480,3613]
                                    String: "if" [3480,3484]
                                    STRING [3485,3613]
                                        String: "${{ github.event_name == 'push' && (github.event.ref == 'refs/heads/nightly' || startsWith(github.event.ref, 'refs/tags/')) }}" [3485,3613]
                                FIELD [3614,3649]
                                    String: "shell" [3614,3621]
                                    STRING [3622,3649]
                                        String: "arch -arch arm64 bash {0}" [3622,3649]
                                FIELD [3650,3809]
                                    String: "env" [3650,3655]
                                    OBJECT [3656,3809]
                                        FIELD [3657,3728]
                                            String: "AWS_ACCESS_KEY_ID" [3657,3676]
                                            STRING [3677,3728]
                                                String: "${{ secrets.AWS_PYTORCH_UPLOADER_ACCESS_KEY_ID }}" [3677,3728]
                                        FIELD [3729,3808]
                                            String: "AWS_SECRET_ACCESS_KEY" [3729,3752]
                                            STRING [3753,3808]
                                                String: "${{ secrets.AWS_PYTORCH_UPLOADER_SECRET_ACCESS_KEY }}" [3753,3808]
                                FIELD [3810,3924]
                                    String: "run" [3810,3815]
                                    STRING [3816,3924]
                                        String: "for pkg in dist/*; do\n  aws s3 cp \"$pkg\" \"s3://pytorch/whl/${CHANNEL}/cpu/\" --acl public-read\ndone\n" [3816,3924]
            FIELD [3928,6159]
                String: "build_conda" [3928,3941]
                OBJECT [3942,6159]
                    FIELD [3943,3987]
                        String: "name" [3943,3949]
                        STRING [3950,3987]
                            String: "Build TorchVision M1 conda packages" [3950,3987]
                    FIELD [3988,4008]
                        String: "runs-on" [3988,3997]
                        STRING [3998,4008]
                            String: "macos-m1" [3998,4008]
                    FIELD [4009,4063]
                        String: "strategy" [4009,4019]
                        OBJECT [4020,4063]
                            FIELD [4021,4062]
                                String: "matrix" [4021,4029]
                                OBJECT [4030,4062]
                                    FIELD [4031,4061]
                                        String: "py_vers" [4031,4040]
                                        ARRAY [4041,4061]
                                            STRING [4042,4047]
                                                String: "3.8" [4042,4047]
                                            STRING [4048,4053]
                                                String: "3.9" [4048,4053]
                                            STRING [4054,4060]
                                                String: "3.10" [4054,4060]
                    FIELD [4064,6158]
                        String: "steps" [4064,4071]
                        ARRAY [4072,6158]
                            OBJECT [4073,4132]
                                FIELD [4074,4102]
                                    String: "name" [4074,4080]
                                    STRING [4081,4102]
                                        String: "Checkout repository" [4081,4102]
                                FIELD [4103,4131]
                                    String: "uses" [4103,4109]
                                    STRING [4110,4131]
                                        String: "actions/checkout@v2" [4110,4131]
                            OBJECT [4133,4409]
                                FIELD [4134,4179]
                                    String: "name" [4134,4140]
                                    STRING [4141,4179]
                                        String: "Set CHANNEL (only for tagged pushes)" [4141,4179]
                                FIELD [4180,4267]
                                    String: "if" [4180,4184]
                                    STRING [4185,4267]
                                        String: "${{ github.event_name == 'push' && startsWith(github.event.ref, 'refs/tags/') }}" [4185,4267]
                                FIELD [4268,4408]
                                    String: "run" [4268,4273]
                                    STRING [4274,4408]
                                        String: "# reference ends with an RC suffix\nif [[ ${GITHUB_REF_NAME} = *-rc[0-9]* ]]; then\n  echo \"CHANNEL=test\" >> \"$GITHUB_ENV\"\nfi\n" [4274,4408]
                            OBJECT [4410,4647]
                                FIELD [4411,4453]
                                    String: "name" [4411,4417]
                                    STRING [4418,4453]
                                        String: "Set CHANNEL Release (for release)" [4418,4453]
                                FIELD [4454,4595]
                                    String: "if" [4454,4458]
                                    STRING [4459,4595]
                                        String: "${{ (github.event_name == 'pull_request' && startsWith(github.base_ref, 'release')) || startsWith(github.ref, 'refs/heads/release') }}" [4459,4595]
                                FIELD [4596,4646]
                                    String: "run" [4596,4601]
                                    STRING [4602,4646]
                                        String: "echo \"CHANNEL=test\" >> \"$GITHUB_ENV\"\n" [4602,4646]
                            OBJECT [4648,4845]
                                FIELD [4649,4706]
                                    String: "name" [4649,4655]
                                    STRING [4656,4706]
                                        String: "Install conda-build and purge previous artifacts" [4656,4706]
                                FIELD [4707,4742]
                                    String: "shell" [4707,4714]
                                    STRING [4715,4742]
                                        String: "arch -arch arm64 bash {0}" [4715,4742]
                                FIELD [4743,4844]
                                    String: "run" [4743,4748]
                                    STRING [4749,4844]
                                        String: ". ~/miniconda3/etc/profile.d/conda.sh\nconda install -yq conda-build\nconda build purge-all\n" [4749,4844]
                            OBJECT [4846,5477]
                                FIELD [4847,4890]
                                    String: "name" [4847,4853]
                                    STRING [4854,4890]
                                        String: "Build TorchVision M1 conda package" [4854,4890]
                                FIELD [4891,4926]
                                    String: "shell" [4891,4898]
                                    STRING [4899,4926]
                                        String: "arch -arch arm64 bash {0}" [4899,4926]
                                FIELD [4927,5038]
                                    String: "env" [4927,4932]
                                    OBJECT [4933,5038]
                                        FIELD [4934,4977]
                                            String: "ENV_NAME" [4934,4944]
                                            STRING [4945,4977]
                                                String: "conda-env-${{ github.run_id }}" [4945,4977]
                                        FIELD [4978,5018]
                                            String: "PYTHON_VERSION" [4978,4994]
                                            STRING [4995,5018]
                                                String: "${{ matrix.py_vers }}" [4995,5018]
                                        FIELD [5019,5037]
                                            String: "CU_VERSION" [5019,5031]
                                            STRING [5032,5037]
                                                String: "cpu" [5032,5037]
                                FIELD [5039,5476]
                                    String: "run" [5039,5044]
                                    STRING [5045,5476]
                                        String: ". ~/miniconda3/etc/profile.d/conda.sh\nset -ex\n. packaging/pkg_helpers.bash\n\nif [[ $CHANNEL == \"test\" ]]; then\n  setup_base_build_version\nelse\n  setup_build_version\nfi\n\nsetup_conda_pytorch_constraint\nexport SOURCE_ROOT_DIR=$(pwd)\nconda build -c defaults $CONDA_CHANNEL_FLAGS --no-anaconda-upload --python \"$PYTHON_VERSION\" packaging/torchvision\nmkdir -p dist\ncp ~/miniconda3/conda-bld/osx-arm64/*.tar.bz2 dist/\n" [5045,5476]
                            OBJECT [5478,5635]
                                FIELD [5479,5512]
                                    String: "name" [5479,5485]
                                    STRING [5486,5512]
                                        String: "Upload package to GitHub" [5486,5512]
                                FIELD [5513,5548]
                                    String: "uses" [5513,5519]
                                    STRING [5520,5548]
                                        String: "actions/upload-artifact@v3" [5520,5548]
                                FIELD [5549,5634]
                                    String: "with" [5549,5555]
                                    OBJECT [5556,5634]
                                        FIELD [5557,5618]
                                            String: "name" [5557,5563]
                                            STRING [5564,5618]
                                                String: "torchvision-py${{ matrix.py_vers }}-macos11-m1-conda" [5564,5618]
                                        FIELD [5619,5633]
                                            String: "path" [5619,5625]
                                            STRING [5626,5633]
                                                String: "dist/" [5626,5633]
                            OBJECT [5636,6157]
                                FIELD [5637,5669]
                                    String: "name" [5637,5643]
                                    STRING [5644,5669]
                                        String: "Upload package to conda" [5644,5669]
                                FIELD [5670,5803]
                                    String: "if" [5670,5674]
                                    STRING [5675,5803]
                                        String: "${{ github.event_name == 'push' && (github.event.ref == 'refs/heads/nightly' || startsWith(github.event.ref, 'refs/tags/')) }}" [5675,5803]
                                FIELD [5804,5839]
                                    String: "shell" [5804,5811]
                                    STRING [5812,5839]
                                        String: "arch -arch arm64 bash {0}" [5812,5839]
                                FIELD [5840,5912]
                                    String: "env" [5840,5845]
                                    OBJECT [5846,5912]
                                        FIELD [5847,5911]
                                            String: "CONDA_PYTORCHBOT_TOKEN" [5847,5871]
                                            STRING [5872,5911]
                                                String: "${{ secrets.CONDA_PYTORCHBOT_TOKEN }}" [5872,5911]
                                FIELD [5913,6156]
                                    String: "run" [5913,5918]
                                    STRING [5919,6156]
                                        String: ". ~/miniconda3/etc/profile.d/conda.sh\nconda install -yq anaconda-client\nset -x\nanaconda  -t \"${CONDA_PYTORCHBOT_TOKEN}\" upload ~/miniconda3/conda-bld/osx-arm64/*.tar.bz2 -u \"pytorch-${CHANNEL}\" --label main --no-progress --force" [5919,6156]