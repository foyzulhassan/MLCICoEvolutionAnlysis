OBJECT [0,5673]
    FIELD [1,21]
        String: "name" [1,7]
        STRING [8,21]
            String: "Build on M1" [8,21]
    FIELD [22,203]
        String: "on" [22,26]
        OBJECT [27,203]
            FIELD [28,96]
                String: "pull_request" [28,42]
                OBJECT [43,96]
                    FIELD [44,95]
                        String: "paths" [44,51]
                        ARRAY [52,95]
                            STRING [53,94]
                                String: ".github/workflows/build-m1-binaries.yml" [53,94]
            FIELD [97,177]
                String: "push" [97,103]
                OBJECT [104,177]
                    FIELD [105,134]
                        String: "branches" [105,115]
                        ARRAY [116,134]
                            STRING [117,126]
                                String: "nightly" [117,126]
                            STRING [127,133]
                                String: "main" [127,133]
                    FIELD [135,176]
                        String: "tags" [135,141]
                        ARRAY [142,176]
                            STRING [143,175]
                                String: "v[0-9]+.[0-9]+.[0-9]+-rc[0-9]+" [143,175]
            FIELD [178,202]
                String: "workflow_dispatch" [178,197]
                NULL [198,202]
    FIELD [204,231]
        String: "env" [204,209]
        OBJECT [210,231]
            FIELD [211,230]
                String: "CHANNEL" [211,220]
                STRING [221,230]
                    String: "nightly" [221,230]
    FIELD [232,5672]
        String: "jobs" [232,238]
        OBJECT [239,5672]
            FIELD [240,3677]
                String: "build_wheels" [240,254]
                OBJECT [255,3677]
                    FIELD [256,292]
                        String: "name" [256,262]
                        STRING [263,292]
                            String: "Build TorchVision M1 wheels" [263,292]
                    FIELD [293,313]
                        String: "runs-on" [293,302]
                        STRING [303,313]
                            String: "macos-m1" [303,313]
                    FIELD [314,368]
                        String: "strategy" [314,324]
                        OBJECT [325,368]
                            FIELD [326,367]
                                String: "matrix" [326,334]
                                OBJECT [335,367]
                                    FIELD [336,366]
                                        String: "py_vers" [336,345]
                                        ARRAY [346,366]
                                            STRING [347,352]
                                                String: "3.8" [347,352]
                                            STRING [353,358]
                                                String: "3.9" [353,358]
                                            STRING [359,365]
                                                String: "3.10" [359,365]
                    FIELD [369,3676]
                        String: "steps" [369,376]
                        ARRAY [377,3676]
                            OBJECT [378,437]
                                FIELD [379,407]
                                    String: "name" [379,385]
                                    STRING [386,407]
                                        String: "Checkout repository" [386,407]
                                FIELD [408,436]
                                    String: "uses" [408,414]
                                    STRING [415,436]
                                        String: "actions/checkout@v2" [415,436]
                            OBJECT [438,714]
                                FIELD [439,484]
                                    String: "name" [439,445]
                                    STRING [446,484]
                                        String: "Set CHANNEL (only for tagged pushes)" [446,484]
                                FIELD [485,572]
                                    String: "if" [485,489]
                                    STRING [490,572]
                                        String: "${{ github.event_name == 'push' && startsWith(github.event.ref, 'refs/tags/') }}" [490,572]
                                FIELD [573,713]
                                    String: "run" [573,578]
                                    STRING [579,713]
                                        String: "# reference ends with an RC suffix\nif [[ ${GITHUB_REF_NAME} = *-rc[0-9]* ]]; then\n  echo \"CHANNEL=test\" >> \"$GITHUB_ENV\"\nfi\n" [579,713]
                            OBJECT [715,2022]
                                FIELD [716,751]
                                    String: "name" [716,722]
                                    STRING [723,751]
                                        String: "Build TorchVision M1 wheel" [723,751]
                                FIELD [752,787]
                                    String: "shell" [752,759]
                                    STRING [760,787]
                                        String: "arch -arch arm64 bash {0}" [760,787]
                                FIELD [788,873]
                                    String: "env" [788,793]
                                    OBJECT [794,873]
                                        FIELD [795,838]
                                            String: "ENV_NAME" [795,805]
                                            STRING [806,838]
                                                String: "conda-env-${{ github.run_id }}" [806,838]
                                        FIELD [839,872]
                                            String: "PY_VERS" [839,848]
                                            STRING [849,872]
                                                String: "${{ matrix.py_vers }}" [849,872]
                                FIELD [874,2021]
                                    String: "run" [874,879]
                                    STRING [880,2021]
                                        String: ". ~/miniconda3/etc/profile.d/conda.sh\n# Needed for JPEG library detection as setup.py detects conda presence by running `shlex.which('conda')`\nexport PATH=~/miniconda3/bin:$PATH\nset -ex\n. packaging/pkg_helpers.bash\n# if we are uploading to test channell, our version consist only of the base: 0.x.x - no date string or suffix added\nif [[ $CHANNEL == \"test\" ]]; then\n  setup_base_build_version\nelse\n  setup_build_version\nfi\n\nWHL_NAME=torchvision-${BUILD_VERSION}-cp${PY_VERS/.}-cp${PY_VERS/.}-macosx_11_0_arm64.whl\nconda create -yp ${ENV_NAME} python=${PY_VERS} numpy libpng jpeg wheel pkg-config\nconda run -p ${ENV_NAME} python3 -mpip install torch --pre --extra-index-url=https://download.pytorch.org/whl/${CHANNEL}\nconda run -p ${ENV_NAME} python3 -mpip install delocate\nconda run -p ${ENV_NAME} python3 setup.py bdist_wheel\nexport PYTORCH_VERSION=\"$(conda run -p ${ENV_NAME} python3 -mpip show torch | grep ^Version: | sed 's/Version:  *//')\"\nconda run -p ${ENV_NAME} DYLD_FALLBACK_LIBRARY_PATH=\"${ENV_NAME}/lib\" delocate-wheel -v --ignore-missing-dependencies dist/${WHL_NAME}\nconda env remove -p ${ENV_NAME}\n" [880,2021]
                            OBJECT [2023,3050]
                                FIELD [2024,2043]
                                    String: "name" [2024,2030]
                                    STRING [2031,2043]
                                        String: "Test wheel" [2031,2043]
                                FIELD [2044,2079]
                                    String: "shell" [2044,2051]
                                    STRING [2052,2079]
                                        String: "arch -arch arm64 bash {0}" [2052,2079]
                                FIELD [2080,2170]
                                    String: "env" [2080,2085]
                                    OBJECT [2086,2170]
                                        FIELD [2087,2135]
                                            String: "ENV_NAME" [2087,2097]
                                            STRING [2098,2135]
                                                String: "conda-test-env-${{ github.run_id }}" [2098,2135]
                                        FIELD [2136,2169]
                                            String: "PY_VERS" [2136,2145]
                                            STRING [2146,2169]
                                                String: "${{ matrix.py_vers }}" [2146,2169]
                                FIELD [2171,3049]
                                    String: "run" [2171,2176]
                                    STRING [2177,3049]
                                        String: ". ~/miniconda3/etc/profile.d/conda.sh\nset -ex\nconda create -yp ${ENV_NAME} python=${PY_VERS} numpy\nconda run -p ${ENV_NAME} python3 -mpip install torch --pre --extra-index-url=https://download.pytorch.org/whl/${CHANNEL}\nconda run -p ${ENV_NAME} python3 -mpip install dist/*.whl\n# Test torch is importable, by changing cwd and running import commands\nconda run --cwd /tmp -p ${ENV_NAME} python3 -c \"import torchvision;print('torchvision version is ', torchvision.__version__)\"\nconda run --cwd /tmp -p ${ENV_NAME} python3 -c \"import torch;import torchvision;print('Is torchvision useable?', all(x is not None for x in [torch.ops.image.decode_png, torch.ops.torchvision.roi_align]))\"\nconda run --cwd /tmp -p ${ENV_NAME} python3 -c \"import torchvision;print(torchvision.io.read_image('${PWD}/gallery/assets/dog1.jpg').shape)\"\nconda env remove -p ${ENV_NAME}\n" [2177,3049]
                            OBJECT [3051,3200]
                                FIELD [3052,3083]
                                    String: "name" [3052,3058]
                                    STRING [3059,3083]
                                        String: "Upload wheel to GitHub" [3059,3083]
                                FIELD [3084,3119]
                                    String: "uses" [3084,3090]
                                    STRING [3091,3119]
                                        String: "actions/upload-artifact@v3" [3091,3119]
                                FIELD [3120,3199]
                                    String: "with" [3120,3126]
                                    OBJECT [3127,3199]
                                        FIELD [3128,3183]
                                            String: "name" [3128,3134]
                                            STRING [3135,3183]
                                                String: "torchvision-py${{ matrix.py_vers }}-macos11-m1" [3135,3183]
                                        FIELD [3184,3198]
                                            String: "path" [3184,3190]
                                            STRING [3191,3198]
                                                String: "dist/" [3191,3198]
                            OBJECT [3201,3675]
                                FIELD [3202,3229]
                                    String: "name" [3202,3208]
                                    STRING [3209,3229]
                                        String: "Upload wheel to S3" [3209,3229]
                                FIELD [3230,3363]
                                    String: "if" [3230,3234]
                                    STRING [3235,3363]
                                        String: "${{ github.event_name == 'push' && (github.event.ref == 'refs/heads/nightly' || startsWith(github.event.ref, 'refs/tags/')) }}" [3235,3363]
                                FIELD [3364,3399]
                                    String: "shell" [3364,3371]
                                    STRING [3372,3399]
                                        String: "arch -arch arm64 bash {0}" [3372,3399]
                                FIELD [3400,3559]
                                    String: "env" [3400,3405]
                                    OBJECT [3406,3559]
                                        FIELD [3407,3478]
                                            String: "AWS_ACCESS_KEY_ID" [3407,3426]
                                            STRING [3427,3478]
                                                String: "${{ secrets.AWS_PYTORCH_UPLOADER_ACCESS_KEY_ID }}" [3427,3478]
                                        FIELD [3479,3558]
                                            String: "AWS_SECRET_ACCESS_KEY" [3479,3502]
                                            STRING [3503,3558]
                                                String: "${{ secrets.AWS_PYTORCH_UPLOADER_SECRET_ACCESS_KEY }}" [3503,3558]
                                FIELD [3560,3674]
                                    String: "run" [3560,3565]
                                    STRING [3566,3674]
                                        String: "for pkg in dist/*; do\n  aws s3 cp \"$pkg\" \"s3://pytorch/whl/${CHANNEL}/cpu/\" --acl public-read\ndone\n" [3566,3674]
            FIELD [3678,5671]
                String: "build_conda" [3678,3691]
                OBJECT [3692,5671]
                    FIELD [3693,3737]
                        String: "name" [3693,3699]
                        STRING [3700,3737]
                            String: "Build TorchVision M1 conda packages" [3700,3737]
                    FIELD [3738,3758]
                        String: "runs-on" [3738,3747]
                        STRING [3748,3758]
                            String: "macos-m1" [3748,3758]
                    FIELD [3759,3813]
                        String: "strategy" [3759,3769]
                        OBJECT [3770,3813]
                            FIELD [3771,3812]
                                String: "matrix" [3771,3779]
                                OBJECT [3780,3812]
                                    FIELD [3781,3811]
                                        String: "py_vers" [3781,3790]
                                        ARRAY [3791,3811]
                                            STRING [3792,3797]
                                                String: "3.8" [3792,3797]
                                            STRING [3798,3803]
                                                String: "3.9" [3798,3803]
                                            STRING [3804,3810]
                                                String: "3.10" [3804,3810]
                    FIELD [3814,5670]
                        String: "steps" [3814,3821]
                        ARRAY [3822,5670]
                            OBJECT [3823,3882]
                                FIELD [3824,3852]
                                    String: "name" [3824,3830]
                                    STRING [3831,3852]
                                        String: "Checkout repository" [3831,3852]
                                FIELD [3853,3881]
                                    String: "uses" [3853,3859]
                                    STRING [3860,3881]
                                        String: "actions/checkout@v2" [3860,3881]
                            OBJECT [3883,4159]
                                FIELD [3884,3929]
                                    String: "name" [3884,3890]
                                    STRING [3891,3929]
                                        String: "Set CHANNEL (only for tagged pushes)" [3891,3929]
                                FIELD [3930,4017]
                                    String: "if" [3930,3934]
                                    STRING [3935,4017]
                                        String: "${{ github.event_name == 'push' && startsWith(github.event.ref, 'refs/tags/') }}" [3935,4017]
                                FIELD [4018,4158]
                                    String: "run" [4018,4023]
                                    STRING [4024,4158]
                                        String: "# reference ends with an RC suffix\nif [[ ${GITHUB_REF_NAME} = *-rc[0-9]* ]]; then\n  echo \"CHANNEL=test\" >> \"$GITHUB_ENV\"\nfi\n" [4024,4158]
                            OBJECT [4160,4357]
                                FIELD [4161,4218]
                                    String: "name" [4161,4167]
                                    STRING [4168,4218]
                                        String: "Install conda-build and purge previous artifacts" [4168,4218]
                                FIELD [4219,4254]
                                    String: "shell" [4219,4226]
                                    STRING [4227,4254]
                                        String: "arch -arch arm64 bash {0}" [4227,4254]
                                FIELD [4255,4356]
                                    String: "run" [4255,4260]
                                    STRING [4261,4356]
                                        String: ". ~/miniconda3/etc/profile.d/conda.sh\nconda install -yq conda-build\nconda build purge-all\n" [4261,4356]
                            OBJECT [4358,4989]
                                FIELD [4359,4402]
                                    String: "name" [4359,4365]
                                    STRING [4366,4402]
                                        String: "Build TorchVision M1 conda package" [4366,4402]
                                FIELD [4403,4438]
                                    String: "shell" [4403,4410]
                                    STRING [4411,4438]
                                        String: "arch -arch arm64 bash {0}" [4411,4438]
                                FIELD [4439,4550]
                                    String: "env" [4439,4444]
                                    OBJECT [4445,4550]
                                        FIELD [4446,4489]
                                            String: "ENV_NAME" [4446,4456]
                                            STRING [4457,4489]
                                                String: "conda-env-${{ github.run_id }}" [4457,4489]
                                        FIELD [4490,4530]
                                            String: "PYTHON_VERSION" [4490,4506]
                                            STRING [4507,4530]
                                                String: "${{ matrix.py_vers }}" [4507,4530]
                                        FIELD [4531,4549]
                                            String: "CU_VERSION" [4531,4543]
                                            STRING [4544,4549]
                                                String: "cpu" [4544,4549]
                                FIELD [4551,4988]
                                    String: "run" [4551,4556]
                                    STRING [4557,4988]
                                        String: ". ~/miniconda3/etc/profile.d/conda.sh\nset -ex\n. packaging/pkg_helpers.bash\n\nif [[ $CHANNEL == \"test\" ]]; then\n  setup_base_build_version\nelse\n  setup_build_version\nfi\n\nsetup_conda_pytorch_constraint\nexport SOURCE_ROOT_DIR=$(pwd)\nconda build -c defaults $CONDA_CHANNEL_FLAGS --no-anaconda-upload --python \"$PYTHON_VERSION\" packaging/torchvision\nmkdir -p dist\ncp ~/miniconda3/conda-bld/osx-arm64/*.tar.bz2 dist/\n" [4557,4988]
                            OBJECT [4990,5147]
                                FIELD [4991,5024]
                                    String: "name" [4991,4997]
                                    STRING [4998,5024]
                                        String: "Upload package to GitHub" [4998,5024]
                                FIELD [5025,5060]
                                    String: "uses" [5025,5031]
                                    STRING [5032,5060]
                                        String: "actions/upload-artifact@v3" [5032,5060]
                                FIELD [5061,5146]
                                    String: "with" [5061,5067]
                                    OBJECT [5068,5146]
                                        FIELD [5069,5130]
                                            String: "name" [5069,5075]
                                            STRING [5076,5130]
                                                String: "torchvision-py${{ matrix.py_vers }}-macos11-m1-conda" [5076,5130]
                                        FIELD [5131,5145]
                                            String: "path" [5131,5137]
                                            STRING [5138,5145]
                                                String: "dist/" [5138,5145]
                            OBJECT [5148,5669]
                                FIELD [5149,5181]
                                    String: "name" [5149,5155]
                                    STRING [5156,5181]
                                        String: "Upload package to conda" [5156,5181]
                                FIELD [5182,5315]
                                    String: "if" [5182,5186]
                                    STRING [5187,5315]
                                        String: "${{ github.event_name == 'push' && (github.event.ref == 'refs/heads/nightly' || startsWith(github.event.ref, 'refs/tags/')) }}" [5187,5315]
                                FIELD [5316,5351]
                                    String: "shell" [5316,5323]
                                    STRING [5324,5351]
                                        String: "arch -arch arm64 bash {0}" [5324,5351]
                                FIELD [5352,5424]
                                    String: "env" [5352,5357]
                                    OBJECT [5358,5424]
                                        FIELD [5359,5423]
                                            String: "CONDA_PYTORCHBOT_TOKEN" [5359,5383]
                                            STRING [5384,5423]
                                                String: "${{ secrets.CONDA_PYTORCHBOT_TOKEN }}" [5384,5423]
                                FIELD [5425,5668]
                                    String: "run" [5425,5430]
                                    STRING [5431,5668]
                                        String: ". ~/miniconda3/etc/profile.d/conda.sh\nconda install -yq anaconda-client\nset -x\nanaconda  -t \"${CONDA_PYTORCHBOT_TOKEN}\" upload ~/miniconda3/conda-bld/osx-arm64/*.tar.bz2 -u \"pytorch-${CHANNEL}\" --label main --no-progress --force" [5431,5668]