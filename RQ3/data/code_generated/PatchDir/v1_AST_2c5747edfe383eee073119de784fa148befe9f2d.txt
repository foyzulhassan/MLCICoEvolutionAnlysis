OBJECT [0,5551]
    FIELD [1,35]
        String: "name" [1,7]
        STRING [8,35]
            String: "Self-hosted runner (past)" [8,35]
    FIELD [36,161]
        String: "on" [36,40]
        OBJECT [41,161]
            FIELD [42,160]
                String: "workflow_call" [42,57]
                OBJECT [58,160]
                    FIELD [59,159]
                        String: "inputs" [59,67]
                        OBJECT [68,159]
                            FIELD [69,114]
                                String: "framework" [69,80]
                                OBJECT [81,114]
                                    FIELD [82,97]
                                        String: "required" [82,92]
                                        TRUE [93,97]
                                    FIELD [98,113]
                                        String: "type" [98,104]
                                        STRING [105,113]
                                            String: "string" [105,113]
                            FIELD [115,158]
                                String: "version" [115,124]
                                OBJECT [125,158]
                                    FIELD [126,141]
                                        String: "required" [126,136]
                                        TRUE [137,141]
                                    FIELD [142,157]
                                        String: "type" [142,148]
                                        STRING [149,157]
                                            String: "string" [149,157]
    FIELD [162,386]
        String: "env" [162,167]
        OBJECT [168,386]
            FIELD [169,191]
                String: "HF_HOME" [169,178]
                STRING [179,191]
                    String: "/mnt/cache" [179,191]
            FIELD [192,217]
                String: "TRANSFORMERS_IS_CI" [192,212]
                TRUE [213,217]
            FIELD [218,237]
                String: "OMP_NUM_THREADS" [218,235]
                NUMBER [236,237]
                    Number: 8 [236,237]
            FIELD [238,257]
                String: "MKL_NUM_THREADS" [238,255]
                NUMBER [256,257]
                    Number: 8 [256,257]
            FIELD [258,273]
                String: "RUN_SLOW" [258,268]
                TRUE [269,273]
            FIELD [274,326]
                String: "SIGOPT_API_TOKEN" [274,292]
                STRING [293,326]
                    String: "${{ secrets.SIGOPT_API_TOKEN }}" [293,326]
            FIELD [327,359]
                String: "TF_FORCE_GPU_ALLOW_GROWTH" [327,354]
                TRUE [355,359]
            FIELD [360,385]
                String: "RUN_PT_TF_CROSS_TESTS" [360,383]
                NUMBER [384,385]
                    Number: 1 [384,385]
    FIELD [387,5550]
        String: "jobs" [387,393]
        OBJECT [394,5550]
            FIELD [395,1110]
                String: "setup" [395,402]
                OBJECT [403,1110]
                    FIELD [404,418]
                        String: "name" [404,410]
                        STRING [411,418]
                            String: "Setup" [411,418]
                    FIELD [419,444]
                        String: "runs-on" [419,428]
                        STRING [429,444]
                            String: "ubuntu-latest" [429,444]
                    FIELD [445,506]
                        String: "outputs" [445,454]
                        OBJECT [455,506]
                            FIELD [456,505]
                                String: "matrix" [456,464]
                                STRING [465,505]
                                    String: "${{ steps.set-matrix.outputs.matrix }}" [465,505]
                    FIELD [507,1109]
                        String: "steps" [507,514]
                        ARRAY [515,1109]
                            OBJECT [516,602]
                                FIELD [517,547]
                                    String: "name" [517,523]
                                    STRING [524,547]
                                        String: "Checkout transformers" [524,547]
                                FIELD [548,576]
                                    String: "uses" [548,554]
                                    STRING [555,576]
                                        String: "actions/checkout@v2" [555,576]
                                FIELD [577,601]
                                    String: "with" [577,583]
                                    OBJECT [584,601]
                                        FIELD [585,600]
                                            String: "fetch-depth" [585,598]
                                            NUMBER [599,600]
                                                Number: 2 [599,600]
                            OBJECT [603,705]
                                FIELD [604,620]
                                    String: "name" [604,610]
                                    STRING [611,620]
                                        String: "Cleanup" [611,620]
                                FIELD [621,704]
                                    String: "run" [621,626]
                                    STRING [627,704]
                                        String: "rm -rf tests/__pycache__\nrm -rf tests/models/__pycache__\nrm -rf reports\n" [627,704]
                            OBJECT [706,1108]
                                FIELD [707,724]
                                    String: "id" [707,711]
                                    STRING [712,724]
                                        String: "set-matrix" [712,724]
                                FIELD [725,757]
                                    String: "name" [725,731]
                                    STRING [732,757]
                                        String: "Identify models to test" [732,757]
                                FIELD [758,1107]
                                    String: "run" [758,763]
                                    STRING [764,1107]
                                        String: "cd tests\necho \"::set-output name=matrix::$(python3 -c 'import os; tests = os.getcwd(); model_tests = os.listdir(os.path.join(tests, \"models\")); d1 = sorted(list(filter(os.path.isdir, os.listdir(tests)))); d2 = sorted(list(filter(os.path.isdir, [f\"models/{x}\" for x in model_tests]))); d1.remove(\"models\"); d = d2 + d1; print(d)')\"\n" [764,1107]
            FIELD [1111,2797]
                String: "run_tests_single_gpu" [1111,1133]
                OBJECT [1134,2797]
                    FIELD [1135,1155]
                        String: "name" [1135,1141]
                        STRING [1142,1155]
                            String: "Model tests" [1142,1155]
                    FIELD [1156,1283]
                        String: "strategy" [1156,1166]
                        OBJECT [1167,1283]
                            FIELD [1168,1185]
                                String: "fail-fast" [1168,1179]
                                FALSE [1180,1185]
                            FIELD [1186,1282]
                                String: "matrix" [1186,1194]
                                OBJECT [1195,1282]
                                    FIELD [1196,1251]
                                        String: "folders" [1196,1205]
                                        STRING [1206,1251]
                                            String: "${{ fromJson(needs.setup.outputs.matrix) }}" [1206,1251]
                                    FIELD [1252,1281]
                                        String: "machine_type" [1252,1266]
                                        ARRAY [1267,1281]
                                            STRING [1268,1280]
                                                String: "single-gpu" [1268,1280]
                    FIELD [1284,1359]
                        String: "runs-on" [1284,1293]
                        STRING [1294,1359]
                            String: "${{ format('{0}-{1}', matrix.machine_type, 'docker-past-ci') }}" [1294,1359]
                    FIELD [1360,1560]
                        String: "container" [1360,1371]
                        OBJECT [1372,1560]
                            FIELD [1373,1462]
                                String: "image" [1373,1380]
                                STRING [1381,1462]
                                    String: "huggingface/transformers-${{ inputs.framework }}-past-${{ inputs.version }}-gpu" [1381,1462]
                            FIELD [1463,1559]
                                String: "options" [1463,1472]
                                STRING [1473,1559]
                                    String: "--gpus 0 --shm-size \"16gb\" --ipc host -v /mnt/cache/.cache/huggingface:/mnt/cache/" [1473,1559]
                    FIELD [1561,1576]
                        String: "needs" [1561,1568]
                        STRING [1569,1576]
                            String: "setup" [1569,1576]
                    FIELD [1577,2796]
                        String: "steps" [1577,1584]
                        ARRAY [1585,2796]
                            OBJECT [1586,1697]
                                FIELD [1587,1608]
                                    String: "name" [1587,1593]
                                    STRING [1594,1608]
                                        String: "Update clone" [1594,1608]
                                FIELD [1609,1644]
                                    String: "working-directory" [1609,1628]
                                    STRING [1629,1644]
                                        String: "/transformers" [1629,1644]
                                FIELD [1645,1696]
                                    String: "run" [1645,1650]
                                    STRING [1651,1696]
                                        String: "git fetch && git checkout ${{ github.sha }}" [1651,1696]
                            OBJECT [1698,1972]
                                FIELD [1699,1741]
                                    String: "name" [1699,1705]
                                    STRING [1706,1741]
                                        String: "Echo folder ${{ matrix.folders }}" [1706,1741]
                                FIELD [1742,1756]
                                    String: "shell" [1742,1749]
                                    STRING [1750,1756]
                                        String: "bash" [1750,1756]
                                FIELD [1757,1971]
                                    String: "run" [1757,1762]
                                    STRING [1763,1971]
                                        String: "echo \"${{ matrix.folders }}\"\nmatrix_folders=${{ matrix.folders }}\nmatrix_folders=${matrix_folders/'models/'/'models_'}\necho \"$matrix_folders\"\necho \"matrix_folders=$matrix_folders\" >> $GITHUB_ENV\n" [1763,1971]
                            OBJECT [1973,2015]
                                FIELD [1974,1993]
                                    String: "name" [1974,1980]
                                    STRING [1981,1993]
                                        String: "NVIDIA-SMI" [1981,1993]
                                FIELD [1994,2014]
                                    String: "run" [1994,1999]
                                    STRING [2000,2014]
                                        String: "nvidia-smi\n" [2000,2014]
                            OBJECT [2016,2111]
                                FIELD [2017,2037]
                                    String: "name" [2017,2023]
                                    STRING [2024,2037]
                                        String: "Environment" [2024,2037]
                                FIELD [2038,2073]
                                    String: "working-directory" [2038,2057]
                                    STRING [2058,2073]
                                        String: "/transformers" [2058,2073]
                                FIELD [2074,2110]
                                    String: "run" [2074,2079]
                                    STRING [2080,2110]
                                        String: "python3 utils/print_env.py\n" [2080,2110]
                            OBJECT [2112,2310]
                                FIELD [2113,2142]
                                    String: "name" [2113,2119]
                                    STRING [2120,2142]
                                        String: "Run all tests on GPU" [2120,2142]
                                FIELD [2143,2178]
                                    String: "working-directory" [2143,2162]
                                    STRING [2163,2178]
                                        String: "/transformers" [2163,2178]
                                FIELD [2179,2309]
                                    String: "run" [2179,2184]
                                    STRING [2185,2309]
                                        String: "python3 -m pytest -v --make-reports=${{ matrix.machine_type }}_tests_gpu_${{ matrix.folders }} tests/${{ matrix.folders }}" [2185,2309]
                            OBJECT [2311,2504]
                                FIELD [2312,2342]
                                    String: "name" [2312,2318]
                                    STRING [2319,2342]
                                        String: "Failure short reports" [2319,2342]
                                FIELD [2343,2366]
                                    String: "if" [2343,2347]
                                    STRING [2348,2366]
                                        String: "${{ failure() }}" [2348,2366]
                                FIELD [2367,2391]
                                    String: "continue-on-error" [2367,2386]
                                    TRUE [2387,2391]
                                FIELD [2392,2503]
                                    String: "run" [2392,2397]
                                    STRING [2398,2503]
                                        String: "cat /transformers/reports/${{ matrix.machine_type }}_tests_gpu_${{ matrix.folders }}/failures_short.txt" [2398,2503]
                            OBJECT [2505,2795]
                                FIELD [2506,2543]
                                    String: "name" [2506,2512]
                                    STRING [2513,2543]
                                        String: "Test suite reports artifacts" [2513,2543]
                                FIELD [2544,2566]
                                    String: "if" [2544,2548]
                                    STRING [2549,2566]
                                        String: "${{ always() }}" [2549,2566]
                                FIELD [2567,2602]
                                    String: "uses" [2567,2573]
                                    STRING [2574,2602]
                                        String: "actions/upload-artifact@v2" [2574,2602]
                                FIELD [2603,2794]
                                    String: "with" [2603,2609]
                                    OBJECT [2610,2794]
                                        FIELD [2611,2703]
                                            String: "name" [2611,2617]
                                            STRING [2618,2703]
                                                String: "${{ matrix.machine_type }}_run_all_tests_gpu_${{ env.matrix_folders }}_test_reports" [2618,2703]
                                        FIELD [2704,2793]
                                            String: "path" [2704,2710]
                                            STRING [2711,2793]
                                                String: "/transformers/reports/${{ matrix.machine_type }}_tests_gpu_${{ matrix.folders }}" [2711,2793]
            FIELD [2798,4484]
                String: "run_tests_multi_gpu" [2798,2819]
                OBJECT [2820,4484]
                    FIELD [2821,2841]
                        String: "name" [2821,2827]
                        STRING [2828,2841]
                            String: "Model tests" [2828,2841]
                    FIELD [2842,2968]
                        String: "strategy" [2842,2852]
                        OBJECT [2853,2968]
                            FIELD [2854,2871]
                                String: "fail-fast" [2854,2865]
                                FALSE [2866,2871]
                            FIELD [2872,2967]
                                String: "matrix" [2872,2880]
                                OBJECT [2881,2967]
                                    FIELD [2882,2937]
                                        String: "folders" [2882,2891]
                                        STRING [2892,2937]
                                            String: "${{ fromJson(needs.setup.outputs.matrix) }}" [2892,2937]
                                    FIELD [2938,2966]
                                        String: "machine_type" [2938,2952]
                                        ARRAY [2953,2966]
                                            STRING [2954,2965]
                                                String: "multi-gpu" [2954,2965]
                    FIELD [2969,3044]
                        String: "runs-on" [2969,2978]
                        STRING [2979,3044]
                            String: "${{ format('{0}-{1}', matrix.machine_type, 'docker-past-ci') }}" [2979,3044]
                    FIELD [3045,3247]
                        String: "container" [3045,3056]
                        OBJECT [3057,3247]
                            FIELD [3058,3147]
                                String: "image" [3058,3065]
                                STRING [3066,3147]
                                    String: "huggingface/transformers-${{ inputs.framework }}-past-${{ inputs.version }}-gpu" [3066,3147]
                            FIELD [3148,3246]
                                String: "options" [3148,3157]
                                STRING [3158,3246]
                                    String: "--gpus all --shm-size \"16gb\" --ipc host -v /mnt/cache/.cache/huggingface:/mnt/cache/" [3158,3246]
                    FIELD [3248,3263]
                        String: "needs" [3248,3255]
                        STRING [3256,3263]
                            String: "setup" [3256,3263]
                    FIELD [3264,4483]
                        String: "steps" [3264,3271]
                        ARRAY [3272,4483]
                            OBJECT [3273,3384]
                                FIELD [3274,3295]
                                    String: "name" [3274,3280]
                                    STRING [3281,3295]
                                        String: "Update clone" [3281,3295]
                                FIELD [3296,3331]
                                    String: "working-directory" [3296,3315]
                                    STRING [3316,3331]
                                        String: "/transformers" [3316,3331]
                                FIELD [3332,3383]
                                    String: "run" [3332,3337]
                                    STRING [3338,3383]
                                        String: "git fetch && git checkout ${{ github.sha }}" [3338,3383]
                            OBJECT [3385,3659]
                                FIELD [3386,3428]
                                    String: "name" [3386,3392]
                                    STRING [3393,3428]
                                        String: "Echo folder ${{ matrix.folders }}" [3393,3428]
                                FIELD [3429,3443]
                                    String: "shell" [3429,3436]
                                    STRING [3437,3443]
                                        String: "bash" [3437,3443]
                                FIELD [3444,3658]
                                    String: "run" [3444,3449]
                                    STRING [3450,3658]
                                        String: "echo \"${{ matrix.folders }}\"\nmatrix_folders=${{ matrix.folders }}\nmatrix_folders=${matrix_folders/'models/'/'models_'}\necho \"$matrix_folders\"\necho \"matrix_folders=$matrix_folders\" >> $GITHUB_ENV\n" [3450,3658]
                            OBJECT [3660,3702]
                                FIELD [3661,3680]
                                    String: "name" [3661,3667]
                                    STRING [3668,3680]
                                        String: "NVIDIA-SMI" [3668,3680]
                                FIELD [3681,3701]
                                    String: "run" [3681,3686]
                                    STRING [3687,3701]
                                        String: "nvidia-smi\n" [3687,3701]
                            OBJECT [3703,3798]
                                FIELD [3704,3724]
                                    String: "name" [3704,3710]
                                    STRING [3711,3724]
                                        String: "Environment" [3711,3724]
                                FIELD [3725,3760]
                                    String: "working-directory" [3725,3744]
                                    STRING [3745,3760]
                                        String: "/transformers" [3745,3760]
                                FIELD [3761,3797]
                                    String: "run" [3761,3766]
                                    STRING [3767,3797]
                                        String: "python3 utils/print_env.py\n" [3767,3797]
                            OBJECT [3799,3997]
                                FIELD [3800,3829]
                                    String: "name" [3800,3806]
                                    STRING [3807,3829]
                                        String: "Run all tests on GPU" [3807,3829]
                                FIELD [3830,3865]
                                    String: "working-directory" [3830,3849]
                                    STRING [3850,3865]
                                        String: "/transformers" [3850,3865]
                                FIELD [3866,3996]
                                    String: "run" [3866,3871]
                                    STRING [3872,3996]
                                        String: "python3 -m pytest -v --make-reports=${{ matrix.machine_type }}_tests_gpu_${{ matrix.folders }} tests/${{ matrix.folders }}" [3872,3996]
                            OBJECT [3998,4191]
                                FIELD [3999,4029]
                                    String: "name" [3999,4005]
                                    STRING [4006,4029]
                                        String: "Failure short reports" [4006,4029]
                                FIELD [4030,4053]
                                    String: "if" [4030,4034]
                                    STRING [4035,4053]
                                        String: "${{ failure() }}" [4035,4053]
                                FIELD [4054,4078]
                                    String: "continue-on-error" [4054,4073]
                                    TRUE [4074,4078]
                                FIELD [4079,4190]
                                    String: "run" [4079,4084]
                                    STRING [4085,4190]
                                        String: "cat /transformers/reports/${{ matrix.machine_type }}_tests_gpu_${{ matrix.folders }}/failures_short.txt" [4085,4190]
                            OBJECT [4192,4482]
                                FIELD [4193,4230]
                                    String: "name" [4193,4199]
                                    STRING [4200,4230]
                                        String: "Test suite reports artifacts" [4200,4230]
                                FIELD [4231,4253]
                                    String: "if" [4231,4235]
                                    STRING [4236,4253]
                                        String: "${{ always() }}" [4236,4253]
                                FIELD [4254,4289]
                                    String: "uses" [4254,4260]
                                    STRING [4261,4289]
                                        String: "actions/upload-artifact@v2" [4261,4289]
                                FIELD [4290,4481]
                                    String: "with" [4290,4296]
                                    OBJECT [4297,4481]
                                        FIELD [4298,4390]
                                            String: "name" [4298,4304]
                                            STRING [4305,4390]
                                                String: "${{ matrix.machine_type }}_run_all_tests_gpu_${{ env.matrix_folders }}_test_reports" [4305,4390]
                                        FIELD [4391,4480]
                                            String: "path" [4391,4397]
                                            STRING [4398,4480]
                                                String: "/transformers/reports/${{ matrix.machine_type }}_tests_gpu_${{ matrix.folders }}" [4398,4480]
            FIELD [4485,5549]
                String: "send_results" [4485,4499]
                OBJECT [4500,5549]
                    FIELD [4501,4533]
                        String: "name" [4501,4507]
                        STRING [4508,4533]
                            String: "Send results to webhook" [4508,4533]
                    FIELD [4534,4559]
                        String: "runs-on" [4534,4543]
                        STRING [4544,4559]
                            String: "ubuntu-latest" [4544,4559]
                    FIELD [4560,4575]
                        String: "if" [4560,4564]
                        STRING [4565,4575]
                            String: "always()" [4565,4575]
                    FIELD [4576,4638]
                        String: "needs" [4576,4583]
                        ARRAY [4584,4638]
                            STRING [4585,4592]
                                String: "setup" [4585,4592]
                            STRING [4593,4615]
                                String: "run_tests_single_gpu" [4593,4615]
                            STRING [4616,4637]
                                String: "run_tests_multi_gpu" [4616,4637]
                    FIELD [4639,5548]
                        String: "steps" [4639,4646]
                        ARRAY [4647,5548]
                            OBJECT [4648,4678]
                                FIELD [4649,4677]
                                    String: "uses" [4649,4655]
                                    STRING [4656,4677]
                                        String: "actions/checkout@v2" [4656,4677]
                            OBJECT [4679,4718]
                                FIELD [4680,4717]
                                    String: "uses" [4680,4686]
                                    STRING [4687,4717]
                                        String: "actions/download-artifact@v2" [4687,4717]
                            OBJECT [4719,4780]
                                FIELD [4720,4745]
                                    String: "name" [4720,4726]
                                    STRING [4727,4745]
                                        String: "Create directory" [4727,4745]
                                FIELD [4746,4779]
                                    String: "run" [4746,4751]
                                    STRING [4752,4779]
                                        String: "mkdir test_failure_tables" [4752,4779]
                            OBJECT [4781,5340]
                                FIELD [4782,4812]
                                    String: "name" [4782,4788]
                                    STRING [4789,4812]
                                        String: "Send message to Slack" [4789,4812]
                                FIELD [4813,5231]
                                    String: "env" [4813,4818]
                                    OBJECT [4819,5231]
                                        FIELD [4820,4876]
                                            String: "CI_SLACK_BOT_TOKEN" [4820,4840]
                                            STRING [4841,4876]
                                                String: "${{ secrets.CI_SLACK_BOT_TOKEN }}" [4841,4876]
                                        FIELD [4877,4935]
                                            String: "CI_SLACK_CHANNEL_ID" [4877,4898]
                                            STRING [4899,4935]
                                                String: "${{ secrets.CI_SLACK_CHANNEL_ID }}" [4899,4935]
                                        FIELD [4936,5006]
                                            String: "CI_SLACK_CHANNEL_ID_DAILY" [4936,4963]
                                            STRING [4964,5006]
                                                String: "${{ secrets.CI_SLACK_CHANNEL_ID_DAILY }}" [4964,5006]
                                        FIELD [5007,5083]
                                            String: "CI_SLACK_CHANNEL_DUMMY_TESTS" [5007,5037]
                                            STRING [5038,5083]
                                                String: "${{ secrets.CI_SLACK_CHANNEL_DUMMY_TESTS }}" [5038,5083]
                                        FIELD [5084,5161]
                                            String: "CI_SLACK_REPORT_CHANNEL_ID" [5084,5112]
                                            STRING [5113,5161]
                                                String: "${{ secrets.CI_SLACK_CHANNEL_ID_PAST_FUTURE }}" [5113,5161]
                                        FIELD [5162,5230]
                                            String: "CI_EVENT" [5162,5172]
                                            STRING [5173,5230]
                                                String: "Past CI - ${{ inputs.framework }}-${{ inputs.version }}" [5173,5230]
                                FIELD [5232,5339]
                                    String: "run" [5232,5237]
                                    STRING [5238,5339]
                                        String: "pip install slack_sdk\npython utils/notification_service.py \"${{ needs.setup.outputs.matrix }}\"\n" [5238,5339]
                            OBJECT [5341,5547]
                                FIELD [5342,5374]
                                    String: "name" [5342,5348]
                                    STRING [5349,5374]
                                        String: "Failure table artifacts" [5349,5374]
                                FIELD [5375,5397]
                                    String: "if" [5375,5379]
                                    STRING [5380,5397]
                                        String: "${{ always() }}" [5380,5397]
                                FIELD [5398,5433]
                                    String: "uses" [5398,5404]
                                    STRING [5405,5433]
                                        String: "actions/upload-artifact@v2" [5405,5433]
                                FIELD [5434,5546]
                                    String: "with" [5434,5440]
                                    OBJECT [5441,5546]
                                        FIELD [5442,5516]
                                            String: "name" [5442,5448]
                                            STRING [5449,5516]
                                                String: "test_failure_tables_${{ inputs.framework }}-${{ inputs.version }}" [5449,5516]
                                        FIELD [5517,5545]
                                            String: "path" [5517,5523]
                                            STRING [5524,5545]
                                                String: "test_failure_tables" [5524,5545]