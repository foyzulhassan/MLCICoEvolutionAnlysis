OBJECT [0,9962]
    FIELD [1,35]
        String: "name" [1,7]
        STRING [8,35]
            String: "Self-hosted runner (push)" [8,35]
    FIELD [36,184]
        String: "on" [36,40]
        OBJECT [41,184]
            FIELD [42,156]
                String: "push" [42,48]
                OBJECT [49,156]
                    FIELD [50,86]
                        String: "branches" [50,60]
                        ARRAY [61,86]
                            STRING [62,71]
                                String: "push-ci" [62,71]
                            STRING [72,78]
                                String: "ci_*" [72,78]
                            STRING [79,85]
                                String: "ci-*" [79,85]
                    FIELD [87,155]
                        String: "paths" [87,94]
                        ARRAY [95,155]
                            STRING [96,104]
                                String: "src/**" [96,104]
                            STRING [105,115]
                                String: "tests/**" [105,115]
                            STRING [116,128]
                                String: ".github/**" [116,128]
                            STRING [129,143]
                                String: "templates/**" [129,143]
                            STRING [144,154]
                                String: "utils/**" [144,154]
            FIELD [157,183]
                String: "repository_dispatch" [157,178]
                NULL [179,183]
    FIELD [185,360]
        String: "env" [185,190]
        OBJECT [191,360]
            FIELD [192,214]
                String: "HF_HOME" [192,201]
                STRING [202,214]
                    String: "/mnt/cache" [202,214]
            FIELD [215,240]
                String: "TRANSFORMERS_IS_CI" [215,235]
                TRUE [236,240]
            FIELD [241,260]
                String: "OMP_NUM_THREADS" [241,258]
                NUMBER [259,260]
                    Number: 8 [259,260]
            FIELD [261,280]
                String: "MKL_NUM_THREADS" [261,278]
                NUMBER [279,280]
                    Number: 8 [279,280]
            FIELD [281,300]
                String: "PYTEST_TIMEOUT" [281,297]
                NUMBER [298,300]
                    Number: 60 [298,300]
            FIELD [301,333]
                String: "TF_FORCE_GPU_ALLOW_GROWTH" [301,328]
                TRUE [329,333]
            FIELD [334,359]
                String: "RUN_PT_TF_CROSS_TESTS" [334,357]
                NUMBER [358,359]
                    Number: 1 [358,359]
    FIELD [361,9961]
        String: "jobs" [361,367]
        OBJECT [368,9961]
            FIELD [369,1649]
                String: "setup" [369,376]
                OBJECT [377,1649]
                    FIELD [378,392]
                        String: "name" [378,384]
                        STRING [385,392]
                            String: "Setup" [385,392]
                    FIELD [393,418]
                        String: "runs-on" [393,402]
                        STRING [403,418]
                            String: "ubuntu-latest" [403,418]
                    FIELD [419,534]
                        String: "outputs" [419,428]
                        OBJECT [429,534]
                            FIELD [430,479]
                                String: "matrix" [430,438]
                                STRING [439,479]
                                    String: "${{ steps.set-matrix.outputs.matrix }}" [439,479]
                            FIELD [480,533]
                                String: "test_map" [480,490]
                                STRING [491,533]
                                    String: "${{ steps.set-matrix.outputs.test_map }}" [491,533]
                    FIELD [535,1648]
                        String: "steps" [535,542]
                        ARRAY [543,1648]
                            OBJECT [544,630]
                                FIELD [545,575]
                                    String: "name" [545,551]
                                    STRING [552,575]
                                        String: "Checkout transformers" [552,575]
                                FIELD [576,604]
                                    String: "uses" [576,582]
                                    STRING [583,604]
                                        String: "actions/checkout@v2" [583,604]
                                FIELD [605,629]
                                    String: "with" [605,611]
                                    OBJECT [612,629]
                                        FIELD [613,628]
                                            String: "fetch-depth" [613,626]
                                            NUMBER [627,628]
                                                Number: 2 [627,628]
                            OBJECT [631,733]
                                FIELD [632,648]
                                    String: "name" [632,638]
                                    STRING [639,648]
                                        String: "Cleanup" [639,648]
                                FIELD [649,732]
                                    String: "run" [649,654]
                                    STRING [655,732]
                                        String: "rm -rf tests/__pycache__\nrm -rf tests/models/__pycache__\nrm -rf reports\n" [655,732]
                            OBJECT [734,892]
                                FIELD [735,766]
                                    String: "name" [735,741]
                                    STRING [742,766]
                                        String: "Fetch the tests to run" [742,766]
                                FIELD [767,891]
                                    String: "run" [767,772]
                                    STRING [773,891]
                                        String: "pip install --upgrade git-python\npython utils/tests_fetcher.py --diff_with_last_commit | tee test_preparation.txt\n" [773,891]
                            OBJECT [893,1021]
                                FIELD [894,923]
                                    String: "name" [894,900]
                                    STRING [901,923]
                                        String: "Report fetched tests" [901,923]
                                FIELD [924,959]
                                    String: "uses" [924,930]
                                    STRING [931,959]
                                        String: "actions/upload-artifact@v2" [931,959]
                                FIELD [960,1020]
                                    String: "with" [960,966]
                                    OBJECT [967,1020]
                                        FIELD [968,989]
                                            String: "name" [968,974]
                                            STRING [975,989]
                                                String: "test_fetched" [975,989]
                                        FIELD [990,1019]
                                            String: "path" [990,996]
                                            STRING [997,1019]
                                                String: "test_preparation.txt" [997,1019]
                            OBJECT [1022,1647]
                                FIELD [1023,1040]
                                    String: "id" [1023,1027]
                                    STRING [1028,1040]
                                        String: "set-matrix" [1028,1040]
                                FIELD [1041,1076]
                                    String: "name" [1041,1047]
                                    STRING [1048,1076]
                                        String: "Organize tests into models" [1048,1076]
                                FIELD [1077,1646]
                                    String: "run" [1077,1082]
                                    STRING [1083,1646]
                                        String: "if [ -f test_map.json ]; then\n    keys=$(python3 -c 'import json; fp = open(\"test_map.json\"); test_map = json.load(fp); fp.close(); d = list(test_map.keys()); print(d)')\n    test_map=$(python3 -c 'import json; fp = open(\"test_map.json\"); test_map = json.load(fp); fp.close(); print(test_map)')\nelse\n    keys=$(python3 -c 'keys = [\"dummy\"]; print(keys)')\n    test_map=$(python3 -c 'test_map = {\"dummy\": []}; print(test_map)')\nfi\necho $keys\necho $test_map\necho \"::set-output name=matrix::$keys\"\necho \"::set-output name=test_map::$test_map\"\n" [1083,1646]
            FIELD [1650,3506]
                String: "run_tests_single_gpu" [1650,1672]
                OBJECT [1673,3506]
                    FIELD [1674,1694]
                        String: "name" [1674,1680]
                        STRING [1681,1694]
                            String: "Model tests" [1681,1694]
                    FIELD [1695,1710]
                        String: "needs" [1695,1702]
                        STRING [1703,1710]
                            String: "setup" [1703,1710]
                    FIELD [1711,1781]
                        String: "if" [1711,1715]
                        STRING [1716,1781]
                            String: "contains(fromJson(needs.setup.outputs.matrix), 'dummy') != true" [1716,1781]
                    FIELD [1782,1909]
                        String: "strategy" [1782,1792]
                        OBJECT [1793,1909]
                            FIELD [1794,1811]
                                String: "fail-fast" [1794,1805]
                                FALSE [1806,1811]
                            FIELD [1812,1908]
                                String: "matrix" [1812,1820]
                                OBJECT [1821,1908]
                                    FIELD [1822,1877]
                                        String: "folders" [1822,1831]
                                        STRING [1832,1877]
                                            String: "${{ fromJson(needs.setup.outputs.matrix) }}" [1832,1877]
                                    FIELD [1878,1907]
                                        String: "machine_type" [1878,1892]
                                        ARRAY [1893,1907]
                                            STRING [1894,1906]
                                                String: "single-gpu" [1894,1906]
                    FIELD [1910,1977]
                        String: "runs-on" [1910,1919]
                        ARRAY [1920,1977]
                            STRING [1921,1934]
                                String: "self-hosted" [1921,1934]
                            STRING [1935,1947]
                                String: "docker-gpu" [1935,1947]
                            STRING [1948,1976]
                                String: "${{ matrix.machine_type }}" [1948,1976]
                    FIELD [1978,2138]
                        String: "container" [1978,1989]
                        OBJECT [1990,2138]
                            FIELD [1991,2040]
                                String: "image" [1991,1998]
                                STRING [1999,2040]
                                    String: "huggingface/transformers-all-latest-gpu" [1999,2040]
                            FIELD [2041,2137]
                                String: "options" [2041,2050]
                                STRING [2051,2137]
                                    String: "--gpus 0 --shm-size \"16gb\" --ipc host -v /mnt/cache/.cache/huggingface:/mnt/cache/" [2051,2137]
                    FIELD [2139,3505]
                        String: "steps" [2139,2146]
                        ARRAY [2147,3505]
                            OBJECT [2148,2494]
                                FIELD [2149,2191]
                                    String: "name" [2149,2155]
                                    STRING [2156,2191]
                                        String: "Echo folder ${{ matrix.folders }}" [2156,2191]
                                FIELD [2192,2206]
                                    String: "shell" [2192,2199]
                                    STRING [2200,2206]
                                        String: "bash" [2200,2206]
                                FIELD [2207,2493]
                                    String: "run" [2207,2212]
                                    STRING [2213,2493]
                                        String: "echo \"${{ matrix.folders }}\"\necho \"${{ fromJson(needs.setup.outputs.test_map)[matrix.folders] }}\"\nmatrix_folders=${{ matrix.folders }}\nmatrix_folders=${matrix_folders/'models/'/'models_'}\necho \"$matrix_folders\"\necho \"matrix_folders=$matrix_folders\" >> $GITHUB_ENV\n" [2213,2493]
                            OBJECT [2495,2606]
                                FIELD [2496,2517]
                                    String: "name" [2496,2502]
                                    STRING [2503,2517]
                                        String: "Update clone" [2503,2517]
                                FIELD [2518,2553]
                                    String: "working-directory" [2518,2537]
                                    STRING [2538,2553]
                                        String: "/transformers" [2538,2553]
                                FIELD [2554,2605]
                                    String: "run" [2554,2559]
                                    STRING [2560,2605]
                                        String: "git fetch && git checkout ${{ github.sha }}" [2560,2605]
                            OBJECT [2607,2649]
                                FIELD [2608,2627]
                                    String: "name" [2608,2614]
                                    STRING [2615,2627]
                                        String: "NVIDIA-SMI" [2615,2627]
                                FIELD [2628,2648]
                                    String: "run" [2628,2633]
                                    STRING [2634,2648]
                                        String: "nvidia-smi\n" [2634,2648]
                            OBJECT [2650,2745]
                                FIELD [2651,2671]
                                    String: "name" [2651,2657]
                                    STRING [2658,2671]
                                        String: "Environment" [2658,2671]
                                FIELD [2672,2707]
                                    String: "working-directory" [2672,2691]
                                    STRING [2692,2707]
                                        String: "/transformers" [2692,2707]
                                FIELD [2708,2744]
                                    String: "run" [2708,2713]
                                    STRING [2714,2744]
                                        String: "python3 utils/print_env.py\n" [2714,2744]
                            OBJECT [2746,3019]
                                FIELD [2747,2794]
                                    String: "name" [2747,2753]
                                    STRING [2754,2794]
                                        String: "Run all non-slow selected tests on GPU" [2754,2794]
                                FIELD [2795,2830]
                                    String: "working-directory" [2795,2814]
                                    STRING [2815,2830]
                                        String: "/transformers" [2815,2830]
                                FIELD [2831,3018]
                                    String: "run" [2831,2836]
                                    STRING [2837,3018]
                                        String: "python3 -m pytest -n 2 --dist=loadfile -v --make-reports=${{ matrix.machine_type }}_tests_gpu_${{ matrix.folders }} ${{ fromJson(needs.setup.outputs.test_map)[matrix.folders] }}\n" [2837,3018]
                            OBJECT [3020,3213]
                                FIELD [3021,3051]
                                    String: "name" [3021,3027]
                                    STRING [3028,3051]
                                        String: "Failure short reports" [3028,3051]
                                FIELD [3052,3075]
                                    String: "if" [3052,3056]
                                    STRING [3057,3075]
                                        String: "${{ failure() }}" [3057,3075]
                                FIELD [3076,3100]
                                    String: "continue-on-error" [3076,3095]
                                    TRUE [3096,3100]
                                FIELD [3101,3212]
                                    String: "run" [3101,3106]
                                    STRING [3107,3212]
                                        String: "cat /transformers/reports/${{ matrix.machine_type }}_tests_gpu_${{ matrix.folders }}/failures_short.txt" [3107,3212]
                            OBJECT [3214,3504]
                                FIELD [3215,3252]
                                    String: "name" [3215,3221]
                                    STRING [3222,3252]
                                        String: "Test suite reports artifacts" [3222,3252]
                                FIELD [3253,3275]
                                    String: "if" [3253,3257]
                                    STRING [3258,3275]
                                        String: "${{ always() }}" [3258,3275]
                                FIELD [3276,3311]
                                    String: "uses" [3276,3282]
                                    STRING [3283,3311]
                                        String: "actions/upload-artifact@v2" [3283,3311]
                                FIELD [3312,3503]
                                    String: "with" [3312,3318]
                                    OBJECT [3319,3503]
                                        FIELD [3320,3412]
                                            String: "name" [3320,3326]
                                            STRING [3327,3412]
                                                String: "${{ matrix.machine_type }}_run_all_tests_gpu_${{ env.matrix_folders }}_test_reports" [3327,3412]
                                        FIELD [3413,3502]
                                            String: "path" [3413,3419]
                                            STRING [3420,3502]
                                                String: "/transformers/reports/${{ matrix.machine_type }}_tests_gpu_${{ matrix.folders }}" [3420,3502]
            FIELD [3507,5399]
                String: "run_tests_multi_gpu" [3507,3528]
                OBJECT [3529,5399]
                    FIELD [3530,3550]
                        String: "name" [3530,3536]
                        STRING [3537,3550]
                            String: "Model tests" [3537,3550]
                    FIELD [3551,3566]
                        String: "needs" [3551,3558]
                        STRING [3559,3566]
                            String: "setup" [3559,3566]
                    FIELD [3567,3637]
                        String: "if" [3567,3571]
                        STRING [3572,3637]
                            String: "contains(fromJson(needs.setup.outputs.matrix), 'dummy') != true" [3572,3637]
                    FIELD [3638,3764]
                        String: "strategy" [3638,3648]
                        OBJECT [3649,3764]
                            FIELD [3650,3667]
                                String: "fail-fast" [3650,3661]
                                FALSE [3662,3667]
                            FIELD [3668,3763]
                                String: "matrix" [3668,3676]
                                OBJECT [3677,3763]
                                    FIELD [3678,3733]
                                        String: "folders" [3678,3687]
                                        STRING [3688,3733]
                                            String: "${{ fromJson(needs.setup.outputs.matrix) }}" [3688,3733]
                                    FIELD [3734,3762]
                                        String: "machine_type" [3734,3748]
                                        ARRAY [3749,3762]
                                            STRING [3750,3761]
                                                String: "multi-gpu" [3750,3761]
                    FIELD [3765,3832]
                        String: "runs-on" [3765,3774]
                        ARRAY [3775,3832]
                            STRING [3776,3789]
                                String: "self-hosted" [3776,3789]
                            STRING [3790,3802]
                                String: "docker-gpu" [3790,3802]
                            STRING [3803,3831]
                                String: "${{ matrix.machine_type }}" [3803,3831]
                    FIELD [3833,3995]
                        String: "container" [3833,3844]
                        OBJECT [3845,3995]
                            FIELD [3846,3895]
                                String: "image" [3846,3853]
                                STRING [3854,3895]
                                    String: "huggingface/transformers-all-latest-gpu" [3854,3895]
                            FIELD [3896,3994]
                                String: "options" [3896,3905]
                                STRING [3906,3994]
                                    String: "--gpus all --shm-size \"16gb\" --ipc host -v /mnt/cache/.cache/huggingface:/mnt/cache/" [3906,3994]
                    FIELD [3996,5398]
                        String: "steps" [3996,4003]
                        ARRAY [4004,5398]
                            OBJECT [4005,4351]
                                FIELD [4006,4048]
                                    String: "name" [4006,4012]
                                    STRING [4013,4048]
                                        String: "Echo folder ${{ matrix.folders }}" [4013,4048]
                                FIELD [4049,4063]
                                    String: "shell" [4049,4056]
                                    STRING [4057,4063]
                                        String: "bash" [4057,4063]
                                FIELD [4064,4350]
                                    String: "run" [4064,4069]
                                    STRING [4070,4350]
                                        String: "echo \"${{ matrix.folders }}\"\necho \"${{ fromJson(needs.setup.outputs.test_map)[matrix.folders] }}\"\nmatrix_folders=${{ matrix.folders }}\nmatrix_folders=${matrix_folders/'models/'/'models_'}\necho \"$matrix_folders\"\necho \"matrix_folders=$matrix_folders\" >> $GITHUB_ENV\n" [4070,4350]
                            OBJECT [4352,4463]
                                FIELD [4353,4374]
                                    String: "name" [4353,4359]
                                    STRING [4360,4374]
                                        String: "Update clone" [4360,4374]
                                FIELD [4375,4410]
                                    String: "working-directory" [4375,4394]
                                    STRING [4395,4410]
                                        String: "/transformers" [4395,4410]
                                FIELD [4411,4462]
                                    String: "run" [4411,4416]
                                    STRING [4417,4462]
                                        String: "git fetch && git checkout ${{ github.sha }}" [4417,4462]
                            OBJECT [4464,4506]
                                FIELD [4465,4484]
                                    String: "name" [4465,4471]
                                    STRING [4472,4484]
                                        String: "NVIDIA-SMI" [4472,4484]
                                FIELD [4485,4505]
                                    String: "run" [4485,4490]
                                    STRING [4491,4505]
                                        String: "nvidia-smi\n" [4491,4505]
                            OBJECT [4507,4602]
                                FIELD [4508,4528]
                                    String: "name" [4508,4514]
                                    STRING [4515,4528]
                                        String: "Environment" [4515,4528]
                                FIELD [4529,4564]
                                    String: "working-directory" [4529,4548]
                                    STRING [4549,4564]
                                        String: "/transformers" [4549,4564]
                                FIELD [4565,4601]
                                    String: "run" [4565,4570]
                                    STRING [4571,4601]
                                        String: "python3 utils/print_env.py\n" [4571,4601]
                            OBJECT [4603,4912]
                                FIELD [4604,4651]
                                    String: "name" [4604,4610]
                                    STRING [4611,4651]
                                        String: "Run all non-slow selected tests on GPU" [4611,4651]
                                FIELD [4652,4687]
                                    String: "env" [4652,4657]
                                    OBJECT [4658,4687]
                                        FIELD [4659,4686]
                                            String: "MKL_SERVICE_FORCE_INTEL" [4659,4684]
                                            NUMBER [4685,4686]
                                                Number: 1 [4685,4686]
                                FIELD [4688,4723]
                                    String: "working-directory" [4688,4707]
                                    STRING [4708,4723]
                                        String: "/transformers" [4708,4723]
                                FIELD [4724,4911]
                                    String: "run" [4724,4729]
                                    STRING [4730,4911]
                                        String: "python3 -m pytest -n 2 --dist=loadfile -v --make-reports=${{ matrix.machine_type }}_tests_gpu_${{ matrix.folders }} ${{ fromJson(needs.setup.outputs.test_map)[matrix.folders] }}\n" [4730,4911]
                            OBJECT [4913,5106]
                                FIELD [4914,4944]
                                    String: "name" [4914,4920]
                                    STRING [4921,4944]
                                        String: "Failure short reports" [4921,4944]
                                FIELD [4945,4968]
                                    String: "if" [4945,4949]
                                    STRING [4950,4968]
                                        String: "${{ failure() }}" [4950,4968]
                                FIELD [4969,4993]
                                    String: "continue-on-error" [4969,4988]
                                    TRUE [4989,4993]
                                FIELD [4994,5105]
                                    String: "run" [4994,4999]
                                    STRING [5000,5105]
                                        String: "cat /transformers/reports/${{ matrix.machine_type }}_tests_gpu_${{ matrix.folders }}/failures_short.txt" [5000,5105]
                            OBJECT [5107,5397]
                                FIELD [5108,5145]
                                    String: "name" [5108,5114]
                                    STRING [5115,5145]
                                        String: "Test suite reports artifacts" [5115,5145]
                                FIELD [5146,5168]
                                    String: "if" [5146,5150]
                                    STRING [5151,5168]
                                        String: "${{ always() }}" [5151,5168]
                                FIELD [5169,5204]
                                    String: "uses" [5169,5175]
                                    STRING [5176,5204]
                                        String: "actions/upload-artifact@v2" [5176,5204]
                                FIELD [5205,5396]
                                    String: "with" [5205,5211]
                                    OBJECT [5212,5396]
                                        FIELD [5213,5305]
                                            String: "name" [5213,5219]
                                            STRING [5220,5305]
                                                String: "${{ matrix.machine_type }}_run_all_tests_gpu_${{ env.matrix_folders }}_test_reports" [5220,5305]
                                        FIELD [5306,5395]
                                            String: "path" [5306,5312]
                                            STRING [5313,5395]
                                                String: "/transformers/reports/${{ matrix.machine_type }}_tests_gpu_${{ matrix.folders }}" [5313,5395]
            FIELD [5400,7146]
                String: "run_tests_torch_cuda_extensions_single_gpu" [5400,5444]
                OBJECT [5445,7146]
                    FIELD [5446,5481]
                        String: "name" [5446,5452]
                        STRING [5453,5481]
                            String: "Torch CUDA extension tests" [5453,5481]
                    FIELD [5482,5497]
                        String: "needs" [5482,5489]
                        STRING [5490,5497]
                            String: "setup" [5490,5497]
                    FIELD [5498,5626]
                        String: "if" [5498,5502]
                        STRING [5503,5626]
                            String: "contains(fromJson(needs.setup.outputs.matrix), 'deepspeed') || contains(fromJson(needs.setup.outputs.matrix), 'extended')" [5503,5626]
                    FIELD [5627,5698]
                        String: "strategy" [5627,5637]
                        OBJECT [5638,5698]
                            FIELD [5639,5656]
                                String: "fail-fast" [5639,5650]
                                FALSE [5651,5656]
                            FIELD [5657,5697]
                                String: "matrix" [5657,5665]
                                OBJECT [5666,5697]
                                    FIELD [5667,5696]
                                        String: "machine_type" [5667,5681]
                                        ARRAY [5682,5696]
                                            STRING [5683,5695]
                                                String: "single-gpu" [5683,5695]
                    FIELD [5699,5766]
                        String: "runs-on" [5699,5708]
                        ARRAY [5709,5766]
                            STRING [5710,5723]
                                String: "self-hosted" [5710,5723]
                            STRING [5724,5736]
                                String: "docker-gpu" [5724,5736]
                            STRING [5737,5765]
                                String: "${{ matrix.machine_type }}" [5737,5765]
                    FIELD [5767,5941]
                        String: "container" [5767,5778]
                        OBJECT [5779,5941]
                            FIELD [5780,5843]
                                String: "image" [5780,5787]
                                STRING [5788,5843]
                                    String: "huggingface/transformers-pytorch-deepspeed-latest-gpu" [5788,5843]
                            FIELD [5844,5940]
                                String: "options" [5844,5853]
                                STRING [5854,5940]
                                    String: "--gpus 0 --shm-size \"16gb\" --ipc host -v /mnt/cache/.cache/huggingface:/mnt/cache/" [5854,5940]
                    FIELD [5942,7145]
                        String: "steps" [5942,5949]
                        ARRAY [5950,7145]
                            OBJECT [5951,6072]
                                FIELD [5952,5973]
                                    String: "name" [5952,5958]
                                    STRING [5959,5973]
                                        String: "Update clone" [5959,5973]
                                FIELD [5974,6019]
                                    String: "working-directory" [5974,5993]
                                    STRING [5994,6019]
                                        String: "/workspace/transformers" [5994,6019]
                                FIELD [6020,6071]
                                    String: "run" [6020,6025]
                                    STRING [6026,6071]
                                        String: "git fetch && git checkout ${{ github.sha }}" [6026,6071]
                            OBJECT [6073,6387]
                                FIELD [6074,6110]
                                    String: "name" [6074,6080]
                                    STRING [6081,6110]
                                        String: "Pre build DeepSpeed *again*" [6081,6110]
                                FIELD [6111,6156]
                                    String: "working-directory" [6111,6130]
                                    STRING [6131,6156]
                                        String: "/workspace/transformers" [6131,6156]
                                FIELD [6157,6386]
                                    String: "run" [6157,6162]
                                    STRING [6163,6386]
                                        String: "python3 -m pip uninstall -y deepspeed\nDS_BUILD_CPU_ADAM=1 DS_BUILD_AIO=1 DS_BUILD_UTILS=1 python3 -m pip install deepspeed --global-option=\"build_ext\" --global-option=\"-j8\" --no-cache -v --disable-pip-version-check\n" [6163,6386]
                            OBJECT [6388,6430]
                                FIELD [6389,6408]
                                    String: "name" [6389,6395]
                                    STRING [6396,6408]
                                        String: "NVIDIA-SMI" [6396,6408]
                                FIELD [6409,6429]
                                    String: "run" [6409,6414]
                                    STRING [6415,6429]
                                        String: "nvidia-smi\n" [6415,6429]
                            OBJECT [6431,6489]
                                FIELD [6432,6452]
                                    String: "name" [6432,6438]
                                    STRING [6439,6452]
                                        String: "Environment" [6439,6452]
                                FIELD [6453,6488]
                                    String: "run" [6453,6458]
                                    STRING [6459,6488]
                                        String: "python utils/print_env.py\n" [6459,6488]
                            OBJECT [6490,6695]
                                FIELD [6491,6538]
                                    String: "name" [6491,6497]
                                    STRING [6498,6538]
                                        String: "Run all non-slow selected tests on GPU" [6498,6538]
                                FIELD [6539,6694]
                                    String: "run" [6539,6544]
                                    STRING [6545,6694]
                                        String: "python -m pytest -n 1 --dist=loadfile -v --make-reports=${{ matrix.machine_type }}_tests_torch_cuda_extensions_gpu tests/deepspeed tests/extended\n" [6545,6694]
                            OBJECT [6696,6875]
                                FIELD [6697,6727]
                                    String: "name" [6697,6703]
                                    STRING [6704,6727]
                                        String: "Failure short reports" [6704,6727]
                                FIELD [6728,6751]
                                    String: "if" [6728,6732]
                                    STRING [6733,6751]
                                        String: "${{ failure() }}" [6733,6751]
                                FIELD [6752,6776]
                                    String: "continue-on-error" [6752,6771]
                                    TRUE [6772,6776]
                                FIELD [6777,6874]
                                    String: "run" [6777,6782]
                                    STRING [6783,6874]
                                        String: "cat reports/${{ matrix.machine_type }}_tests_torch_cuda_extensions_gpu/failures_short.txt" [6783,6874]
                            OBJECT [6876,7144]
                                FIELD [6877,6914]
                                    String: "name" [6877,6883]
                                    STRING [6884,6914]
                                        String: "Test suite reports artifacts" [6884,6914]
                                FIELD [6915,6937]
                                    String: "if" [6915,6919]
                                    STRING [6920,6937]
                                        String: "${{ always() }}" [6920,6937]
                                FIELD [6938,6973]
                                    String: "uses" [6938,6944]
                                    STRING [6945,6973]
                                        String: "actions/upload-artifact@v2" [6945,6973]
                                FIELD [6974,7143]
                                    String: "with" [6974,6980]
                                    OBJECT [6981,7143]
                                        FIELD [6982,7066]
                                            String: "name" [6982,6988]
                                            STRING [6989,7066]
                                                String: "${{ matrix.machine_type }}_run_tests_torch_cuda_extensions_gpu_test_reports" [6989,7066]
                                        FIELD [7067,7142]
                                            String: "path" [7067,7073]
                                            STRING [7074,7142]
                                                String: "reports/${{ matrix.machine_type }}_tests_torch_cuda_extensions_gpu" [7074,7142]
            FIELD [7147,9033]
                String: "run_tests_torch_cuda_extensions_multi_gpu" [7147,7190]
                OBJECT [7191,9033]
                    FIELD [7192,7227]
                        String: "name" [7192,7198]
                        STRING [7199,7227]
                            String: "Torch CUDA extension tests" [7199,7227]
                    FIELD [7228,7243]
                        String: "needs" [7228,7235]
                        STRING [7236,7243]
                            String: "setup" [7236,7243]
                    FIELD [7244,7372]
                        String: "if" [7244,7248]
                        STRING [7249,7372]
                            String: "contains(fromJson(needs.setup.outputs.matrix), 'deepspeed') || contains(fromJson(needs.setup.outputs.matrix), 'extended')" [7249,7372]
                    FIELD [7373,7443]
                        String: "strategy" [7373,7383]
                        OBJECT [7384,7443]
                            FIELD [7385,7402]
                                String: "fail-fast" [7385,7396]
                                FALSE [7397,7402]
                            FIELD [7403,7442]
                                String: "matrix" [7403,7411]
                                OBJECT [7412,7442]
                                    FIELD [7413,7441]
                                        String: "machine_type" [7413,7427]
                                        ARRAY [7428,7441]
                                            STRING [7429,7440]
                                                String: "multi-gpu" [7429,7440]
                    FIELD [7444,7511]
                        String: "runs-on" [7444,7453]
                        ARRAY [7454,7511]
                            STRING [7455,7468]
                                String: "self-hosted" [7455,7468]
                            STRING [7469,7481]
                                String: "docker-gpu" [7469,7481]
                            STRING [7482,7510]
                                String: "${{ matrix.machine_type }}" [7482,7510]
                    FIELD [7512,7688]
                        String: "container" [7512,7523]
                        OBJECT [7524,7688]
                            FIELD [7525,7588]
                                String: "image" [7525,7532]
                                STRING [7533,7588]
                                    String: "huggingface/transformers-pytorch-deepspeed-latest-gpu" [7533,7588]
                            FIELD [7589,7687]
                                String: "options" [7589,7598]
                                STRING [7599,7687]
                                    String: "--gpus all --shm-size \"16gb\" --ipc host -v /mnt/cache/.cache/huggingface:/mnt/cache/" [7599,7687]
                    FIELD [7689,9032]
                        String: "steps" [7689,7696]
                        ARRAY [7697,9032]
                            OBJECT [7698,7819]
                                FIELD [7699,7720]
                                    String: "name" [7699,7705]
                                    STRING [7706,7720]
                                        String: "Update clone" [7706,7720]
                                FIELD [7721,7766]
                                    String: "working-directory" [7721,7740]
                                    STRING [7741,7766]
                                        String: "/workspace/transformers" [7741,7766]
                                FIELD [7767,7818]
                                    String: "run" [7767,7772]
                                    STRING [7773,7818]
                                        String: "git fetch && git checkout ${{ github.sha }}" [7773,7818]
                            OBJECT [7820,8134]
                                FIELD [7821,7857]
                                    String: "name" [7821,7827]
                                    STRING [7828,7857]
                                        String: "Pre build DeepSpeed *again*" [7828,7857]
                                FIELD [7858,7903]
                                    String: "working-directory" [7858,7877]
                                    STRING [7878,7903]
                                        String: "/workspace/transformers" [7878,7903]
                                FIELD [7904,8133]
                                    String: "run" [7904,7909]
                                    STRING [7910,8133]
                                        String: "python3 -m pip uninstall -y deepspeed\nDS_BUILD_CPU_ADAM=1 DS_BUILD_AIO=1 DS_BUILD_UTILS=1 python3 -m pip install deepspeed --global-option=\"build_ext\" --global-option=\"-j8\" --no-cache -v --disable-pip-version-check\n" [7910,8133]
                            OBJECT [8135,8177]
                                FIELD [8136,8155]
                                    String: "name" [8136,8142]
                                    STRING [8143,8155]
                                        String: "NVIDIA-SMI" [8143,8155]
                                FIELD [8156,8176]
                                    String: "run" [8156,8161]
                                    STRING [8162,8176]
                                        String: "nvidia-smi\n" [8162,8176]
                            OBJECT [8178,8282]
                                FIELD [8179,8199]
                                    String: "name" [8179,8185]
                                    STRING [8186,8199]
                                        String: "Environment" [8186,8199]
                                FIELD [8200,8245]
                                    String: "working-directory" [8200,8219]
                                    STRING [8220,8245]
                                        String: "/workspace/transformers" [8220,8245]
                                FIELD [8246,8281]
                                    String: "run" [8246,8251]
                                    STRING [8252,8281]
                                        String: "python utils/print_env.py\n" [8252,8281]
                            OBJECT [8283,8534]
                                FIELD [8284,8331]
                                    String: "name" [8284,8290]
                                    STRING [8291,8331]
                                        String: "Run all non-slow selected tests on GPU" [8291,8331]
                                FIELD [8332,8377]
                                    String: "working-directory" [8332,8351]
                                    STRING [8352,8377]
                                        String: "/workspace/transformers" [8352,8377]
                                FIELD [8378,8533]
                                    String: "run" [8378,8383]
                                    STRING [8384,8533]
                                        String: "python -m pytest -n 1 --dist=loadfile -v --make-reports=${{ matrix.machine_type }}_tests_torch_cuda_extensions_gpu tests/deepspeed tests/extended\n" [8384,8533]
                            OBJECT [8535,8738]
                                FIELD [8536,8566]
                                    String: "name" [8536,8542]
                                    STRING [8543,8566]
                                        String: "Failure short reports" [8543,8566]
                                FIELD [8567,8590]
                                    String: "if" [8567,8571]
                                    STRING [8572,8590]
                                        String: "${{ failure() }}" [8572,8590]
                                FIELD [8591,8615]
                                    String: "continue-on-error" [8591,8610]
                                    TRUE [8611,8615]
                                FIELD [8616,8737]
                                    String: "run" [8616,8621]
                                    STRING [8622,8737]
                                        String: "cat /workspace/transformers/reports/${{ matrix.machine_type }}_tests_torch_cuda_extensions_gpu/failures_short.txt" [8622,8737]
                            OBJECT [8739,9031]
                                FIELD [8740,8777]
                                    String: "name" [8740,8746]
                                    STRING [8747,8777]
                                        String: "Test suite reports artifacts" [8747,8777]
                                FIELD [8778,8800]
                                    String: "if" [8778,8782]
                                    STRING [8783,8800]
                                        String: "${{ always() }}" [8783,8800]
                                FIELD [8801,8836]
                                    String: "uses" [8801,8807]
                                    STRING [8808,8836]
                                        String: "actions/upload-artifact@v2" [8808,8836]
                                FIELD [8837,9030]
                                    String: "with" [8837,8843]
                                    OBJECT [8844,9030]
                                        FIELD [8845,8929]
                                            String: "name" [8845,8851]
                                            STRING [8852,8929]
                                                String: "${{ matrix.machine_type }}_run_tests_torch_cuda_extensions_gpu_test_reports" [8852,8929]
                                        FIELD [8930,9029]
                                            String: "path" [8930,8936]
                                            STRING [8937,9029]
                                                String: "/workspace/transformers/reports/${{ matrix.machine_type }}_tests_torch_cuda_extensions_gpu" [8937,9029]
            FIELD [9034,9960]
                String: "send_results" [9034,9048]
                OBJECT [9049,9960]
                    FIELD [9050,9082]
                        String: "name" [9050,9056]
                        STRING [9057,9082]
                            String: "Send results to webhook" [9057,9082]
                    FIELD [9083,9108]
                        String: "runs-on" [9083,9092]
                        STRING [9093,9108]
                            String: "ubuntu-latest" [9093,9108]
                    FIELD [9109,9124]
                        String: "if" [9109,9113]
                        STRING [9114,9124]
                            String: "always()" [9114,9124]
                    FIELD [9125,9276]
                        String: "needs" [9125,9132]
                        ARRAY [9133,9276]
                            STRING [9134,9141]
                                String: "setup" [9134,9141]
                            STRING [9142,9164]
                                String: "run_tests_single_gpu" [9142,9164]
                            STRING [9165,9186]
                                String: "run_tests_multi_gpu" [9165,9186]
                            STRING [9187,9231]
                                String: "run_tests_torch_cuda_extensions_single_gpu" [9187,9231]
                            STRING [9232,9275]
                                String: "run_tests_torch_cuda_extensions_multi_gpu" [9232,9275]
                    FIELD [9277,9959]
                        String: "steps" [9277,9284]
                        ARRAY [9285,9959]
                            OBJECT [9286,9316]
                                FIELD [9287,9315]
                                    String: "uses" [9287,9293]
                                    STRING [9294,9315]
                                        String: "actions/checkout@v2" [9294,9315]
                            OBJECT [9317,9356]
                                FIELD [9318,9355]
                                    String: "uses" [9318,9324]
                                    STRING [9325,9355]
                                        String: "actions/download-artifact@v2" [9325,9355]
                            OBJECT [9357,9958]
                                FIELD [9358,9388]
                                    String: "name" [9358,9364]
                                    STRING [9365,9388]
                                        String: "Send message to Slack" [9365,9388]
                                FIELD [9389,9851]
                                    String: "env" [9389,9394]
                                    OBJECT [9395,9851]
                                        FIELD [9396,9452]
                                            String: "CI_SLACK_BOT_TOKEN" [9396,9416]
                                            STRING [9417,9452]
                                                String: "${{ secrets.CI_SLACK_BOT_TOKEN }}" [9417,9452]
                                        FIELD [9453,9511]
                                            String: "CI_SLACK_CHANNEL_ID" [9453,9474]
                                            STRING [9475,9511]
                                                String: "${{ secrets.CI_SLACK_CHANNEL_ID }}" [9475,9511]
                                        FIELD [9512,9582]
                                            String: "CI_SLACK_CHANNEL_ID_DAILY" [9512,9539]
                                            STRING [9540,9582]
                                                String: "${{ secrets.CI_SLACK_CHANNEL_ID_DAILY }}" [9540,9582]
                                        FIELD [9583,9659]
                                            String: "CI_SLACK_CHANNEL_DUMMY_TESTS" [9583,9613]
                                            STRING [9614,9659]
                                                String: "${{ secrets.CI_SLACK_CHANNEL_DUMMY_TESTS }}" [9614,9659]
                                        FIELD [9660,9725]
                                            String: "CI_SLACK_REPORT_CHANNEL_ID" [9660,9688]
                                            STRING [9689,9725]
                                                String: "${{ secrets.CI_SLACK_CHANNEL_ID }}" [9689,9725]
                                        FIELD [9726,9743]
                                            String: "CI_EVENT" [9726,9736]
                                            STRING [9737,9743]
                                                String: "push" [9737,9743]
                                        FIELD [9744,9796]
                                            String: "CI_TITLE" [9744,9754]
                                            STRING [9755,9796]
                                                String: "${{ github.event.head_commit.message }}" [9755,9796]
                                        FIELD [9797,9850]
                                            String: "CI_COMMIT_URL" [9797,9812]
                                            STRING [9813,9850]
                                                String: "${{ github.event.head_commit.url }}" [9813,9850]
                                FIELD [9852,9957]
                                    String: "run" [9852,9857]
                                    STRING [9858,9957]
                                        String: "pip install slack_sdk\npython utils/notification_service.py \"${{ needs.setup.outputs.matrix }}\"" [9858,9957]