OBJECT [0,5963]
    FIELD [1,21]
        String: "name" [1,7]
        STRING [8,21]
            String: "Build on M1" [8,21]
    FIELD [22,208]
        String: "on" [22,26]
        OBJECT [27,208]
            FIELD [28,96]
                String: "pull_request" [28,42]
                OBJECT [43,96]
                    FIELD [44,95]
                        String: "paths" [44,51]
                        ARRAY [52,95]
                            STRING [53,94]
                                String: ".github/workflows/build-m1-binaries.yml" [53,94]
            FIELD [97,182]
                String: "push" [97,103]
                OBJECT [104,182]
                    FIELD [105,139]
                        String: "branches" [105,115]
                        ARRAY [116,139]
                            STRING [117,126]
                                String: "nightly" [117,126]
                            STRING [127,138]
                                String: "release/*" [127,138]
                    FIELD [140,181]
                        String: "tags" [140,146]
                        ARRAY [147,181]
                            STRING [148,180]
                                String: "v[0-9]+.[0-9]+.[0-9]+-rc[0-9]+" [148,180]
            FIELD [183,207]
                String: "workflow_dispatch" [183,202]
                NULL [203,207]
    FIELD [209,236]
        String: "env" [209,214]
        OBJECT [215,236]
            FIELD [216,235]
                String: "CHANNEL" [216,225]
                STRING [226,235]
                    String: "nightly" [226,235]
    FIELD [237,5962]
        String: "jobs" [237,243]
        OBJECT [244,5962]
            FIELD [245,3599]
                String: "build_wheels" [245,259]
                OBJECT [260,3599]
                    FIELD [261,295]
                        String: "name" [261,267]
                        STRING [268,295]
                            String: "Build TorchText M1 wheels" [268,295]
                    FIELD [296,319]
                        String: "runs-on" [296,305]
                        STRING [306,319]
                            String: "macos-m1-11" [306,319]
                    FIELD [320,374]
                        String: "strategy" [320,330]
                        OBJECT [331,374]
                            FIELD [332,373]
                                String: "matrix" [332,340]
                                OBJECT [341,373]
                                    FIELD [342,372]
                                        String: "py_vers" [342,351]
                                        ARRAY [352,372]
                                            STRING [353,358]
                                                String: "3.8" [353,358]
                                            STRING [359,364]
                                                String: "3.9" [359,364]
                                            STRING [365,371]
                                                String: "3.10" [365,371]
                    FIELD [375,3598]
                        String: "steps" [375,382]
                        ARRAY [383,3598]
                            OBJECT [384,443]
                                FIELD [385,413]
                                    String: "name" [385,391]
                                    STRING [392,413]
                                        String: "Checkout repository" [392,413]
                                FIELD [414,442]
                                    String: "uses" [414,420]
                                    STRING [421,442]
                                        String: "actions/checkout@v2" [421,442]
                            OBJECT [444,720]
                                FIELD [445,490]
                                    String: "name" [445,451]
                                    STRING [452,490]
                                        String: "Set CHANNEL (only for tagged pushes)" [452,490]
                                FIELD [491,578]
                                    String: "if" [491,495]
                                    STRING [496,578]
                                        String: "${{ github.event_name == 'push' && startsWith(github.event.ref, 'refs/tags/') }}" [496,578]
                                FIELD [579,719]
                                    String: "run" [579,584]
                                    STRING [585,719]
                                        String: "# reference ends with an RC suffix\nif [[ ${GITHUB_REF_NAME} = *-rc[0-9]* ]]; then\n  echo \"CHANNEL=test\" >> \"$GITHUB_ENV\"\nfi\n" [585,719]
                            OBJECT [721,958]
                                FIELD [722,764]
                                    String: "name" [722,728]
                                    STRING [729,764]
                                        String: "Set Release CHANNEL (for release)" [729,764]
                                FIELD [765,906]
                                    String: "if" [765,769]
                                    STRING [770,906]
                                        String: "${{ (github.event_name == 'pull_request' && startsWith(github.base_ref, 'release')) || startsWith(github.ref, 'refs/heads/release') }}" [770,906]
                                FIELD [907,957]
                                    String: "run" [907,912]
                                    STRING [913,957]
                                        String: "echo \"CHANNEL=test\" >> \"$GITHUB_ENV\"\n" [913,957]
                            OBJECT [959,2170]
                                FIELD [960,993]
                                    String: "name" [960,966]
                                    STRING [967,993]
                                        String: "Build TorchText M1 wheel" [967,993]
                                FIELD [994,1029]
                                    String: "shell" [994,1001]
                                    STRING [1002,1029]
                                        String: "arch -arch arm64 bash {0}" [1002,1029]
                                FIELD [1030,1115]
                                    String: "env" [1030,1035]
                                    OBJECT [1036,1115]
                                        FIELD [1037,1080]
                                            String: "ENV_NAME" [1037,1047]
                                            STRING [1048,1080]
                                                String: "conda-env-${{ github.run_id }}" [1048,1080]
                                        FIELD [1081,1114]
                                            String: "PY_VERS" [1081,1090]
                                            STRING [1091,1114]
                                                String: "${{ matrix.py_vers }}" [1091,1114]
                                FIELD [1116,2169]
                                    String: "run" [1116,1121]
                                    STRING [1122,2169]
                                        String: "echo $PATH\n. ~/miniconda3/etc/profile.d/conda.sh\nset -ex\n. packaging/pkg_helpers.bash\n# if we are uploading to test channell, our version consist only of the base: 0.x.x - no date string or suffix added\nif [[ $CHANNEL == \"test\" ]]; then\n  setup_base_build_version\nelse\n  setup_build_version\nfi\ngit submodule update --init --recursive\nWHL_NAME=torchtext-${BUILD_VERSION}-cp${PY_VERS/.}-cp${PY_VERS/.}-macosx_11_0_arm64.whl\nconda create -yp ${ENV_NAME} python=${PY_VERS} numpy cmake ninja wheel pkg-config\nconda run -p ${ENV_NAME} python3 -mpip install torch --pre --extra-index-url=https://download.pytorch.org/whl/${CHANNEL}\nconda run -p ${ENV_NAME} python3 -mpip install delocate\nconda run -p ${ENV_NAME} python3 setup.py bdist_wheel\nexport PYTORCH_VERSION=\"$(conda run -p ${ENV_NAME} python3 -mpip show torch | grep ^Version: | sed 's/Version: *//')\"\nconda run -p ${ENV_NAME} DYLD_FALLBACK_LIBRARY_PATH=\"${ENV_NAME}/lib\" delocate-wheel -v --ignore-missing-dependencies dist/${WHL_NAME}\nconda env remove -p ${ENV_NAME}\n" [1122,2169]
                            OBJECT [2171,2840]
                                FIELD [2172,2191]
                                    String: "name" [2172,2178]
                                    STRING [2179,2191]
                                        String: "Test wheel" [2179,2191]
                                FIELD [2192,2227]
                                    String: "shell" [2192,2199]
                                    STRING [2200,2227]
                                        String: "arch -arch arm64 bash {0}" [2200,2227]
                                FIELD [2228,2318]
                                    String: "env" [2228,2233]
                                    OBJECT [2234,2318]
                                        FIELD [2235,2283]
                                            String: "ENV_NAME" [2235,2245]
                                            STRING [2246,2283]
                                                String: "conda-test-env-${{ github.run_id }}" [2246,2283]
                                        FIELD [2284,2317]
                                            String: "PY_VERS" [2284,2293]
                                            STRING [2294,2317]
                                                String: "${{ matrix.py_vers }}" [2294,2317]
                                FIELD [2319,2839]
                                    String: "run" [2319,2324]
                                    STRING [2325,2839]
                                        String: ". ~/miniconda3/etc/profile.d/conda.sh\nset -ex\nconda create -yp ${ENV_NAME} python=${PY_VERS} numpy\nconda run -p ${ENV_NAME} python3 -mpip install torch --pre --extra-index-url=https://download.pytorch.org/whl/${CHANNEL}\nconda run -p ${ENV_NAME} python3 -mpip install dist/*.whl\n# Test torch is importable, by changing cwd and running import commands\nconda run --cwd /tmp -p ${ENV_NAME} python3 -c \"import torchtext;print('torchtext version is ', torchtext.__version__)\"\nconda env remove -p ${ENV_NAME}\n" [2325,2839]
                            OBJECT [2841,3122]
                                FIELD [2842,2873]
                                    String: "name" [2842,2848]
                                    STRING [2849,2873]
                                        String: "Upload wheel to GitHub" [2849,2873]
                                FIELD [2874,3007]
                                    String: "if" [2874,2878]
                                    STRING [2879,3007]
                                        String: "${{ github.event_name == 'push' && (github.event.ref == 'refs/heads/nightly' || startsWith(github.event.ref, 'refs/tags/')) }}" [2879,3007]
                                FIELD [3008,3043]
                                    String: "uses" [3008,3014]
                                    STRING [3015,3043]
                                        String: "actions/upload-artifact@v3" [3015,3043]
                                FIELD [3044,3121]
                                    String: "with" [3044,3050]
                                    OBJECT [3051,3121]
                                        FIELD [3052,3105]
                                            String: "name" [3052,3058]
                                            STRING [3059,3105]
                                                String: "torchtext-py${{ matrix.py_vers }}-macos11-m1" [3059,3105]
                                        FIELD [3106,3120]
                                            String: "path" [3106,3112]
                                            STRING [3113,3120]
                                                String: "dist/" [3113,3120]
                            OBJECT [3123,3597]
                                FIELD [3124,3151]
                                    String: "name" [3124,3130]
                                    STRING [3131,3151]
                                        String: "Upload wheel to S3" [3131,3151]
                                FIELD [3152,3285]
                                    String: "if" [3152,3156]
                                    STRING [3157,3285]
                                        String: "${{ github.event_name == 'push' && (github.event.ref == 'refs/heads/nightly' || startsWith(github.event.ref, 'refs/tags/')) }}" [3157,3285]
                                FIELD [3286,3321]
                                    String: "shell" [3286,3293]
                                    STRING [3294,3321]
                                        String: "arch -arch arm64 bash {0}" [3294,3321]
                                FIELD [3322,3481]
                                    String: "env" [3322,3327]
                                    OBJECT [3328,3481]
                                        FIELD [3329,3400]
                                            String: "AWS_ACCESS_KEY_ID" [3329,3348]
                                            STRING [3349,3400]
                                                String: "${{ secrets.AWS_PYTORCH_UPLOADER_ACCESS_KEY_ID }}" [3349,3400]
                                        FIELD [3401,3480]
                                            String: "AWS_SECRET_ACCESS_KEY" [3401,3424]
                                            STRING [3425,3480]
                                                String: "${{ secrets.AWS_PYTORCH_UPLOADER_SECRET_ACCESS_KEY }}" [3425,3480]
                                FIELD [3482,3596]
                                    String: "run" [3482,3487]
                                    STRING [3488,3596]
                                        String: "for pkg in dist/*; do\n  aws s3 cp \"$pkg\" \"s3://pytorch/whl/${CHANNEL}/cpu/\" --acl public-read\ndone\n" [3488,3596]
            FIELD [3600,5961]
                String: "build_conda" [3600,3613]
                OBJECT [3614,5961]
                    FIELD [3615,3657]
                        String: "name" [3615,3621]
                        STRING [3622,3657]
                            String: "Build TorchText M1 conda packages" [3622,3657]
                    FIELD [3658,3678]
                        String: "runs-on" [3658,3667]
                        STRING [3668,3678]
                            String: "macos-m1" [3668,3678]
                    FIELD [3679,3733]
                        String: "strategy" [3679,3689]
                        OBJECT [3690,3733]
                            FIELD [3691,3732]
                                String: "matrix" [3691,3699]
                                OBJECT [3700,3732]
                                    FIELD [3701,3731]
                                        String: "py_vers" [3701,3710]
                                        ARRAY [3711,3731]
                                            STRING [3712,3717]
                                                String: "3.8" [3712,3717]
                                            STRING [3718,3723]
                                                String: "3.9" [3718,3723]
                                            STRING [3724,3730]
                                                String: "3.10" [3724,3730]
                    FIELD [3734,5960]
                        String: "steps" [3734,3741]
                        ARRAY [3742,5960]
                            OBJECT [3743,3802]
                                FIELD [3744,3772]
                                    String: "name" [3744,3750]
                                    STRING [3751,3772]
                                        String: "Checkout repository" [3751,3772]
                                FIELD [3773,3801]
                                    String: "uses" [3773,3779]
                                    STRING [3780,3801]
                                        String: "actions/checkout@v2" [3780,3801]
                            OBJECT [3803,4079]
                                FIELD [3804,3849]
                                    String: "name" [3804,3810]
                                    STRING [3811,3849]
                                        String: "Set CHANNEL (only for tagged pushes)" [3811,3849]
                                FIELD [3850,3937]
                                    String: "if" [3850,3854]
                                    STRING [3855,3937]
                                        String: "${{ github.event_name == 'push' && startsWith(github.event.ref, 'refs/tags/') }}" [3855,3937]
                                FIELD [3938,4078]
                                    String: "run" [3938,3943]
                                    STRING [3944,4078]
                                        String: "# reference ends with an RC suffix\nif [[ ${GITHUB_REF_NAME} = *-rc[0-9]* ]]; then\n  echo \"CHANNEL=test\" >> \"$GITHUB_ENV\"\nfi\n" [3944,4078]
                            OBJECT [4080,4317]
                                FIELD [4081,4123]
                                    String: "name" [4081,4087]
                                    STRING [4088,4123]
                                        String: "Set CHANNEL Release (for release)" [4088,4123]
                                FIELD [4124,4265]
                                    String: "if" [4124,4128]
                                    STRING [4129,4265]
                                        String: "${{ (github.event_name == 'pull_request' && startsWith(github.base_ref, 'release')) || startsWith(github.ref, 'refs/heads/release') }}" [4129,4265]
                                FIELD [4266,4316]
                                    String: "run" [4266,4271]
                                    STRING [4272,4316]
                                        String: "echo \"CHANNEL=test\" >> \"$GITHUB_ENV\"\n" [4272,4316]
                            OBJECT [4318,4515]
                                FIELD [4319,4376]
                                    String: "name" [4319,4325]
                                    STRING [4326,4376]
                                        String: "Install conda-build and purge previous artifacts" [4326,4376]
                                FIELD [4377,4412]
                                    String: "shell" [4377,4384]
                                    STRING [4385,4412]
                                        String: "arch -arch arm64 bash {0}" [4385,4412]
                                FIELD [4413,4514]
                                    String: "run" [4413,4418]
                                    STRING [4419,4514]
                                        String: ". ~/miniconda3/etc/profile.d/conda.sh\nconda install -yq conda-build\nconda build purge-all\n" [4419,4514]
                            OBJECT [4516,5281]
                                FIELD [4517,4558]
                                    String: "name" [4517,4523]
                                    STRING [4524,4558]
                                        String: "Build TorchText M1 conda package" [4524,4558]
                                FIELD [4559,4594]
                                    String: "shell" [4559,4566]
                                    STRING [4567,4594]
                                        String: "arch -arch arm64 bash {0}" [4567,4594]
                                FIELD [4595,4706]
                                    String: "env" [4595,4600]
                                    OBJECT [4601,4706]
                                        FIELD [4602,4645]
                                            String: "ENV_NAME" [4602,4612]
                                            STRING [4613,4645]
                                                String: "conda-env-${{ github.run_id }}" [4613,4645]
                                        FIELD [4646,4686]
                                            String: "PYTHON_VERSION" [4646,4662]
                                            STRING [4663,4686]
                                                String: "${{ matrix.py_vers }}" [4663,4686]
                                        FIELD [4687,4705]
                                            String: "CU_VERSION" [4687,4699]
                                            STRING [4700,4705]
                                                String: "cpu" [4700,4705]
                                FIELD [4707,5280]
                                    String: "run" [4707,4712]
                                    STRING [4713,5280]
                                        String: ". ~/miniconda3/etc/profile.d/conda.sh\nset -ex\n. packaging/pkg_helpers.bash\n\nif [[ $CHANNEL == \"test\" ]]; then\n  setup_base_build_version\n  export CONDA_CHANNEL_FLAGS=\"-c pytorch-test\"\nelse\n  setup_build_version\nfi\nexport BUILD_TYPE=\"conda\"\nexport NO_CUDA_PACKAGE=1\nexport SOURCE_ROOT_DIR=\"$PWD\"\n\nsetup_conda_pytorch_constraint\nexport SOURCE_ROOT_DIR=$(pwd)\nconda build -c defaults $CONDA_CHANNEL_FLAGS --no-anaconda-upload --python \"$PYTHON_VERSION\" packaging/torchtext\nmkdir -p dist\ncp ~/miniconda3/conda-bld/osx-arm64/*.tar.bz2 dist/\n" [4713,5280]
                            OBJECT [5282,5437]
                                FIELD [5283,5316]
                                    String: "name" [5283,5289]
                                    STRING [5290,5316]
                                        String: "Upload package to GitHub" [5290,5316]
                                FIELD [5317,5352]
                                    String: "uses" [5317,5323]
                                    STRING [5324,5352]
                                        String: "actions/upload-artifact@v3" [5324,5352]
                                FIELD [5353,5436]
                                    String: "with" [5353,5359]
                                    OBJECT [5360,5436]
                                        FIELD [5361,5420]
                                            String: "name" [5361,5367]
                                            STRING [5368,5420]
                                                String: "torchtext-py${{ matrix.py_vers }}-macos11-m1-conda" [5368,5420]
                                        FIELD [5421,5435]
                                            String: "path" [5421,5427]
                                            STRING [5428,5435]
                                                String: "dist/" [5428,5435]
                            OBJECT [5438,5959]
                                FIELD [5439,5471]
                                    String: "name" [5439,5445]
                                    STRING [5446,5471]
                                        String: "Upload package to conda" [5446,5471]
                                FIELD [5472,5605]
                                    String: "if" [5472,5476]
                                    STRING [5477,5605]
                                        String: "${{ github.event_name == 'push' && (github.event.ref == 'refs/heads/nightly' || startsWith(github.event.ref, 'refs/tags/')) }}" [5477,5605]
                                FIELD [5606,5641]
                                    String: "shell" [5606,5613]
                                    STRING [5614,5641]
                                        String: "arch -arch arm64 bash {0}" [5614,5641]
                                FIELD [5642,5714]
                                    String: "env" [5642,5647]
                                    OBJECT [5648,5714]
                                        FIELD [5649,5713]
                                            String: "CONDA_PYTORCHBOT_TOKEN" [5649,5673]
                                            STRING [5674,5713]
                                                String: "${{ secrets.CONDA_PYTORCHBOT_TOKEN }}" [5674,5713]
                                FIELD [5715,5958]
                                    String: "run" [5715,5720]
                                    STRING [5721,5958]
                                        String: ". ~/miniconda3/etc/profile.d/conda.sh\nconda install -yq anaconda-client\nset -x\nanaconda  -t \"${CONDA_PYTORCHBOT_TOKEN}\" upload ~/miniconda3/conda-bld/osx-arm64/*.tar.bz2 -u \"pytorch-${CHANNEL}\" --label main --no-progress --force" [5721,5958]