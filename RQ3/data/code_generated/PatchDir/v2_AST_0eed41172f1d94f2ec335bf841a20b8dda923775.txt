OBJECT [0,7028]
    FIELD [1,20]
        String: "name" [1,7]
        STRING [8,20]
            String: "Autoformat" [8,20]
    FIELD [21,74]
        String: "on" [21,25]
        OBJECT [26,74]
            FIELD [27,73]
                String: "issue_comment" [27,42]
                OBJECT [43,73]
                    FIELD [44,72]
                        String: "types" [44,51]
                        ARRAY [52,72]
                            STRING [53,62]
                                String: "created" [53,62]
                            STRING [63,71]
                                String: "edited" [63,71]
    FIELD [75,108]
        String: "permissions" [75,88]
        OBJECT [89,108]
            FIELD [90,107]
                String: "contents" [90,100]
                STRING [101,107]
                    String: "read" [101,107]
    FIELD [109,181]
        String: "defaults" [109,119]
        OBJECT [120,181]
            FIELD [121,180]
                String: "run" [121,126]
                OBJECT [127,180]
                    FIELD [128,179]
                        String: "shell" [128,135]
                        STRING [136,179]
                            String: "bash --noprofile --norc -exo pipefail {0}" [136,179]
    FIELD [182,7027]
        String: "jobs" [182,188]
        OBJECT [189,7027]
            FIELD [190,1862]
                String: "check-comment" [190,205]
                OBJECT [206,1862]
                    FIELD [207,232]
                        String: "runs-on" [207,216]
                        STRING [217,232]
                            String: "ubuntu-latest" [217,232]
                    FIELD [233,253]
                        String: "timeout-minutes" [233,250]
                        NUMBER [251,253]
                            Number: 10 [251,253]
                    FIELD [254,413]
                        String: "if" [254,258]
                        STRING [259,413]
                            String: "${{ github.event.issue.pull_request && contains(github.event.comment.body, '@mlflow-automation') && contains(github.event.comment.body, 'autoformat') }}" [259,413]
                    FIELD [414,472]
                        String: "permissions" [414,427]
                        OBJECT [428,472]
                            FIELD [429,447]
                                String: "statuses" [429,439]
                                STRING [440,447]
                                    String: "write" [440,447]
                            FIELD [448,471]
                                String: "pull-requests" [448,463]
                                STRING [464,471]
                                    String: "write" [464,471]
                    FIELD [473,1041]
                        String: "outputs" [473,482]
                        OBJECT [483,1041]
                            FIELD [484,566]
                                String: "should_autoformat" [484,503]
                                STRING [504,566]
                                    String: "${{ fromJSON(steps.judge.outputs.result).shouldAutoformat }}" [504,566]
                            FIELD [567,636]
                                String: "repository" [567,579]
                                STRING [580,636]
                                    String: "${{ fromJSON(steps.judge.outputs.result).repository }}" [580,636]
                            FIELD [637,702]
                                String: "head_ref" [637,647]
                                STRING [648,702]
                                    String: "${{ fromJSON(steps.judge.outputs.result).head_ref }}" [648,702]
                            FIELD [703,768]
                                String: "head_sha" [703,713]
                                STRING [714,768]
                                    String: "${{ fromJSON(steps.judge.outputs.result).head_sha }}" [714,768]
                            FIELD [769,834]
                                String: "base_ref" [769,779]
                                STRING [780,834]
                                    String: "${{ fromJSON(steps.judge.outputs.result).base_ref }}" [780,834]
                            FIELD [835,900]
                                String: "base_sha" [835,845]
                                STRING [846,900]
                                    String: "${{ fromJSON(steps.judge.outputs.result).base_sha }}" [846,900]
                            FIELD [901,968]
                                String: "base_repo" [901,912]
                                STRING [913,968]
                                    String: "${{ fromJSON(steps.judge.outputs.result).base_repo }}" [913,968]
                            FIELD [969,1040]
                                String: "pull_number" [969,982]
                                STRING [983,1040]
                                    String: "${{ fromJSON(steps.judge.outputs.result).pull_number }}" [983,1040]
                    FIELD [1042,1861]
                        String: "steps" [1042,1049]
                        ARRAY [1050,1861]
                            OBJECT [1051,1081]
                                FIELD [1052,1080]
                                    String: "uses" [1052,1058]
                                    STRING [1059,1080]
                                        String: "actions/checkout@v4" [1059,1080]
                            OBJECT [1082,1860]
                                FIELD [1083,1097]
                                    String: "name" [1083,1089]
                                    STRING [1090,1097]
                                        String: "judge" [1090,1097]
                                FIELD [1098,1110]
                                    String: "id" [1098,1102]
                                    STRING [1103,1110]
                                        String: "judge" [1103,1110]
                                FIELD [1111,1144]
                                    String: "uses" [1111,1117]
                                    STRING [1118,1144]
                                        String: "actions/github-script@v7" [1118,1144]
                                FIELD [1145,1859]
                                    String: "with" [1145,1151]
                                    OBJECT [1152,1859]
                                        FIELD [1153,1197]
                                            String: "github-token" [1153,1167]
                                            STRING [1168,1197]
                                                String: "${{ secrets.GITHUB_TOKEN }}" [1168,1197]
                                        FIELD [1198,1858]
                                            String: "script" [1198,1206]
                                            STRING [1207,1858]
                                                String: "core.debug(JSON.stringify(context, null, 2));\nconst autoformat = require('./.github/workflows/autoformat.js');\nconst { comment } = context.payload;\nconst isMaintainer = autoformat.isMlflowMaintainer(comment.author_association);\nif (!isMaintainer) {\n  core.setFailed(\"Only MLflow maintainers can trigger this workflow.\");\n}\nconst shouldAutoformat = autoformat.shouldAutoformat(comment);\nif (shouldAutoformat) {\n  await autoformat.createReaction(context, github);\n  await autoformat.createStatus(context, github, core);\n}\nconst pullInfo = await autoformat.getPullInformation(context, github);\nreturn { ...pullInfo, shouldAutoformat };\n" [1207,1858]
            FIELD [1863,5352]
                String: "format" [1863,1871]
                OBJECT [1872,5352]
                    FIELD [1873,1898]
                        String: "runs-on" [1873,1882]
                        STRING [1883,1898]
                            String: "ubuntu-latest" [1883,1898]
                    FIELD [1899,1919]
                        String: "timeout-minutes" [1899,1916]
                        NUMBER [1917,1919]
                            Number: 30 [1917,1919]
                    FIELD [1920,1943]
                        String: "needs" [1920,1927]
                        STRING [1928,1943]
                            String: "check-comment" [1928,1943]
                    FIELD [1944,2013]
                        String: "if" [1944,1948]
                        STRING [1949,2013]
                            String: "${{ needs.check-comment.outputs.should_autoformat == 'true' }}" [1949,2013]
                    FIELD [2014,2052]
                        String: "permissions" [2014,2027]
                        OBJECT [2028,2052]
                            FIELD [2029,2051]
                                String: "pull-requests" [2029,2044]
                                STRING [2045,2051]
                                    String: "read" [2045,2051]
                    FIELD [2053,2119]
                        String: "outputs" [2053,2062]
                        OBJECT [2063,2119]
                            FIELD [2064,2118]
                                String: "reformatted" [2064,2077]
                                STRING [2078,2118]
                                    String: "${{ steps.patch.outputs.reformatted }}" [2078,2118]
                    FIELD [2120,5351]
                        String: "steps" [2120,2127]
                        ARRAY [2128,5351]
                            OBJECT [2129,2299]
                                FIELD [2130,2158]
                                    String: "uses" [2130,2136]
                                    STRING [2137,2158]
                                        String: "actions/checkout@v4" [2137,2158]
                                FIELD [2159,2298]
                                    String: "with" [2159,2165]
                                    OBJECT [2166,2298]
                                        FIELD [2167,2227]
                                            String: "repository" [2167,2179]
                                            STRING [2180,2227]
                                                String: "${{ needs.check-comment.outputs.repository }}" [2180,2227]
                                        FIELD [2228,2279]
                                            String: "ref" [2228,2233]
                                            STRING [2234,2279]
                                                String: "${{ needs.check-comment.outputs.head_ref }}" [2234,2279]
                                        FIELD [2280,2297]
                                            String: "fetch-depth" [2280,2293]
                                            NUMBER [2294,2297]
                                                Number: 300 [2294,2297]
                            OBJECT [2300,3150]
                                FIELD [2301,2320]
                                    String: "name" [2301,2307]
                                    STRING [2308,2320]
                                        String: "Check diff" [2308,2320]
                                FIELD [2321,2332]
                                    String: "id" [2321,2325]
                                    STRING [2326,2332]
                                        String: "diff" [2326,2332]
                                FIELD [2333,2385]
                                    String: "env" [2333,2338]
                                    OBJECT [2339,2385]
                                        FIELD [2340,2384]
                                            String: "GITHUB_TOKEN" [2340,2354]
                                            STRING [2355,2384]
                                                String: "${{ secrets.GITHUB_TOKEN }}" [2355,2384]
                                FIELD [2386,3149]
                                    String: "run" [2386,2391]
                                    STRING [2392,3149]
                                        String: "changed_files=\"$(gh pr view --repo ${{ github.repository }} ${{ needs.check-comment.outputs.pull_number }} --json files --jq '.files.[].path')\"\nprotos=$([[ -z $(echo \"$changed_files\" | grep '^\\(mlflow/protos\\|tests/protos\\)') ]] && echo \"false\" || echo \"true\")\npython=$([[ -z $(echo \"$changed_files\" | grep '\\.py$\\|^pyproject\\.toml$') ]] && echo \"false\" || echo \"true\")\njs=$([[ -z $(echo \"$changed_files\" | grep '^mlflow/server/js') ]] && echo \"false\" || echo \"true\")\nr=$([[ -z $(echo \"$changed_files\" | grep '^mlflow/R/mlflow') ]] && echo \"false\" || echo \"true\")\necho \"protos=$protos\" >> $GITHUB_OUTPUT\necho \"python=$python\" >> $GITHUB_OUTPUT\necho \"js=$js\" >> $GITHUB_OUTPUT\necho \"r=$r\" >> $GITHUB_OUTPUT\n" [2392,3149]
                            OBJECT [3151,3507]
                                FIELD [3152,3178]
                                    String: "name" [3152,3158]
                                    STRING [3159,3178]
                                        String: "Merge base branch" [3159,3178]
                                FIELD [3179,3506]
                                    String: "run" [3179,3184]
                                    STRING [3185,3506]
                                        String: "git config user.name 'mlflow-automation'\ngit config user.email 'mlflow-automation@users.noreply.github.com'\ngit remote add base https://github.com/${{ needs.check-comment.outputs.base_repo }}.git\ngit fetch base ${{ needs.check-comment.outputs.base_ref }}\ngit merge base/${{ needs.check-comment.outputs.base_ref }}\n" [3185,3506]
                            OBJECT [3508,3549]
                                FIELD [3509,3548]
                                    String: "uses" [3509,3515]
                                    STRING [3516,3548]
                                        String: "./.github/actions/setup-python" [3516,3548]
                            OBJECT [3550,3770]
                                FIELD [3551,3769]
                                    String: "run" [3551,3556]
                                    STRING [3557,3769]
                                        String: "pip install -r requirements/lint-requirements.txt\n# TODO: Use a precompiled binary once it's available: https://github.com/tamasfe/taplo/issues/542\ncargo install taplo-cli@0.9.0 --locked\npre-commit install\n" [3557,3769]
                            OBJECT [3771,3841]
                                FIELD [3772,3840]
                                    String: "run" [3772,3777]
                                    STRING [3778,3840]
                                        String: "pre-commit run prettier --all-files --color=always || true\n" [3778,3840]
                            OBJECT [3842,4207]
                                FIELD [3843,3885]
                                    String: "if" [3843,3847]
                                    STRING [3848,3885]
                                        String: "steps.diff.outputs.protos == 'true'" [3848,3885]
                                FIELD [3886,3913]
                                    String: "env" [3886,3891]
                                    OBJECT [3892,3913]
                                        FIELD [3893,3912]
                                            String: "DOCKER_BUILDKIT" [3893,3910]
                                            NUMBER [3911,3912]
                                                Number: 1 [3911,3912]
                                FIELD [3914,4206]
                                    String: "run" [3914,3919]
                                    STRING [3920,4206]
                                        String: "wget https://github.com/protocolbuffers/protobuf/releases/download/v3.19.4/protoc-3.19.4-linux-x86_64.zip -O /tmp/protoc.zip\nsudo unzip /tmp/protoc.zip -d /tmp/protoc\nsudo chmod -R 777 /tmp/protoc\necho \"/tmp/protoc/bin\" >> $GITHUB_PATH\npip install --upgrade pip\npip install .\n" [3920,4206]
                            OBJECT [4208,4287]
                                FIELD [4209,4251]
                                    String: "if" [4209,4213]
                                    STRING [4214,4251]
                                        String: "steps.diff.outputs.protos == 'true'" [4214,4251]
                                FIELD [4252,4286]
                                    String: "run" [4252,4257]
                                    STRING [4258,4286]
                                        String: "./dev/generate-protos.sh\n" [4258,4286]
                            OBJECT [4288,4468]
                                FIELD [4289,4331]
                                    String: "if" [4289,4293]
                                    STRING [4294,4331]
                                        String: "steps.diff.outputs.python == 'true'" [4294,4331]
                                FIELD [4332,4467]
                                    String: "run" [4332,4337]
                                    STRING [4338,4467]
                                        String: "ruff check --fix .\nruff format .\ntaplo format $(git ls-files '*.toml')\nblacken-docs $(git ls-files '*.rst' '*.md') || true\n" [4338,4467]
                            OBJECT [4469,4569]
                                FIELD [4470,4508]
                                    String: "if" [4470,4474]
                                    STRING [4475,4508]
                                        String: "steps.diff.outputs.js == 'true'" [4475,4508]
                                FIELD [4509,4539]
                                    String: "uses" [4509,4515]
                                    STRING [4516,4539]
                                        String: "actions/setup-node@v3" [4516,4539]
                                FIELD [4540,4568]
                                    String: "with" [4540,4546]
                                    OBJECT [4547,4568]
                                        FIELD [4548,4567]
                                            String: "node-version" [4548,4562]
                                            STRING [4563,4567]
                                                String: "16" [4563,4567]
                            OBJECT [4570,4672]
                                FIELD [4571,4609]
                                    String: "if" [4571,4575]
                                    STRING [4576,4609]
                                        String: "steps.diff.outputs.js == 'true'" [4576,4609]
                                FIELD [4610,4648]
                                    String: "working-directory" [4610,4629]
                                    STRING [4630,4648]
                                        String: "mlflow/server/js" [4630,4648]
                                FIELD [4649,4671]
                                    String: "run" [4649,4654]
                                    STRING [4655,4671]
                                        String: "yarn install\n" [4655,4671]
                            OBJECT [4673,4795]
                                FIELD [4674,4712]
                                    String: "if" [4674,4678]
                                    STRING [4679,4712]
                                        String: "steps.diff.outputs.js == 'true'" [4679,4712]
                                FIELD [4713,4751]
                                    String: "working-directory" [4713,4732]
                                    STRING [4733,4751]
                                        String: "mlflow/server/js" [4733,4751]
                                FIELD [4752,4794]
                                    String: "run" [4752,4757]
                                    STRING [4758,4794]
                                        String: "yarn lint:fix\nyarn prettier:fix\n" [4758,4794]
                            OBJECT [4796,4895]
                                FIELD [4797,4835]
                                    String: "if" [4797,4801]
                                    STRING [4802,4835]
                                        String: "steps.diff.outputs.js == 'true'" [4802,4835]
                                FIELD [4836,4874]
                                    String: "working-directory" [4836,4855]
                                    STRING [4856,4874]
                                        String: "mlflow/server/js" [4856,4874]
                                FIELD [4875,4894]
                                    String: "run" [4875,4880]
                                    STRING [4881,4894]
                                        String: "yarn i18n\n" [4881,4894]
                            OBJECT [4896,4988]
                                FIELD [4897,4934]
                                    String: "if" [4897,4901]
                                    STRING [4902,4934]
                                        String: "steps.diff.outputs.r == 'true'" [4902,4934]
                                FIELD [4935,4961]
                                    String: "working-directory" [4935,4954]
                                    STRING [4955,4961]
                                        String: "docs" [4955,4961]
                                FIELD [4962,4987]
                                    String: "run" [4962,4967]
                                    STRING [4968,4987]
                                        String: "./build-rdoc.sh\n" [4968,4987]
                            OBJECT [4989,5211]
                                FIELD [4990,5011]
                                    String: "name" [4990,4996]
                                    STRING [4997,5011]
                                        String: "Create patch" [4997,5011]
                                FIELD [5012,5024]
                                    String: "id" [5012,5016]
                                    STRING [5017,5024]
                                        String: "patch" [5017,5024]
                                FIELD [5025,5210]
                                    String: "run" [5025,5030]
                                    STRING [5031,5210]
                                        String: "git diff > ${{ github.run_id }}.diff\nreformatted=$([[ -s ${{ github.run_id }}.diff ]] && echo \"true\" || echo \"false\")\necho \"reformatted=$reformatted\" >> $GITHUB_OUTPUT\n" [5031,5210]
                            OBJECT [5212,5350]
                                FIELD [5213,5234]
                                    String: "name" [5213,5219]
                                    STRING [5220,5234]
                                        String: "Upload patch" [5220,5234]
                                FIELD [5235,5270]
                                    String: "uses" [5235,5241]
                                    STRING [5242,5270]
                                        String: "actions/upload-artifact@v4" [5242,5270]
                                FIELD [5271,5349]
                                    String: "with" [5271,5277]
                                    OBJECT [5278,5349]
                                        FIELD [5279,5313]
                                            String: "name" [5279,5285]
                                            STRING [5286,5313]
                                                String: "${{ github.run_id }}.diff" [5286,5313]
                                        FIELD [5314,5348]
                                            String: "path" [5314,5320]
                                            STRING [5321,5348]
                                                String: "${{ github.run_id }}.diff" [5321,5348]
            FIELD [5353,6412]
                String: "push" [5353,5359]
                OBJECT [5360,6412]
                    FIELD [5361,5386]
                        String: "runs-on" [5361,5370]
                        STRING [5371,5386]
                            String: "ubuntu-latest" [5371,5386]
                    FIELD [5387,5406]
                        String: "timeout-minutes" [5387,5404]
                        NUMBER [5405,5406]
                            Number: 5 [5405,5406]
                    FIELD [5407,5441]
                        String: "needs" [5407,5414]
                        ARRAY [5415,5441]
                            STRING [5416,5431]
                                String: "check-comment" [5416,5431]
                            STRING [5432,5440]
                                String: "format" [5432,5440]
                    FIELD [5442,5498]
                        String: "if" [5442,5446]
                        STRING [5447,5498]
                            String: "${{ needs.format.outputs.reformatted == 'true' }}" [5447,5498]
                    FIELD [5499,6411]
                        String: "steps" [5499,5506]
                        ARRAY [5507,6411]
                            OBJECT [5508,5727]
                                FIELD [5509,5537]
                                    String: "uses" [5509,5515]
                                    STRING [5516,5537]
                                        String: "actions/checkout@v4" [5516,5537]
                                FIELD [5538,5726]
                                    String: "with" [5538,5544]
                                    OBJECT [5545,5726]
                                        FIELD [5546,5606]
                                            String: "repository" [5546,5558]
                                            STRING [5559,5606]
                                                String: "${{ needs.check-comment.outputs.repository }}" [5559,5606]
                                        FIELD [5607,5658]
                                            String: "ref" [5607,5612]
                                            STRING [5613,5658]
                                                String: "${{ needs.check-comment.outputs.head_ref }}" [5613,5658]
                                        FIELD [5659,5676]
                                            String: "fetch-depth" [5659,5672]
                                            NUMBER [5673,5676]
                                                Number: 300 [5673,5676]
                                        FIELD [5677,5725]
                                            String: "token" [5677,5684]
                                            STRING [5685,5725]
                                                String: "${{ secrets.MLFLOW_AUTOMATION_TOKEN }}" [5685,5725]
                            OBJECT [5728,6084]
                                FIELD [5729,5755]
                                    String: "name" [5729,5735]
                                    STRING [5736,5755]
                                        String: "Merge base branch" [5736,5755]
                                FIELD [5756,6083]
                                    String: "run" [5756,5761]
                                    STRING [5762,6083]
                                        String: "git config user.name 'mlflow-automation'\ngit config user.email 'mlflow-automation@users.noreply.github.com'\ngit remote add base https://github.com/${{ needs.check-comment.outputs.base_repo }}.git\ngit fetch base ${{ needs.check-comment.outputs.base_ref }}\ngit merge base/${{ needs.check-comment.outputs.base_ref }}\n" [5762,6083]
                            OBJECT [6085,6206]
                                FIELD [6086,6109]
                                    String: "name" [6086,6092]
                                    STRING [6093,6109]
                                        String: "Download patch" [6093,6109]
                                FIELD [6110,6147]
                                    String: "uses" [6110,6116]
                                    STRING [6117,6147]
                                        String: "actions/download-artifact@v4" [6117,6147]
                                FIELD [6148,6205]
                                    String: "with" [6148,6154]
                                    OBJECT [6155,6205]
                                        FIELD [6156,6190]
                                            String: "name" [6156,6162]
                                            STRING [6163,6190]
                                                String: "${{ github.run_id }}.diff" [6163,6190]
                                        FIELD [6191,6204]
                                            String: "path" [6191,6197]
                                            STRING [6198,6204]
                                                String: "/tmp" [6198,6204]
                            OBJECT [6207,6410]
                                FIELD [6208,6237]
                                    String: "name" [6208,6214]
                                    STRING [6215,6237]
                                        String: "Apply patch and push" [6215,6237]
                                FIELD [6238,6409]
                                    String: "run" [6238,6243]
                                    STRING [6244,6409]
                                        String: "git apply /tmp/${{ github.run_id }}.diff\ngit commit -sam \"Autoformat: https://github.com/${{ github.repository }}/actions/runs/${{ github.run_id }}\"\ngit push\n" [6244,6409]
            FIELD [6413,7026]
                String: "update-status" [6413,6428]
                OBJECT [6429,7026]
                    FIELD [6430,6455]
                        String: "runs-on" [6430,6439]
                        STRING [6440,6455]
                            String: "ubuntu-latest" [6440,6455]
                    FIELD [6456,6476]
                        String: "timeout-minutes" [6456,6473]
                        NUMBER [6474,6476]
                            Number: 10 [6474,6476]
                    FIELD [6477,6518]
                        String: "needs" [6477,6484]
                        ARRAY [6485,6518]
                            STRING [6486,6501]
                                String: "check-comment" [6486,6501]
                            STRING [6502,6510]
                                String: "format" [6502,6510]
                            STRING [6511,6517]
                                String: "push" [6511,6517]
                    FIELD [6519,6593]
                        String: "if" [6519,6523]
                        STRING [6524,6593]
                            String: "always() && needs.check-comment.outputs.should_autoformat == 'true'" [6524,6593]
                    FIELD [6594,6628]
                        String: "permissions" [6594,6607]
                        OBJECT [6608,6628]
                            FIELD [6609,6627]
                                String: "statuses" [6609,6619]
                                STRING [6620,6627]
                                    String: "write" [6620,6627]
                    FIELD [6629,7025]
                        String: "steps" [6629,6636]
                        ARRAY [6637,7025]
                            OBJECT [6638,6668]
                                FIELD [6639,6667]
                                    String: "uses" [6639,6645]
                                    STRING [6646,6667]
                                        String: "actions/checkout@v4" [6646,6667]
                            OBJECT [6669,7024]
                                FIELD [6670,6692]
                                    String: "name" [6670,6676]
                                    STRING [6677,6692]
                                        String: "Update status" [6677,6692]
                                FIELD [6693,6726]
                                    String: "uses" [6693,6699]
                                    STRING [6700,6726]
                                        String: "actions/github-script@v7" [6700,6726]
                                FIELD [6727,7023]
                                    String: "with" [6727,6733]
                                    OBJECT [6734,7023]
                                        FIELD [6735,6779]
                                            String: "github-token" [6735,6749]
                                            STRING [6750,6779]
                                                String: "${{ secrets.GITHUB_TOKEN }}" [6750,6779]
                                        FIELD [6780,7022]
                                            String: "script" [6780,6788]
                                            STRING [6789,7022]
                                                String: "const needs = ${{ toJson(needs) }};\nconst head_sha = '${{ needs.check-comment.outputs.head_sha }}'\nconst autoformat = require('./.github/workflows/autoformat.js');\nawait autoformat.updateStatus(context, github, head_sha, needs);" [6789,7022]