OBJECT [0,3723]
    FIELD [1,20]
        String: "name" [1,7]
        STRING [8,20]
            String: "model jobs" [8,20]
    FIELD [21,286]
        String: "on" [21,25]
        OBJECT [26,286]
            FIELD [27,285]
                String: "workflow_call" [27,42]
                OBJECT [43,285]
                    FIELD [44,284]
                        String: "inputs" [44,52]
                        OBJECT [53,284]
                            FIELD [54,103]
                                String: "folder_slices" [54,69]
                                OBJECT [70,103]
                                    FIELD [71,86]
                                        String: "required" [71,81]
                                        TRUE [82,86]
                                    FIELD [87,102]
                                        String: "type" [87,93]
                                        STRING [94,102]
                                            String: "string" [94,102]
                            FIELD [104,152]
                                String: "machine_type" [104,118]
                                OBJECT [119,152]
                                    FIELD [120,135]
                                        String: "required" [120,130]
                                        TRUE [131,135]
                                    FIELD [136,151]
                                        String: "type" [136,142]
                                        STRING [143,151]
                                            String: "string" [143,151]
                            FIELD [153,197]
                                String: "slice_id" [153,163]
                                OBJECT [164,197]
                                    FIELD [165,180]
                                        String: "required" [165,175]
                                        TRUE [176,180]
                                    FIELD [181,196]
                                        String: "type" [181,187]
                                        STRING [188,196]
                                            String: "number" [188,196]
                            FIELD [198,240]
                                String: "runner" [198,206]
                                OBJECT [207,240]
                                    FIELD [208,223]
                                        String: "required" [208,218]
                                        TRUE [219,223]
                                    FIELD [224,239]
                                        String: "type" [224,230]
                                        STRING [231,239]
                                            String: "string" [231,239]
                            FIELD [241,283]
                                String: "docker" [241,249]
                                OBJECT [250,283]
                                    FIELD [251,266]
                                        String: "required" [251,261]
                                        TRUE [262,266]
                                    FIELD [267,282]
                                        String: "type" [267,273]
                                        STRING [274,282]
                                            String: "string" [274,282]
    FIELD [287,595]
        String: "env" [287,292]
        OBJECT [293,595]
            FIELD [294,316]
                String: "HF_HOME" [294,303]
                STRING [304,316]
                    String: "/mnt/cache" [304,316]
            FIELD [317,342]
                String: "TRANSFORMERS_IS_CI" [317,337]
                TRUE [338,342]
            FIELD [343,362]
                String: "OMP_NUM_THREADS" [343,360]
                NUMBER [361,362]
                    Number: 8 [361,362]
            FIELD [363,382]
                String: "MKL_NUM_THREADS" [363,380]
                NUMBER [381,382]
                    Number: 8 [381,382]
            FIELD [383,398]
                String: "RUN_SLOW" [383,393]
                TRUE [394,398]
            FIELD [399,453]
                String: "HF_HUB_READ_TOKEN" [399,418]
                STRING [419,453]
                    String: "${{ secrets.HF_HUB_READ_TOKEN }}" [419,453]
            FIELD [454,506]
                String: "SIGOPT_API_TOKEN" [454,472]
                STRING [473,506]
                    String: "${{ secrets.SIGOPT_API_TOKEN }}" [473,506]
            FIELD [507,539]
                String: "TF_FORCE_GPU_ALLOW_GROWTH" [507,534]
                TRUE [535,539]
            FIELD [540,565]
                String: "RUN_PT_TF_CROSS_TESTS" [540,563]
                NUMBER [564,565]
                    Number: 1 [564,565]
            FIELD [566,594]
                String: "CUDA_VISIBLE_DEVICES" [566,588]
                STRING [589,594]
                    String: "0,1" [589,594]
    FIELD [596,3722]
        String: "jobs" [596,602]
        OBJECT [603,3722]
            FIELD [604,3721]
                String: "run_models_gpu" [604,620]
                OBJECT [621,3721]
                    FIELD [622,632]
                        String: "name" [622,628]
                        STRING [629,632]
                            String: " " [629,632]
                    FIELD [633,758]
                        String: "strategy" [633,643]
                        OBJECT [644,758]
                            FIELD [645,661]
                                String: "max-parallel" [645,659]
                                NUMBER [660,661]
                                    Number: 8 [660,661]
                            FIELD [662,679]
                                String: "fail-fast" [662,673]
                                FALSE [674,679]
                            FIELD [680,757]
                                String: "matrix" [680,688]
                                OBJECT [689,757]
                                    FIELD [690,756]
                                        String: "folders" [690,699]
                                        STRING [700,756]
                                            String: "${{ fromJson(inputs.folder_slices)[inputs.slice_id] }}" [700,756]
                    FIELD [759,840]
                        String: "runs-on" [759,768]
                        ARRAY [769,840]
                            STRING [770,798]
                                String: "${{ inputs.machine_type }}" [770,798]
                            STRING [799,811]
                                String: "nvidia-gpu" [799,811]
                            STRING [812,816]
                                String: "t4" [812,816]
                            STRING [817,839]
                                String: "${{ inputs.runner }}" [817,839]
                    FIELD [841,984]
                        String: "container" [841,852]
                        OBJECT [853,984]
                            FIELD [854,884]
                                String: "image" [854,861]
                                STRING [862,884]
                                    String: "${{ inputs.docker }}" [862,884]
                            FIELD [885,983]
                                String: "options" [885,894]
                                STRING [895,983]
                                    String: "--gpus all --shm-size \"16gb\" --ipc host -v /mnt/cache/.cache/huggingface:/mnt/cache/" [895,983]
                    FIELD [985,3720]
                        String: "steps" [985,992]
                        ARRAY [993,3720]
                            OBJECT [994,1198]
                                FIELD [995,1030]
                                    String: "name" [995,1001]
                                    STRING [1002,1030]
                                        String: "Echo input and matrix info" [1002,1030]
                                FIELD [1031,1045]
                                    String: "shell" [1031,1038]
                                    STRING [1039,1045]
                                        String: "bash" [1039,1045]
                                FIELD [1046,1197]
                                    String: "run" [1046,1051]
                                    STRING [1052,1197]
                                        String: "echo \"${{ inputs.folder_slices }}\"\necho \"${{ matrix.folders }}\"\necho \"${{ toJson(fromJson(inputs.folder_slices)[inputs.slice_id]) }}\"\n" [1052,1197]
                            OBJECT [1199,1473]
                                FIELD [1200,1242]
                                    String: "name" [1200,1206]
                                    STRING [1207,1242]
                                        String: "Echo folder ${{ matrix.folders }}" [1207,1242]
                                FIELD [1243,1257]
                                    String: "shell" [1243,1250]
                                    STRING [1251,1257]
                                        String: "bash" [1251,1257]
                                FIELD [1258,1472]
                                    String: "run" [1258,1263]
                                    STRING [1264,1472]
                                        String: "echo \"${{ matrix.folders }}\"\nmatrix_folders=${{ matrix.folders }}\nmatrix_folders=${matrix_folders/'models/'/'models_'}\necho \"$matrix_folders\"\necho \"matrix_folders=$matrix_folders\" >> $GITHUB_ENV\n" [1264,1472]
                            OBJECT [1474,1585]
                                FIELD [1475,1496]
                                    String: "name" [1475,1481]
                                    STRING [1482,1496]
                                        String: "Update clone" [1482,1496]
                                FIELD [1497,1532]
                                    String: "working-directory" [1497,1516]
                                    STRING [1517,1532]
                                        String: "/transformers" [1517,1532]
                                FIELD [1533,1584]
                                    String: "run" [1533,1538]
                                    STRING [1539,1584]
                                        String: "git fetch && git checkout ${{ github.sha }}" [1539,1584]
                            OBJECT [1586,1801]
                                FIELD [1587,1684]
                                    String: "name" [1587,1593]
                                    STRING [1594,1684]
                                        String: "Reinstall transformers in edit mode (remove the one installed during docker image build)" [1594,1684]
                                FIELD [1685,1720]
                                    String: "working-directory" [1685,1704]
                                    STRING [1705,1720]
                                        String: "/transformers" [1705,1720]
                                FIELD [1721,1800]
                                    String: "run" [1721,1726]
                                    STRING [1727,1800]
                                        String: "python3 -m pip uninstall -y transformers && python3 -m pip install -e ." [1727,1800]
                            OBJECT [1802,1986]
                                FIELD [1803,1856]
                                    String: "name" [1803,1809]
                                    STRING [1810,1856]
                                        String: "Update / Install some packages (for Past CI)" [1810,1856]
                                FIELD [1857,1904]
                                    String: "if" [1857,1861]
                                    STRING [1862,1904]
                                        String: "${{ contains(inputs.docker, '-past-') }}" [1862,1904]
                                FIELD [1905,1940]
                                    String: "working-directory" [1905,1924]
                                    STRING [1925,1940]
                                        String: "/transformers" [1925,1940]
                                FIELD [1941,1985]
                                    String: "run" [1941,1946]
                                    STRING [1947,1985]
                                        String: "python3 -m pip install -U datasets\n" [1947,1985]
                            OBJECT [1987,2280]
                                FIELD [1988,2041]
                                    String: "name" [1988,1994]
                                    STRING [1995,2041]
                                        String: "Update / Install some packages (for Past CI)" [1995,2041]
                                FIELD [2042,2129]
                                    String: "if" [2042,2046]
                                    STRING [2047,2129]
                                        String: "${{ contains(inputs.docker, '-past-') && contains(inputs.docker, '-pytorch-') }}" [2047,2129]
                                FIELD [2130,2165]
                                    String: "working-directory" [2130,2149]
                                    STRING [2150,2165]
                                        String: "/transformers" [2150,2165]
                                FIELD [2166,2279]
                                    String: "run" [2166,2171]
                                    STRING [2172,2279]
                                        String: "python3 -m pip install --no-cache-dir git+https://github.com/huggingface/accelerate@main#egg=accelerate\n" [2172,2279]
                            OBJECT [2281,2323]
                                FIELD [2282,2301]
                                    String: "name" [2282,2288]
                                    STRING [2289,2301]
                                        String: "NVIDIA-SMI" [2289,2301]
                                FIELD [2302,2322]
                                    String: "run" [2302,2307]
                                    STRING [2308,2322]
                                        String: "nvidia-smi\n" [2308,2322]
                            OBJECT [2324,2419]
                                FIELD [2325,2345]
                                    String: "name" [2325,2331]
                                    STRING [2332,2345]
                                        String: "Environment" [2332,2345]
                                FIELD [2346,2381]
                                    String: "working-directory" [2346,2365]
                                    STRING [2366,2381]
                                        String: "/transformers" [2366,2381]
                                FIELD [2382,2418]
                                    String: "run" [2382,2387]
                                    STRING [2388,2418]
                                        String: "python3 utils/print_env.py\n" [2388,2418]
                            OBJECT [2420,2529]
                                FIELD [2421,2473]
                                    String: "name" [2421,2427]
                                    STRING [2428,2473]
                                        String: "Show installed libraries and their versions" [2428,2473]
                                FIELD [2474,2509]
                                    String: "working-directory" [2474,2493]
                                    STRING [2494,2509]
                                        String: "/transformers" [2494,2509]
                                FIELD [2510,2528]
                                    String: "run" [2510,2515]
                                    STRING [2516,2528]
                                        String: "pip freeze" [2516,2528]
                            OBJECT [2530,2752]
                                FIELD [2531,2560]
                                    String: "name" [2531,2537]
                                    STRING [2538,2560]
                                        String: "Run all tests on GPU" [2538,2560]
                                FIELD [2561,2596]
                                    String: "working-directory" [2561,2580]
                                    STRING [2581,2596]
                                        String: "/transformers" [2581,2596]
                                FIELD [2597,2751]
                                    String: "run" [2597,2602]
                                    STRING [2603,2751]
                                        String: "python3 -m pytest -rsfE -v --make-reports=${{ inputs.machine_type }}_run_models_gpu_${{ matrix.folders }}_test_reports tests/${{ matrix.folders }}" [2603,2751]
                            OBJECT [2753,2964]
                                FIELD [2754,2784]
                                    String: "name" [2754,2760]
                                    STRING [2761,2784]
                                        String: "Failure short reports" [2761,2784]
                                FIELD [2785,2808]
                                    String: "if" [2785,2789]
                                    STRING [2790,2808]
                                        String: "${{ failure() }}" [2790,2808]
                                FIELD [2809,2833]
                                    String: "continue-on-error" [2809,2828]
                                    TRUE [2829,2833]
                                FIELD [2834,2963]
                                    String: "run" [2834,2839]
                                    STRING [2840,2963]
                                        String: "cat /transformers/reports/${{ inputs.machine_type }}_run_models_gpu_${{ matrix.folders }}_test_reports/failures_short.txt" [2840,2963]
                            OBJECT [2965,3331]
                                FIELD [2966,2983]
                                    String: "name" [2966,2972]
                                    STRING [2973,2983]
                                        String: "Run test" [2973,2983]
                                FIELD [2984,2998]
                                    String: "shell" [2984,2991]
                                    STRING [2992,2998]
                                        String: "bash" [2992,2998]
                                FIELD [2999,3330]
                                    String: "run" [2999,3004]
                                    STRING [3005,3330]
                                        String: "mkdir -p /transformers/reports/${{ inputs.machine_type }}_run_models_gpu_${{ matrix.folders }}_test_reports\necho \"hello\" > /transformers/reports/${{ inputs.machine_type }}_run_models_gpu_${{ matrix.folders }}_test_reports/hello.txt\necho \"${{ inputs.machine_type }}_run_models_gpu_${{ matrix.folders }}_test_reports\"\n" [3005,3330]
                            OBJECT [3332,3719]
                                FIELD [3333,3452]
                                    String: "name" [3333,3339]
                                    STRING [3340,3452]
                                        String: "Test suite reports artifacts: ${{ inputs.machine_type }}_run_models_gpu_${{ env.matrix_folders }}_test_reports" [3340,3452]
                                FIELD [3453,3475]
                                    String: "if" [3453,3457]
                                    STRING [3458,3475]
                                        String: "${{ always() }}" [3458,3475]
                                FIELD [3476,3511]
                                    String: "uses" [3476,3482]
                                    STRING [3483,3511]
                                        String: "actions/upload-artifact@v4" [3483,3511]
                                FIELD [3512,3718]
                                    String: "with" [3512,3518]
                                    OBJECT [3519,3718]
                                        FIELD [3520,3609]
                                            String: "name" [3520,3526]
                                            STRING [3527,3609]
                                                String: "${{ inputs.machine_type }}_run_models_gpu_${{ env.matrix_folders }}_test_reports" [3527,3609]
                                        FIELD [3610,3717]
                                            String: "path" [3610,3616]
                                            STRING [3617,3717]
                                                String: "/transformers/reports/${{ inputs.machine_type }}_run_models_gpu_${{ matrix.folders }}_test_reports" [3617,3717]