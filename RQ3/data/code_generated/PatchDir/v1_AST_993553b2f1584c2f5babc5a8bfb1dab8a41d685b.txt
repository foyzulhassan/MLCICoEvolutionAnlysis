OBJECT [0,11632]
    FIELD [1,40]
        String: "name" [1,7]
        STRING [8,40]
            String: "Self-hosted runner (scheduled)" [8,40]
    FIELD [41,108]
        String: "on" [41,45]
        OBJECT [46,108]
            FIELD [47,73]
                String: "repository_dispatch" [47,68]
                NULL [69,73]
            FIELD [74,107]
                String: "schedule" [74,84]
                ARRAY [85,107]
                    OBJECT [86,106]
                        FIELD [87,105]
                            String: "cron" [87,93]
                            STRING [94,105]
                                String: "0 2 * * *" [94,105]
    FIELD [109,333]
        String: "env" [109,114]
        OBJECT [115,333]
            FIELD [116,138]
                String: "HF_HOME" [116,125]
                STRING [126,138]
                    String: "/mnt/cache" [126,138]
            FIELD [139,164]
                String: "TRANSFORMERS_IS_CI" [139,159]
                TRUE [160,164]
            FIELD [165,184]
                String: "OMP_NUM_THREADS" [165,182]
                NUMBER [183,184]
                    Number: 8 [183,184]
            FIELD [185,204]
                String: "MKL_NUM_THREADS" [185,202]
                NUMBER [203,204]
                    Number: 8 [203,204]
            FIELD [205,220]
                String: "RUN_SLOW" [205,215]
                TRUE [216,220]
            FIELD [221,273]
                String: "SIGOPT_API_TOKEN" [221,239]
                STRING [240,273]
                    String: "${{ secrets.SIGOPT_API_TOKEN }}" [240,273]
            FIELD [274,306]
                String: "TF_FORCE_GPU_ALLOW_GROWTH" [274,301]
                TRUE [302,306]
            FIELD [307,332]
                String: "RUN_PT_TF_CROSS_TESTS" [307,330]
                NUMBER [331,332]
                    Number: 1 [331,332]
    FIELD [334,11631]
        String: "jobs" [334,340]
        OBJECT [341,11631]
            FIELD [342,1820]
                String: "setup" [342,349]
                OBJECT [350,1820]
                    FIELD [351,365]
                        String: "name" [351,357]
                        STRING [358,365]
                            String: "Setup" [358,365]
                    FIELD [366,441]
                        String: "strategy" [366,376]
                        OBJECT [377,441]
                            FIELD [378,440]
                                String: "matrix" [378,386]
                                OBJECT [387,440]
                                    FIELD [388,439]
                                        String: "machines" [388,398]
                                        ARRAY [399,439]
                                            STRING [400,418]
                                                String: "multi-gpu-docker" [400,418]
                                            STRING [419,438]
                                                String: "single-gpu-docker" [419,438]
                    FIELD [442,476]
                        String: "runs-on" [442,451]
                        STRING [452,476]
                            String: "${{ matrix.machines }}" [452,476]
                    FIELD [477,637]
                        String: "container" [477,488]
                        OBJECT [489,637]
                            FIELD [490,539]
                                String: "image" [490,497]
                                STRING [498,539]
                                    String: "huggingface/transformers-all-latest-gpu" [498,539]
                            FIELD [540,636]
                                String: "options" [540,549]
                                STRING [550,636]
                                    String: "--gpus 0 --shm-size \"16gb\" --ipc host -v /mnt/cache/.cache/huggingface:/mnt/cache/" [550,636]
                    FIELD [638,699]
                        String: "outputs" [638,647]
                        OBJECT [648,699]
                            FIELD [649,698]
                                String: "matrix" [649,657]
                                STRING [658,698]
                                    String: "${{ steps.set-matrix.outputs.matrix }}" [658,698]
                    FIELD [700,1819]
                        String: "steps" [700,707]
                        ARRAY [708,1819]
                            OBJECT [709,822]
                                FIELD [710,731]
                                    String: "name" [710,716]
                                    STRING [717,731]
                                        String: "Update clone" [717,731]
                                FIELD [732,767]
                                    String: "working-directory" [732,751]
                                    STRING [752,767]
                                        String: "/transformers" [752,767]
                                FIELD [768,821]
                                    String: "run" [768,773]
                                    STRING [774,821]
                                        String: "git fetch && git checkout ${{ github.sha }}\n" [774,821]
                            OBJECT [823,961]
                                FIELD [824,840]
                                    String: "name" [824,830]
                                    STRING [831,840]
                                        String: "Cleanup" [831,840]
                                FIELD [841,876]
                                    String: "working-directory" [841,860]
                                    STRING [861,876]
                                        String: "/transformers" [861,876]
                                FIELD [877,960]
                                    String: "run" [877,882]
                                    STRING [883,960]
                                        String: "rm -rf tests/__pycache__\nrm -rf tests/models/__pycache__\nrm -rf reports\n" [883,960]
                            OBJECT [962,1396]
                                FIELD [963,980]
                                    String: "id" [963,967]
                                    STRING [968,980]
                                        String: "set-matrix" [968,980]
                                FIELD [981,1013]
                                    String: "name" [981,987]
                                    STRING [988,1013]
                                        String: "Identify models to test" [988,1013]
                                FIELD [1014,1055]
                                    String: "working-directory" [1014,1033]
                                    STRING [1034,1055]
                                        String: "/transformers/tests" [1034,1055]
                                FIELD [1056,1395]
                                    String: "run" [1056,1061]
                                    STRING [1062,1395]
                                        String: "echo \"::set-output name=matrix::$(python3 -c 'import os; tests = os.getcwd(); model_tests = os.listdir(os.path.join(tests, \"models\")); d1 = sorted(list(filter(os.path.isdir, os.listdir(tests)))); d2 = sorted(list(filter(os.path.isdir, [f\"models/{x}\" for x in model_tests]))); d1.remove(\"models\"); d = d2 + d1; print(d)')\"\n" [1062,1395]
                            OBJECT [1397,1439]
                                FIELD [1398,1417]
                                    String: "name" [1398,1404]
                                    STRING [1405,1417]
                                        String: "NVIDIA-SMI" [1405,1417]
                                FIELD [1418,1438]
                                    String: "run" [1418,1423]
                                    STRING [1424,1438]
                                        String: "nvidia-smi\n" [1424,1438]
                            OBJECT [1440,1818]
                                FIELD [1441,1464]
                                    String: "name" [1441,1447]
                                    STRING [1448,1464]
                                        String: "GPU visibility" [1448,1464]
                                FIELD [1465,1500]
                                    String: "working-directory" [1465,1484]
                                    STRING [1485,1500]
                                        String: "/transformers" [1485,1500]
                                FIELD [1501,1817]
                                    String: "run" [1501,1506]
                                    STRING [1507,1817]
                                        String: "utils/print_env_pt.py\nTF_CPP_MIN_LOG_LEVEL=3 python3 -c \"import tensorflow as tf; print('TF GPUs available:', bool(tf.config.list_physical_devices('GPU')))\"\nTF_CPP_MIN_LOG_LEVEL=3 python3 -c \"import tensorflow as tf; print('Number of TF GPUs available:', len(tf.config.list_physical_devices('GPU')))\"\n" [1507,1817]
            FIELD [1821,3527]
                String: "run_tests_single_gpu" [1821,1843]
                OBJECT [1844,3527]
                    FIELD [1845,1865]
                        String: "name" [1845,1851]
                        STRING [1852,1865]
                            String: "Model tests" [1852,1865]
                    FIELD [1866,1996]
                        String: "strategy" [1866,1876]
                        OBJECT [1877,1996]
                            FIELD [1878,1895]
                                String: "fail-fast" [1878,1889]
                                FALSE [1890,1895]
                            FIELD [1896,1995]
                                String: "matrix" [1896,1904]
                                OBJECT [1905,1995]
                                    FIELD [1906,1961]
                                        String: "folders" [1906,1915]
                                        STRING [1916,1961]
                                            String: "${{ fromJson(needs.setup.outputs.matrix) }}" [1916,1961]
                                    FIELD [1962,1994]
                                        String: "machines" [1962,1972]
                                        ARRAY [1973,1994]
                                            STRING [1974,1993]
                                                String: "single-gpu-docker" [1974,1993]
                    FIELD [1997,2031]
                        String: "runs-on" [1997,2006]
                        STRING [2007,2031]
                            String: "${{ matrix.machines }}" [2007,2031]
                    FIELD [2032,2192]
                        String: "container" [2032,2043]
                        OBJECT [2044,2192]
                            FIELD [2045,2094]
                                String: "image" [2045,2052]
                                STRING [2053,2094]
                                    String: "huggingface/transformers-all-latest-gpu" [2053,2094]
                            FIELD [2095,2191]
                                String: "options" [2095,2104]
                                STRING [2105,2191]
                                    String: "--gpus 0 --shm-size \"16gb\" --ipc host -v /mnt/cache/.cache/huggingface:/mnt/cache/" [2105,2191]
                    FIELD [2193,2208]
                        String: "needs" [2193,2200]
                        STRING [2201,2208]
                            String: "setup" [2201,2208]
                    FIELD [2209,3526]
                        String: "steps" [2209,2216]
                        ARRAY [2217,3526]
                            OBJECT [2218,2492]
                                FIELD [2219,2261]
                                    String: "name" [2219,2225]
                                    STRING [2226,2261]
                                        String: "Echo folder ${{ matrix.folders }}" [2226,2261]
                                FIELD [2262,2276]
                                    String: "shell" [2262,2269]
                                    STRING [2270,2276]
                                        String: "bash" [2270,2276]
                                FIELD [2277,2491]
                                    String: "run" [2277,2282]
                                    STRING [2283,2491]
                                        String: "echo \"${{ matrix.folders }}\"\nmatrix_folders=${{ matrix.folders }}\nmatrix_folders=${matrix_folders/'models/'/'models_'}\necho \"$matrix_folders\"\necho \"matrix_folders=$matrix_folders\" >> $GITHUB_ENV\n" [2283,2491]
                            OBJECT [2493,2741]
                                FIELD [2494,2547]
                                    String: "name" [2494,2500]
                                    STRING [2501,2547]
                                        String: "Set machine type from ${{ matrix.machines }}" [2501,2547]
                                FIELD [2548,2562]
                                    String: "shell" [2548,2555]
                                    STRING [2556,2562]
                                        String: "bash" [2556,2562]
                                FIELD [2563,2740]
                                    String: "run" [2563,2568]
                                    STRING [2569,2740]
                                        String: "machine_type=${{ matrix.machines }}\nmachine_type=${machine_type/'-docker'/''}\necho \"machine_type=$machine_type\"\necho \"machine_type=$machine_type\" >> $GITHUB_ENV\n" [2569,2740]
                            OBJECT [2742,2853]
                                FIELD [2743,2764]
                                    String: "name" [2743,2749]
                                    STRING [2750,2764]
                                        String: "Update clone" [2750,2764]
                                FIELD [2765,2800]
                                    String: "working-directory" [2765,2784]
                                    STRING [2785,2800]
                                        String: "/transformers" [2785,2800]
                                FIELD [2801,2852]
                                    String: "run" [2801,2806]
                                    STRING [2807,2852]
                                        String: "git fetch && git checkout ${{ github.sha }}" [2807,2852]
                            OBJECT [2854,3049]
                                FIELD [2855,2884]
                                    String: "name" [2855,2861]
                                    STRING [2862,2884]
                                        String: "Run all tests on GPU" [2862,2884]
                                FIELD [2885,2920]
                                    String: "working-directory" [2885,2904]
                                    STRING [2905,2920]
                                        String: "/transformers" [2905,2920]
                                FIELD [2921,3048]
                                    String: "run" [2921,2926]
                                    STRING [2927,3048]
                                        String: "python3 -m pytest -v --make-reports=${{ env.machine_type }}_tests_gpu_${{ matrix.folders }} tests/${{ matrix.folders }}" [2927,3048]
                            OBJECT [3050,3240]
                                FIELD [3051,3081]
                                    String: "name" [3051,3057]
                                    STRING [3058,3081]
                                        String: "Failure short reports" [3058,3081]
                                FIELD [3082,3105]
                                    String: "if" [3082,3086]
                                    STRING [3087,3105]
                                        String: "${{ failure() }}" [3087,3105]
                                FIELD [3106,3130]
                                    String: "continue-on-error" [3106,3125]
                                    TRUE [3126,3130]
                                FIELD [3131,3239]
                                    String: "run" [3131,3136]
                                    STRING [3137,3239]
                                        String: "cat /transformers/reports/${{ env.machine_type }}_tests_gpu_${{ matrix.folders }}/failures_short.txt" [3137,3239]
                            OBJECT [3241,3525]
                                FIELD [3242,3279]
                                    String: "name" [3242,3248]
                                    STRING [3249,3279]
                                        String: "Test suite reports artifacts" [3249,3279]
                                FIELD [3280,3302]
                                    String: "if" [3280,3284]
                                    STRING [3285,3302]
                                        String: "${{ always() }}" [3285,3302]
                                FIELD [3303,3338]
                                    String: "uses" [3303,3309]
                                    STRING [3310,3338]
                                        String: "actions/upload-artifact@v2" [3310,3338]
                                FIELD [3339,3524]
                                    String: "with" [3339,3345]
                                    OBJECT [3346,3524]
                                        FIELD [3347,3436]
                                            String: "name" [3347,3353]
                                            STRING [3354,3436]
                                                String: "${{ env.machine_type }}_run_all_tests_gpu_${{ env.matrix_folders }}_test_reports" [3354,3436]
                                        FIELD [3437,3523]
                                            String: "path" [3437,3443]
                                            STRING [3444,3523]
                                                String: "/transformers/reports/${{ env.machine_type }}_tests_gpu_${{ matrix.folders }}" [3444,3523]
            FIELD [3528,5234]
                String: "run_tests_multi_gpu" [3528,3549]
                OBJECT [3550,5234]
                    FIELD [3551,3571]
                        String: "name" [3551,3557]
                        STRING [3558,3571]
                            String: "Model tests" [3558,3571]
                    FIELD [3572,3701]
                        String: "strategy" [3572,3582]
                        OBJECT [3583,3701]
                            FIELD [3584,3601]
                                String: "fail-fast" [3584,3595]
                                FALSE [3596,3601]
                            FIELD [3602,3700]
                                String: "matrix" [3602,3610]
                                OBJECT [3611,3700]
                                    FIELD [3612,3667]
                                        String: "folders" [3612,3621]
                                        STRING [3622,3667]
                                            String: "${{ fromJson(needs.setup.outputs.matrix) }}" [3622,3667]
                                    FIELD [3668,3699]
                                        String: "machines" [3668,3678]
                                        ARRAY [3679,3699]
                                            STRING [3680,3698]
                                                String: "multi-gpu-docker" [3680,3698]
                    FIELD [3702,3736]
                        String: "runs-on" [3702,3711]
                        STRING [3712,3736]
                            String: "${{ matrix.machines }}" [3712,3736]
                    FIELD [3737,3899]
                        String: "container" [3737,3748]
                        OBJECT [3749,3899]
                            FIELD [3750,3799]
                                String: "image" [3750,3757]
                                STRING [3758,3799]
                                    String: "huggingface/transformers-all-latest-gpu" [3758,3799]
                            FIELD [3800,3898]
                                String: "options" [3800,3809]
                                STRING [3810,3898]
                                    String: "--gpus all --shm-size \"16gb\" --ipc host -v /mnt/cache/.cache/huggingface:/mnt/cache/" [3810,3898]
                    FIELD [3900,3915]
                        String: "needs" [3900,3907]
                        STRING [3908,3915]
                            String: "setup" [3908,3915]
                    FIELD [3916,5233]
                        String: "steps" [3916,3923]
                        ARRAY [3924,5233]
                            OBJECT [3925,4199]
                                FIELD [3926,3968]
                                    String: "name" [3926,3932]
                                    STRING [3933,3968]
                                        String: "Echo folder ${{ matrix.folders }}" [3933,3968]
                                FIELD [3969,3983]
                                    String: "shell" [3969,3976]
                                    STRING [3977,3983]
                                        String: "bash" [3977,3983]
                                FIELD [3984,4198]
                                    String: "run" [3984,3989]
                                    STRING [3990,4198]
                                        String: "echo \"${{ matrix.folders }}\"\nmatrix_folders=${{ matrix.folders }}\nmatrix_folders=${matrix_folders/'models/'/'models_'}\necho \"$matrix_folders\"\necho \"matrix_folders=$matrix_folders\" >> $GITHUB_ENV\n" [3990,4198]
                            OBJECT [4200,4448]
                                FIELD [4201,4254]
                                    String: "name" [4201,4207]
                                    STRING [4208,4254]
                                        String: "Set machine type from ${{ matrix.machines }}" [4208,4254]
                                FIELD [4255,4269]
                                    String: "shell" [4255,4262]
                                    STRING [4263,4269]
                                        String: "bash" [4263,4269]
                                FIELD [4270,4447]
                                    String: "run" [4270,4275]
                                    STRING [4276,4447]
                                        String: "machine_type=${{ matrix.machines }}\nmachine_type=${machine_type/'-docker'/''}\necho \"machine_type=$machine_type\"\necho \"machine_type=$machine_type\" >> $GITHUB_ENV\n" [4276,4447]
                            OBJECT [4449,4560]
                                FIELD [4450,4471]
                                    String: "name" [4450,4456]
                                    STRING [4457,4471]
                                        String: "Update clone" [4457,4471]
                                FIELD [4472,4507]
                                    String: "working-directory" [4472,4491]
                                    STRING [4492,4507]
                                        String: "/transformers" [4492,4507]
                                FIELD [4508,4559]
                                    String: "run" [4508,4513]
                                    STRING [4514,4559]
                                        String: "git fetch && git checkout ${{ github.sha }}" [4514,4559]
                            OBJECT [4561,4756]
                                FIELD [4562,4591]
                                    String: "name" [4562,4568]
                                    STRING [4569,4591]
                                        String: "Run all tests on GPU" [4569,4591]
                                FIELD [4592,4627]
                                    String: "working-directory" [4592,4611]
                                    STRING [4612,4627]
                                        String: "/transformers" [4612,4627]
                                FIELD [4628,4755]
                                    String: "run" [4628,4633]
                                    STRING [4634,4755]
                                        String: "python3 -m pytest -v --make-reports=${{ env.machine_type }}_tests_gpu_${{ matrix.folders }} tests/${{ matrix.folders }}" [4634,4755]
                            OBJECT [4757,4947]
                                FIELD [4758,4788]
                                    String: "name" [4758,4764]
                                    STRING [4765,4788]
                                        String: "Failure short reports" [4765,4788]
                                FIELD [4789,4812]
                                    String: "if" [4789,4793]
                                    STRING [4794,4812]
                                        String: "${{ failure() }}" [4794,4812]
                                FIELD [4813,4837]
                                    String: "continue-on-error" [4813,4832]
                                    TRUE [4833,4837]
                                FIELD [4838,4946]
                                    String: "run" [4838,4843]
                                    STRING [4844,4946]
                                        String: "cat /transformers/reports/${{ env.machine_type }}_tests_gpu_${{ matrix.folders }}/failures_short.txt" [4844,4946]
                            OBJECT [4948,5232]
                                FIELD [4949,4986]
                                    String: "name" [4949,4955]
                                    STRING [4956,4986]
                                        String: "Test suite reports artifacts" [4956,4986]
                                FIELD [4987,5009]
                                    String: "if" [4987,4991]
                                    STRING [4992,5009]
                                        String: "${{ always() }}" [4992,5009]
                                FIELD [5010,5045]
                                    String: "uses" [5010,5016]
                                    STRING [5017,5045]
                                        String: "actions/upload-artifact@v2" [5017,5045]
                                FIELD [5046,5231]
                                    String: "with" [5046,5052]
                                    OBJECT [5053,5231]
                                        FIELD [5054,5143]
                                            String: "name" [5054,5060]
                                            STRING [5061,5143]
                                                String: "${{ env.machine_type }}_run_all_tests_gpu_${{ env.matrix_folders }}_test_reports" [5061,5143]
                                        FIELD [5144,5230]
                                            String: "path" [5144,5150]
                                            STRING [5151,5230]
                                                String: "/transformers/reports/${{ env.machine_type }}_tests_gpu_${{ matrix.folders }}" [5151,5230]
            FIELD [5235,6160]
                String: "run_examples_gpu" [5235,5253]
                OBJECT [5254,6160]
                    FIELD [5255,5282]
                        String: "name" [5255,5261]
                        STRING [5262,5282]
                            String: "Examples directory" [5262,5282]
                    FIELD [5283,5328]
                        String: "runs-on" [5283,5292]
                        ARRAY [5293,5328]
                            STRING [5294,5307]
                                String: "self-hosted" [5294,5307]
                            STRING [5308,5327]
                                String: "single-gpu-docker" [5308,5327]
                    FIELD [5329,5489]
                        String: "container" [5329,5340]
                        OBJECT [5341,5489]
                            FIELD [5342,5391]
                                String: "image" [5342,5349]
                                STRING [5350,5391]
                                    String: "huggingface/transformers-all-latest-gpu" [5350,5391]
                            FIELD [5392,5488]
                                String: "options" [5392,5401]
                                STRING [5402,5488]
                                    String: "--gpus 0 --shm-size \"16gb\" --ipc host -v /mnt/cache/.cache/huggingface:/mnt/cache/" [5402,5488]
                    FIELD [5490,5505]
                        String: "needs" [5490,5497]
                        STRING [5498,5505]
                            String: "setup" [5498,5505]
                    FIELD [5506,6159]
                        String: "steps" [5506,5513]
                        ARRAY [5514,6159]
                            OBJECT [5515,5626]
                                FIELD [5516,5537]
                                    String: "name" [5516,5522]
                                    STRING [5523,5537]
                                        String: "Update clone" [5523,5537]
                                FIELD [5538,5573]
                                    String: "working-directory" [5538,5557]
                                    STRING [5558,5573]
                                        String: "/transformers" [5558,5573]
                                FIELD [5574,5625]
                                    String: "run" [5574,5579]
                                    STRING [5580,5625]
                                        String: "git fetch && git checkout ${{ github.sha }}" [5580,5625]
                            OBJECT [5627,5832]
                                FIELD [5628,5662]
                                    String: "name" [5628,5634]
                                    STRING [5635,5662]
                                        String: "Run examples tests on GPU" [5635,5662]
                                FIELD [5663,5698]
                                    String: "working-directory" [5663,5682]
                                    STRING [5683,5698]
                                        String: "/transformers" [5683,5698]
                                FIELD [5699,5831]
                                    String: "run" [5699,5704]
                                    STRING [5705,5831]
                                        String: "pip install -r examples/pytorch/_tests_requirements.txt\npython3 -m pytest -v --make-reports=examples_gpu examples/pytorch\n" [5705,5831]
                            OBJECT [5833,5980]
                                FIELD [5834,5864]
                                    String: "name" [5834,5840]
                                    STRING [5841,5864]
                                        String: "Failure short reports" [5841,5864]
                                FIELD [5865,5888]
                                    String: "if" [5865,5869]
                                    STRING [5870,5888]
                                        String: "${{ failure() }}" [5870,5888]
                                FIELD [5889,5913]
                                    String: "continue-on-error" [5889,5908]
                                    TRUE [5909,5913]
                                FIELD [5914,5979]
                                    String: "run" [5914,5919]
                                    STRING [5920,5979]
                                        String: "cat /transformers/reports/examples_gpu/failures_short.txt" [5920,5979]
                            OBJECT [5981,6158]
                                FIELD [5982,6019]
                                    String: "name" [5982,5988]
                                    STRING [5989,6019]
                                        String: "Test suite reports artifacts" [5989,6019]
                                FIELD [6020,6042]
                                    String: "if" [6020,6024]
                                    STRING [6025,6042]
                                        String: "${{ always() }}" [6025,6042]
                                FIELD [6043,6078]
                                    String: "uses" [6043,6049]
                                    STRING [6050,6078]
                                        String: "actions/upload-artifact@v2" [6050,6078]
                                FIELD [6079,6157]
                                    String: "with" [6079,6085]
                                    OBJECT [6086,6157]
                                        FIELD [6087,6112]
                                            String: "name" [6087,6093]
                                            STRING [6094,6112]
                                                String: "run_examples_gpu" [6094,6112]
                                        FIELD [6113,6156]
                                            String: "path" [6113,6119]
                                            STRING [6120,6156]
                                                String: "/transformers/reports/examples_gpu" [6120,6156]
            FIELD [6161,7578]
                String: "run_pipelines_torch_gpu" [6161,6186]
                OBJECT [6187,7578]
                    FIELD [6188,6214]
                        String: "name" [6188,6194]
                        STRING [6195,6214]
                            String: "PyTorch pipelines" [6195,6214]
                    FIELD [6215,6308]
                        String: "strategy" [6215,6225]
                        OBJECT [6226,6308]
                            FIELD [6227,6244]
                                String: "fail-fast" [6227,6238]
                                FALSE [6239,6244]
                            FIELD [6245,6307]
                                String: "matrix" [6245,6253]
                                OBJECT [6254,6307]
                                    FIELD [6255,6306]
                                        String: "machines" [6255,6265]
                                        ARRAY [6266,6306]
                                            STRING [6267,6285]
                                                String: "multi-gpu-docker" [6267,6285]
                                            STRING [6286,6305]
                                                String: "single-gpu-docker" [6286,6305]
                    FIELD [6309,6343]
                        String: "runs-on" [6309,6318]
                        STRING [6319,6343]
                            String: "${{ matrix.machines }}" [6319,6343]
                    FIELD [6344,6503]
                        String: "container" [6344,6355]
                        OBJECT [6356,6503]
                            FIELD [6357,6403]
                                String: "image" [6357,6364]
                                STRING [6365,6403]
                                    String: "huggingface/transformers-pytorch-gpu" [6365,6403]
                            FIELD [6404,6502]
                                String: "options" [6404,6413]
                                STRING [6414,6502]
                                    String: "--gpus all --shm-size \"16gb\" --ipc host -v /mnt/cache/.cache/huggingface:/mnt/cache/" [6414,6502]
                    FIELD [6504,6519]
                        String: "needs" [6504,6511]
                        STRING [6512,6519]
                            String: "setup" [6512,6519]
                    FIELD [6520,7577]
                        String: "steps" [6520,6527]
                        ARRAY [6528,7577]
                            OBJECT [6529,6777]
                                FIELD [6530,6583]
                                    String: "name" [6530,6536]
                                    STRING [6537,6583]
                                        String: "Set machine type from ${{ matrix.machines }}" [6537,6583]
                                FIELD [6584,6598]
                                    String: "shell" [6584,6591]
                                    STRING [6592,6598]
                                        String: "bash" [6592,6598]
                                FIELD [6599,6776]
                                    String: "run" [6599,6604]
                                    STRING [6605,6776]
                                        String: "machine_type=${{ matrix.machines }}\nmachine_type=${machine_type/'-docker'/''}\necho \"machine_type=$machine_type\"\necho \"machine_type=$machine_type\" >> $GITHUB_ENV\n" [6605,6776]
                            OBJECT [6778,6889]
                                FIELD [6779,6800]
                                    String: "name" [6779,6785]
                                    STRING [6786,6800]
                                        String: "Update clone" [6786,6800]
                                FIELD [6801,6836]
                                    String: "working-directory" [6801,6820]
                                    STRING [6821,6836]
                                        String: "/transformers" [6821,6836]
                                FIELD [6837,6888]
                                    String: "run" [6837,6842]
                                    STRING [6843,6888]
                                        String: "git fetch && git checkout ${{ github.sha }}" [6843,6888]
                            OBJECT [6890,7142]
                                FIELD [6891,6929]
                                    String: "name" [6891,6897]
                                    STRING [6898,6929]
                                        String: "Run all pipeline tests on GPU" [6898,6929]
                                FIELD [6930,6965]
                                    String: "working-directory" [6930,6949]
                                    STRING [6950,6965]
                                        String: "/transformers" [6950,6965]
                                FIELD [6966,6999]
                                    String: "env" [6966,6971]
                                    OBJECT [6972,6999]
                                        FIELD [6973,6998]
                                            String: "RUN_PIPELINE_TESTS" [6973,6993]
                                            TRUE [6994,6998]
                                FIELD [7000,7141]
                                    String: "run" [7000,7005]
                                    STRING [7006,7141]
                                        String: "python3 -m pytest -n 1 -v --dist=loadfile -m is_pipeline_test --make-reports=${{ env.machine_type }}_tests_torch_pipeline_gpu tests\n" [7006,7141]
                            OBJECT [7143,7326]
                                FIELD [7144,7174]
                                    String: "name" [7144,7150]
                                    STRING [7151,7174]
                                        String: "Failure short reports" [7151,7174]
                                FIELD [7175,7198]
                                    String: "if" [7175,7179]
                                    STRING [7180,7198]
                                        String: "${{ failure() }}" [7180,7198]
                                FIELD [7199,7223]
                                    String: "continue-on-error" [7199,7218]
                                    TRUE [7219,7223]
                                FIELD [7224,7325]
                                    String: "run" [7224,7229]
                                    STRING [7230,7325]
                                        String: "cat /transformers/reports/${{ env.machine_type }}_tests_torch_pipeline_gpu/failures_short.txt" [7230,7325]
                            OBJECT [7327,7576]
                                FIELD [7328,7365]
                                    String: "name" [7328,7334]
                                    STRING [7335,7365]
                                        String: "Test suite reports artifacts" [7335,7365]
                                FIELD [7366,7388]
                                    String: "if" [7366,7370]
                                    STRING [7371,7388]
                                        String: "${{ always() }}" [7371,7388]
                                FIELD [7389,7424]
                                    String: "uses" [7389,7395]
                                    STRING [7396,7424]
                                        String: "actions/upload-artifact@v2" [7396,7424]
                                FIELD [7425,7575]
                                    String: "with" [7425,7431]
                                    OBJECT [7432,7575]
                                        FIELD [7433,7494]
                                            String: "name" [7433,7439]
                                            STRING [7440,7494]
                                                String: "${{ env.machine_type }}_run_tests_torch_pipeline_gpu" [7440,7494]
                                        FIELD [7495,7574]
                                            String: "path" [7495,7501]
                                            STRING [7502,7574]
                                                String: "/transformers/reports/${{ env.machine_type }}_tests_torch_pipeline_gpu" [7502,7574]
            FIELD [7579,8965]
                String: "run_pipelines_tf_gpu" [7579,7601]
                OBJECT [7602,8965]
                    FIELD [7603,7632]
                        String: "name" [7603,7609]
                        STRING [7610,7632]
                            String: "TensorFlow pipelines" [7610,7632]
                    FIELD [7633,7726]
                        String: "strategy" [7633,7643]
                        OBJECT [7644,7726]
                            FIELD [7645,7662]
                                String: "fail-fast" [7645,7656]
                                FALSE [7657,7662]
                            FIELD [7663,7725]
                                String: "matrix" [7663,7671]
                                OBJECT [7672,7725]
                                    FIELD [7673,7724]
                                        String: "machines" [7673,7683]
                                        ARRAY [7684,7724]
                                            STRING [7685,7703]
                                                String: "multi-gpu-docker" [7685,7703]
                                            STRING [7704,7723]
                                                String: "single-gpu-docker" [7704,7723]
                    FIELD [7727,7761]
                        String: "runs-on" [7727,7736]
                        STRING [7737,7761]
                            String: "${{ matrix.machines }}" [7737,7761]
                    FIELD [7762,7924]
                        String: "container" [7762,7773]
                        OBJECT [7774,7924]
                            FIELD [7775,7824]
                                String: "image" [7775,7782]
                                STRING [7783,7824]
                                    String: "huggingface/transformers-tensorflow-gpu" [7783,7824]
                            FIELD [7825,7923]
                                String: "options" [7825,7834]
                                STRING [7835,7923]
                                    String: "--gpus all --shm-size \"16gb\" --ipc host -v /mnt/cache/.cache/huggingface:/mnt/cache/" [7835,7923]
                    FIELD [7925,7940]
                        String: "needs" [7925,7932]
                        STRING [7933,7940]
                            String: "setup" [7933,7940]
                    FIELD [7941,8964]
                        String: "steps" [7941,7948]
                        ARRAY [7949,8964]
                            OBJECT [7950,8198]
                                FIELD [7951,8004]
                                    String: "name" [7951,7957]
                                    STRING [7958,8004]
                                        String: "Set machine type from ${{ matrix.machines }}" [7958,8004]
                                FIELD [8005,8019]
                                    String: "shell" [8005,8012]
                                    STRING [8013,8019]
                                        String: "bash" [8013,8019]
                                FIELD [8020,8197]
                                    String: "run" [8020,8025]
                                    STRING [8026,8197]
                                        String: "machine_type=${{ matrix.machines }}\nmachine_type=${machine_type/'-docker'/''}\necho \"machine_type=$machine_type\"\necho \"machine_type=$machine_type\" >> $GITHUB_ENV\n" [8026,8197]
                            OBJECT [8199,8312]
                                FIELD [8200,8221]
                                    String: "name" [8200,8206]
                                    STRING [8207,8221]
                                        String: "Update clone" [8207,8221]
                                FIELD [8222,8257]
                                    String: "working-directory" [8222,8241]
                                    STRING [8242,8257]
                                        String: "/transformers" [8242,8257]
                                FIELD [8258,8311]
                                    String: "run" [8258,8263]
                                    STRING [8264,8311]
                                        String: "git fetch && git checkout ${{ github.sha }}\n" [8264,8311]
                            OBJECT [8313,8562]
                                FIELD [8314,8352]
                                    String: "name" [8314,8320]
                                    STRING [8321,8352]
                                        String: "Run all pipeline tests on GPU" [8321,8352]
                                FIELD [8353,8388]
                                    String: "working-directory" [8353,8372]
                                    STRING [8373,8388]
                                        String: "/transformers" [8373,8388]
                                FIELD [8389,8422]
                                    String: "env" [8389,8394]
                                    OBJECT [8395,8422]
                                        FIELD [8396,8421]
                                            String: "RUN_PIPELINE_TESTS" [8396,8416]
                                            TRUE [8417,8421]
                                FIELD [8423,8561]
                                    String: "run" [8423,8428]
                                    STRING [8429,8561]
                                        String: "python3 -m pytest -n 1 -v --dist=loadfile -m is_pipeline_test --make-reports=${{ env.machine_type }}_tests_tf_pipeline_gpu tests\n" [8429,8561]
                            OBJECT [8563,8719]
                                FIELD [8564,8594]
                                    String: "name" [8564,8570]
                                    STRING [8571,8594]
                                        String: "Failure short reports" [8571,8594]
                                FIELD [8595,8617]
                                    String: "if" [8595,8599]
                                    STRING [8600,8617]
                                        String: "${{ always() }}" [8600,8617]
                                FIELD [8618,8718]
                                    String: "run" [8618,8623]
                                    STRING [8624,8718]
                                        String: "cat /transformers/reports/${{ env.machine_type }}_tests_tf_pipeline_gpu/failures_short.txt\n" [8624,8718]
                            OBJECT [8720,8963]
                                FIELD [8721,8758]
                                    String: "name" [8721,8727]
                                    STRING [8728,8758]
                                        String: "Test suite reports artifacts" [8728,8758]
                                FIELD [8759,8781]
                                    String: "if" [8759,8763]
                                    STRING [8764,8781]
                                        String: "${{ always() }}" [8764,8781]
                                FIELD [8782,8817]
                                    String: "uses" [8782,8788]
                                    STRING [8789,8817]
                                        String: "actions/upload-artifact@v2" [8789,8817]
                                FIELD [8818,8962]
                                    String: "with" [8818,8824]
                                    OBJECT [8825,8962]
                                        FIELD [8826,8884]
                                            String: "name" [8826,8832]
                                            STRING [8833,8884]
                                                String: "${{ env.machine_type }}_run_tests_tf_pipeline_gpu" [8833,8884]
                                        FIELD [8885,8961]
                                            String: "path" [8885,8891]
                                            STRING [8892,8961]
                                                String: "/transformers/reports/${{ env.machine_type }}_tests_tf_pipeline_gpu" [8892,8961]
            FIELD [8966,10850]
                String: "run_all_tests_torch_cuda_extensions_gpu" [8966,9007]
                OBJECT [9008,10850]
                    FIELD [9009,9044]
                        String: "name" [9009,9015]
                        STRING [9016,9044]
                            String: "Torch CUDA extension tests" [9016,9044]
                    FIELD [9045,9138]
                        String: "strategy" [9045,9055]
                        OBJECT [9056,9138]
                            FIELD [9057,9074]
                                String: "fail-fast" [9057,9068]
                                FALSE [9069,9074]
                            FIELD [9075,9137]
                                String: "matrix" [9075,9083]
                                OBJECT [9084,9137]
                                    FIELD [9085,9136]
                                        String: "machines" [9085,9095]
                                        ARRAY [9096,9136]
                                            STRING [9097,9115]
                                                String: "multi-gpu-docker" [9097,9115]
                                            STRING [9116,9135]
                                                String: "single-gpu-docker" [9116,9135]
                    FIELD [9139,9173]
                        String: "runs-on" [9139,9148]
                        STRING [9149,9173]
                            String: "${{ matrix.machines }}" [9149,9173]
                    FIELD [9174,9189]
                        String: "needs" [9174,9181]
                        STRING [9182,9189]
                            String: "setup" [9182,9189]
                    FIELD [9190,9366]
                        String: "container" [9190,9201]
                        OBJECT [9202,9366]
                            FIELD [9203,9266]
                                String: "image" [9203,9210]
                                STRING [9211,9266]
                                    String: "huggingface/transformers-pytorch-deepspeed-latest-gpu" [9211,9266]
                            FIELD [9267,9365]
                                String: "options" [9267,9276]
                                STRING [9277,9365]
                                    String: "--gpus all --shm-size \"16gb\" --ipc host -v /mnt/cache/.cache/huggingface:/mnt/cache/" [9277,9365]
                    FIELD [9367,10849]
                        String: "steps" [9367,9374]
                        ARRAY [9375,10849]
                            OBJECT [9376,9624]
                                FIELD [9377,9430]
                                    String: "name" [9377,9383]
                                    STRING [9384,9430]
                                        String: "Set machine type from ${{ matrix.machines }}" [9384,9430]
                                FIELD [9431,9445]
                                    String: "shell" [9431,9438]
                                    STRING [9439,9445]
                                        String: "bash" [9439,9445]
                                FIELD [9446,9623]
                                    String: "run" [9446,9451]
                                    STRING [9452,9623]
                                        String: "machine_type=${{ matrix.machines }}\nmachine_type=${machine_type/'-docker'/''}\necho \"machine_type=$machine_type\"\necho \"machine_type=$machine_type\" >> $GITHUB_ENV\n" [9452,9623]
                            OBJECT [9625,9746]
                                FIELD [9626,9647]
                                    String: "name" [9626,9632]
                                    STRING [9633,9647]
                                        String: "Update clone" [9633,9647]
                                FIELD [9648,9693]
                                    String: "working-directory" [9648,9667]
                                    STRING [9668,9693]
                                        String: "/workspace/transformers" [9668,9693]
                                FIELD [9694,9745]
                                    String: "run" [9694,9699]
                                    STRING [9700,9745]
                                        String: "git fetch && git checkout ${{ github.sha }}" [9700,9745]
                            OBJECT [9747,10150]
                                FIELD [9748,9777]
                                    String: "name" [9748,9754]
                                    STRING [9755,9777]
                                        String: "Re-compile DeepSpeed" [9755,9777]
                                FIELD [9778,9810]
                                    String: "working-directory" [9778,9797]
                                    STRING [9798,9810]
                                        String: "/workspace" [9798,9810]
                                FIELD [9811,10149]
                                    String: "run" [9811,9816]
                                    STRING [9817,10149]
                                        String: "pip install deepspeed # installs the deps correctly\nrm -rf DeepSpeed\ngit clone https://github.com/microsoft/DeepSpeed && cd DeepSpeed && rm -rf build\nDS_BUILD_CPU_ADAM=1 DS_BUILD_AIO=1 DS_BUILD_UTILS=1 python3 -m pip install -e . --global-option=\"build_ext\" --global-option=\"-j8\" --no-cache -v --disable-pip-version-check\n" [9817,10149]
                            OBJECT [10151,10360]
                                FIELD [10152,10181]
                                    String: "name" [10152,10158]
                                    STRING [10159,10181]
                                        String: "Run all tests on GPU" [10159,10181]
                                FIELD [10182,10227]
                                    String: "working-directory" [10182,10201]
                                    STRING [10202,10227]
                                        String: "/workspace/transformers" [10202,10227]
                                FIELD [10228,10359]
                                    String: "run" [10228,10233]
                                    STRING [10234,10359]
                                        String: "python -m pytest -v --make-reports=${{ env.machine_type }}_tests_torch_cuda_extensions_gpu tests/deepspeed tests/extended\n" [10234,10359]
                            OBJECT [10361,10561]
                                FIELD [10362,10392]
                                    String: "name" [10362,10368]
                                    STRING [10369,10392]
                                        String: "Failure short reports" [10369,10392]
                                FIELD [10393,10416]
                                    String: "if" [10393,10397]
                                    STRING [10398,10416]
                                        String: "${{ failure() }}" [10398,10416]
                                FIELD [10417,10441]
                                    String: "continue-on-error" [10417,10436]
                                    TRUE [10437,10441]
                                FIELD [10442,10560]
                                    String: "run" [10442,10447]
                                    STRING [10448,10560]
                                        String: "cat /workspace/transformers/reports/${{ env.machine_type }}_tests_torch_cuda_extensions_gpu/failures_short.txt" [10448,10560]
                            OBJECT [10562,10848]
                                FIELD [10563,10600]
                                    String: "name" [10563,10569]
                                    STRING [10570,10600]
                                        String: "Test suite reports artifacts" [10570,10600]
                                FIELD [10601,10623]
                                    String: "if" [10601,10605]
                                    STRING [10606,10623]
                                        String: "${{ always() }}" [10606,10623]
                                FIELD [10624,10659]
                                    String: "uses" [10624,10630]
                                    STRING [10631,10659]
                                        String: "actions/upload-artifact@v2" [10631,10659]
                                FIELD [10660,10847]
                                    String: "with" [10660,10666]
                                    OBJECT [10667,10847]
                                        FIELD [10668,10749]
                                            String: "name" [10668,10674]
                                            STRING [10675,10749]
                                                String: "${{ env.machine_type }}_run_tests_torch_cuda_extensions_gpu_test_reports" [10675,10749]
                                        FIELD [10750,10846]
                                            String: "path" [10750,10756]
                                            STRING [10757,10846]
                                                String: "/workspace/transformers/reports/${{ env.machine_type }}_tests_torch_cuda_extensions_gpu" [10757,10846]
            FIELD [10851,11630]
                String: "send_results" [10851,10865]
                OBJECT [10866,11630]
                    FIELD [10867,10899]
                        String: "name" [10867,10873]
                        STRING [10874,10899]
                            String: "Send results to webhook" [10874,10899]
                    FIELD [10900,10925]
                        String: "runs-on" [10900,10909]
                        STRING [10910,10925]
                            String: "ubuntu-latest" [10910,10925]
                    FIELD [10926,10941]
                        String: "if" [10926,10930]
                        STRING [10931,10941]
                            String: "always()" [10931,10941]
                    FIELD [10942,11114]
                        String: "needs" [10942,10949]
                        ARRAY [10950,11114]
                            STRING [10951,10958]
                                String: "setup" [10951,10958]
                            STRING [10959,10981]
                                String: "run_tests_single_gpu" [10959,10981]
                            STRING [10982,11003]
                                String: "run_tests_multi_gpu" [10982,11003]
                            STRING [11004,11022]
                                String: "run_examples_gpu" [11004,11022]
                            STRING [11023,11045]
                                String: "run_pipelines_tf_gpu" [11023,11045]
                            STRING [11046,11071]
                                String: "run_pipelines_torch_gpu" [11046,11071]
                            STRING [11072,11113]
                                String: "run_all_tests_torch_cuda_extensions_gpu" [11072,11113]
                    FIELD [11115,11629]
                        String: "steps" [11115,11122]
                        ARRAY [11123,11629]
                            OBJECT [11124,11154]
                                FIELD [11125,11153]
                                    String: "uses" [11125,11131]
                                    STRING [11132,11153]
                                        String: "actions/checkout@v2" [11132,11153]
                            OBJECT [11155,11194]
                                FIELD [11156,11193]
                                    String: "uses" [11156,11162]
                                    STRING [11163,11193]
                                        String: "actions/download-artifact@v2" [11163,11193]
                            OBJECT [11195,11628]
                                FIELD [11196,11226]
                                    String: "name" [11196,11202]
                                    STRING [11203,11226]
                                        String: "Send message to Slack" [11203,11226]
                                FIELD [11227,11521]
                                    String: "env" [11227,11232]
                                    OBJECT [11233,11521]
                                        FIELD [11234,11290]
                                            String: "CI_SLACK_BOT_TOKEN" [11234,11254]
                                            STRING [11255,11290]
                                                String: "${{ secrets.CI_SLACK_BOT_TOKEN }}" [11255,11290]
                                        FIELD [11291,11349]
                                            String: "CI_SLACK_CHANNEL_ID" [11291,11312]
                                            STRING [11313,11349]
                                                String: "${{ secrets.CI_SLACK_CHANNEL_ID }}" [11313,11349]
                                        FIELD [11350,11420]
                                            String: "CI_SLACK_CHANNEL_ID_DAILY" [11350,11377]
                                            STRING [11378,11420]
                                                String: "${{ secrets.CI_SLACK_CHANNEL_ID_DAILY }}" [11378,11420]
                                        FIELD [11421,11497]
                                            String: "CI_SLACK_CHANNEL_DUMMY_TESTS" [11421,11451]
                                            STRING [11452,11497]
                                                String: "${{ secrets.CI_SLACK_CHANNEL_DUMMY_TESTS }}" [11452,11497]
                                        FIELD [11498,11520]
                                            String: "CI_EVENT" [11498,11508]
                                            STRING [11509,11520]
                                                String: "scheduled" [11509,11520]
                                FIELD [11522,11627]
                                    String: "run" [11522,11527]
                                    STRING [11528,11627]
                                        String: "pip install slack_sdk\npython utils/notification_service.py \"${{ needs.setup.outputs.matrix }}\"" [11528,11627]