OBJECT [0,5671]
    FIELD [1,21]
        String: "name" [1,7]
        STRING [8,21]
            String: "Build on M1" [8,21]
    FIELD [22,203]
        String: "on" [22,26]
        OBJECT [27,203]
            FIELD [28,96]
                String: "pull_request" [28,42]
                OBJECT [43,96]
                    FIELD [44,95]
                        String: "paths" [44,51]
                        ARRAY [52,95]
                            STRING [53,94]
                                String: ".github/workflows/build-m1-binaries.yml" [53,94]
            FIELD [97,177]
                String: "push" [97,103]
                OBJECT [104,177]
                    FIELD [105,134]
                        String: "branches" [105,115]
                        ARRAY [116,134]
                            STRING [117,126]
                                String: "nightly" [117,126]
                            STRING [127,133]
                                String: "main" [127,133]
                    FIELD [135,176]
                        String: "tags" [135,141]
                        ARRAY [142,176]
                            STRING [143,175]
                                String: "v[0-9]+.[0-9]+.[0-9]+-rc[0-9]+" [143,175]
            FIELD [178,202]
                String: "workflow_dispatch" [178,197]
                NULL [198,202]
    FIELD [204,231]
        String: "env" [204,209]
        OBJECT [210,231]
            FIELD [211,230]
                String: "CHANNEL" [211,220]
                STRING [221,230]
                    String: "nightly" [221,230]
    FIELD [232,5670]
        String: "jobs" [232,238]
        OBJECT [239,5670]
            FIELD [240,3676]
                String: "build_wheels" [240,254]
                OBJECT [255,3676]
                    FIELD [256,292]
                        String: "name" [256,262]
                        STRING [263,292]
                            String: "Build TorchVision M1 wheels" [263,292]
                    FIELD [293,313]
                        String: "runs-on" [293,302]
                        STRING [303,313]
                            String: "macos-m1" [303,313]
                    FIELD [314,368]
                        String: "strategy" [314,324]
                        OBJECT [325,368]
                            FIELD [326,367]
                                String: "matrix" [326,334]
                                OBJECT [335,367]
                                    FIELD [336,366]
                                        String: "py_vers" [336,345]
                                        ARRAY [346,366]
                                            STRING [347,352]
                                                String: "3.8" [347,352]
                                            STRING [353,358]
                                                String: "3.9" [353,358]
                                            STRING [359,365]
                                                String: "3.10" [359,365]
                    FIELD [369,3675]
                        String: "steps" [369,376]
                        ARRAY [377,3675]
                            OBJECT [378,437]
                                FIELD [379,407]
                                    String: "name" [379,385]
                                    STRING [386,407]
                                        String: "Checkout repository" [386,407]
                                FIELD [408,436]
                                    String: "uses" [408,414]
                                    STRING [415,436]
                                        String: "actions/checkout@v2" [415,436]
                            OBJECT [438,714]
                                FIELD [439,484]
                                    String: "name" [439,445]
                                    STRING [446,484]
                                        String: "Set CHANNEL (only for tagged pushes)" [446,484]
                                FIELD [485,572]
                                    String: "if" [485,489]
                                    STRING [490,572]
                                        String: "${{ github.event_name == 'push' && startsWith(github.event.ref, 'refs/tags/') }}" [490,572]
                                FIELD [573,713]
                                    String: "run" [573,578]
                                    STRING [579,713]
                                        String: "# reference ends with an RC suffix\nif [[ ${GITHUB_REF_NAME} = *-rc[0-9]* ]]; then\n  echo \"CHANNEL=test\" >> \"$GITHUB_ENV\"\nfi\n" [579,713]
                            OBJECT [715,2022]
                                FIELD [716,751]
                                    String: "name" [716,722]
                                    STRING [723,751]
                                        String: "Build TorchVision M1 wheel" [723,751]
                                FIELD [752,787]
                                    String: "shell" [752,759]
                                    STRING [760,787]
                                        String: "arch -arch arm64 bash {0}" [760,787]
                                FIELD [788,873]
                                    String: "env" [788,793]
                                    OBJECT [794,873]
                                        FIELD [795,838]
                                            String: "ENV_NAME" [795,805]
                                            STRING [806,838]
                                                String: "conda-env-${{ github.run_id }}" [806,838]
                                        FIELD [839,872]
                                            String: "PY_VERS" [839,848]
                                            STRING [849,872]
                                                String: "${{ matrix.py_vers }}" [849,872]
                                FIELD [874,2021]
                                    String: "run" [874,879]
                                    STRING [880,2021]
                                        String: ". ~/miniconda3/etc/profile.d/conda.sh\n# Needed for JPEG library detection as setup.py detects conda presence by running `shlex.which('conda')`\nexport PATH=~/miniconda3/bin:$PATH\nset -ex\n. packaging/pkg_helpers.bash\n# if we are uploading to test channell, our version consist only of the base: 0.x.x - no date string or suffix added\nif [[ $CHANNEL == \"test\" ]]; then\n  setup_base_build_version\nelse\n  setup_build_version\nfi\n\nWHL_NAME=torchvision-${BUILD_VERSION}-cp${PY_VERS/.}-cp${PY_VERS/.}-macosx_11_0_arm64.whl\nconda create -yp ${ENV_NAME} python=${PY_VERS} numpy libpng jpeg wheel pkg-config\nconda run -p ${ENV_NAME} python3 -mpip install torch --pre --extra-index-url=https://download.pytorch.org/whl/${CHANNEL}\nconda run -p ${ENV_NAME} python3 -mpip install delocate\nconda run -p ${ENV_NAME} python3 setup.py bdist_wheel\nexport PYTORCH_VERSION=\"$(conda run -p ${ENV_NAME} python3 -mpip show torch | grep ^Version: | sed 's/Version:  *//')\"\nconda run -p ${ENV_NAME} DYLD_FALLBACK_LIBRARY_PATH=\"${ENV_NAME}/lib\" delocate-wheel -v --ignore-missing-dependencies dist/${WHL_NAME}\nconda env remove -p ${ENV_NAME}\n" [880,2021]
                            OBJECT [2023,3050]
                                FIELD [2024,2043]
                                    String: "name" [2024,2030]
                                    STRING [2031,2043]
                                        String: "Test wheel" [2031,2043]
                                FIELD [2044,2079]
                                    String: "shell" [2044,2051]
                                    STRING [2052,2079]
                                        String: "arch -arch arm64 bash {0}" [2052,2079]
                                FIELD [2080,2170]
                                    String: "env" [2080,2085]
                                    OBJECT [2086,2170]
                                        FIELD [2087,2135]
                                            String: "ENV_NAME" [2087,2097]
                                            STRING [2098,2135]
                                                String: "conda-test-env-${{ github.run_id }}" [2098,2135]
                                        FIELD [2136,2169]
                                            String: "PY_VERS" [2136,2145]
                                            STRING [2146,2169]
                                                String: "${{ matrix.py_vers }}" [2146,2169]
                                FIELD [2171,3049]
                                    String: "run" [2171,2176]
                                    STRING [2177,3049]
                                        String: ". ~/miniconda3/etc/profile.d/conda.sh\nset -ex\nconda create -yp ${ENV_NAME} python=${PY_VERS} numpy\nconda run -p ${ENV_NAME} python3 -mpip install torch --pre --extra-index-url=https://download.pytorch.org/whl/${CHANNEL}\nconda run -p ${ENV_NAME} python3 -mpip install dist/*.whl\n# Test torch is importable, by changing cwd and running import commands\nconda run --cwd /tmp -p ${ENV_NAME} python3 -c \"import torchvision;print('torchvision version is ', torchvision.__version__)\"\nconda run --cwd /tmp -p ${ENV_NAME} python3 -c \"import torch;import torchvision;print('Is torchvision useable?', all(x is not None for x in [torch.ops.image.decode_png, torch.ops.torchvision.roi_align]))\"\nconda run --cwd /tmp -p ${ENV_NAME} python3 -c \"import torchvision;print(torchvision.io.read_image('${PWD}/gallery/assets/dog1.jpg').shape)\"\nconda env remove -p ${ENV_NAME}\n" [2177,3049]
                            OBJECT [3051,3200]
                                FIELD [3052,3083]
                                    String: "name" [3052,3058]
                                    STRING [3059,3083]
                                        String: "Upload wheel to GitHub" [3059,3083]
                                FIELD [3084,3119]
                                    String: "uses" [3084,3090]
                                    STRING [3091,3119]
                                        String: "actions/upload-artifact@v3" [3091,3119]
                                FIELD [3120,3199]
                                    String: "with" [3120,3126]
                                    OBJECT [3127,3199]
                                        FIELD [3128,3183]
                                            String: "name" [3128,3134]
                                            STRING [3135,3183]
                                                String: "torchvision-py${{ matrix.py_vers }}-macos11-m1" [3135,3183]
                                        FIELD [3184,3198]
                                            String: "path" [3184,3190]
                                            STRING [3191,3198]
                                                String: "dist/" [3191,3198]
                            OBJECT [3201,3674]
                                FIELD [3202,3229]
                                    String: "name" [3202,3208]
                                    STRING [3209,3229]
                                        String: "Upload wheel to S3" [3209,3229]
                                FIELD [3230,3362]
                                    String: "if" [3230,3234]
                                    STRING [3235,3362]
                                        String: "${{ github.event_name == 'push' && (github.event.ref == 'ref/heads/nightly' || startsWith(github.event.ref, 'refs/tags/')) }}" [3235,3362]
                                FIELD [3363,3398]
                                    String: "shell" [3363,3370]
                                    STRING [3371,3398]
                                        String: "arch -arch arm64 bash {0}" [3371,3398]
                                FIELD [3399,3558]
                                    String: "env" [3399,3404]
                                    OBJECT [3405,3558]
                                        FIELD [3406,3477]
                                            String: "AWS_ACCESS_KEY_ID" [3406,3425]
                                            STRING [3426,3477]
                                                String: "${{ secrets.AWS_PYTORCH_UPLOADER_ACCESS_KEY_ID }}" [3426,3477]
                                        FIELD [3478,3557]
                                            String: "AWS_SECRET_ACCESS_KEY" [3478,3501]
                                            STRING [3502,3557]
                                                String: "${{ secrets.AWS_PYTORCH_UPLOADER_SECRET_ACCESS_KEY }}" [3502,3557]
                                FIELD [3559,3673]
                                    String: "run" [3559,3564]
                                    STRING [3565,3673]
                                        String: "for pkg in dist/*; do\n  aws s3 cp \"$pkg\" \"s3://pytorch/whl/${CHANNEL}/cpu/\" --acl public-read\ndone\n" [3565,3673]
            FIELD [3677,5669]
                String: "build_conda" [3677,3690]
                OBJECT [3691,5669]
                    FIELD [3692,3736]
                        String: "name" [3692,3698]
                        STRING [3699,3736]
                            String: "Build TorchVision M1 conda packages" [3699,3736]
                    FIELD [3737,3757]
                        String: "runs-on" [3737,3746]
                        STRING [3747,3757]
                            String: "macos-m1" [3747,3757]
                    FIELD [3758,3812]
                        String: "strategy" [3758,3768]
                        OBJECT [3769,3812]
                            FIELD [3770,3811]
                                String: "matrix" [3770,3778]
                                OBJECT [3779,3811]
                                    FIELD [3780,3810]
                                        String: "py_vers" [3780,3789]
                                        ARRAY [3790,3810]
                                            STRING [3791,3796]
                                                String: "3.8" [3791,3796]
                                            STRING [3797,3802]
                                                String: "3.9" [3797,3802]
                                            STRING [3803,3809]
                                                String: "3.10" [3803,3809]
                    FIELD [3813,5668]
                        String: "steps" [3813,3820]
                        ARRAY [3821,5668]
                            OBJECT [3822,3881]
                                FIELD [3823,3851]
                                    String: "name" [3823,3829]
                                    STRING [3830,3851]
                                        String: "Checkout repository" [3830,3851]
                                FIELD [3852,3880]
                                    String: "uses" [3852,3858]
                                    STRING [3859,3880]
                                        String: "actions/checkout@v2" [3859,3880]
                            OBJECT [3882,4158]
                                FIELD [3883,3928]
                                    String: "name" [3883,3889]
                                    STRING [3890,3928]
                                        String: "Set CHANNEL (only for tagged pushes)" [3890,3928]
                                FIELD [3929,4016]
                                    String: "if" [3929,3933]
                                    STRING [3934,4016]
                                        String: "${{ github.event_name == 'push' && startsWith(github.event.ref, 'refs/tags/') }}" [3934,4016]
                                FIELD [4017,4157]
                                    String: "run" [4017,4022]
                                    STRING [4023,4157]
                                        String: "# reference ends with an RC suffix\nif [[ ${GITHUB_REF_NAME} = *-rc[0-9]* ]]; then\n  echo \"CHANNEL=test\" >> \"$GITHUB_ENV\"\nfi\n" [4023,4157]
                            OBJECT [4159,4356]
                                FIELD [4160,4217]
                                    String: "name" [4160,4166]
                                    STRING [4167,4217]
                                        String: "Install conda-build and purge previous artifacts" [4167,4217]
                                FIELD [4218,4253]
                                    String: "shell" [4218,4225]
                                    STRING [4226,4253]
                                        String: "arch -arch arm64 bash {0}" [4226,4253]
                                FIELD [4254,4355]
                                    String: "run" [4254,4259]
                                    STRING [4260,4355]
                                        String: ". ~/miniconda3/etc/profile.d/conda.sh\nconda install -yq conda-build\nconda build purge-all\n" [4260,4355]
                            OBJECT [4357,4988]
                                FIELD [4358,4401]
                                    String: "name" [4358,4364]
                                    STRING [4365,4401]
                                        String: "Build TorchVision M1 conda package" [4365,4401]
                                FIELD [4402,4437]
                                    String: "shell" [4402,4409]
                                    STRING [4410,4437]
                                        String: "arch -arch arm64 bash {0}" [4410,4437]
                                FIELD [4438,4549]
                                    String: "env" [4438,4443]
                                    OBJECT [4444,4549]
                                        FIELD [4445,4488]
                                            String: "ENV_NAME" [4445,4455]
                                            STRING [4456,4488]
                                                String: "conda-env-${{ github.run_id }}" [4456,4488]
                                        FIELD [4489,4529]
                                            String: "PYTHON_VERSION" [4489,4505]
                                            STRING [4506,4529]
                                                String: "${{ matrix.py_vers }}" [4506,4529]
                                        FIELD [4530,4548]
                                            String: "CU_VERSION" [4530,4542]
                                            STRING [4543,4548]
                                                String: "cpu" [4543,4548]
                                FIELD [4550,4987]
                                    String: "run" [4550,4555]
                                    STRING [4556,4987]
                                        String: ". ~/miniconda3/etc/profile.d/conda.sh\nset -ex\n. packaging/pkg_helpers.bash\n\nif [[ $CHANNEL == \"test\" ]]; then\n  setup_base_build_version\nelse\n  setup_build_version\nfi\n\nsetup_conda_pytorch_constraint\nexport SOURCE_ROOT_DIR=$(pwd)\nconda build -c defaults $CONDA_CHANNEL_FLAGS --no-anaconda-upload --python \"$PYTHON_VERSION\" packaging/torchvision\nmkdir -p dist\ncp ~/miniconda3/conda-bld/osx-arm64/*.tar.bz2 dist/\n" [4556,4987]
                            OBJECT [4989,5146]
                                FIELD [4990,5023]
                                    String: "name" [4990,4996]
                                    STRING [4997,5023]
                                        String: "Upload package to GitHub" [4997,5023]
                                FIELD [5024,5059]
                                    String: "uses" [5024,5030]
                                    STRING [5031,5059]
                                        String: "actions/upload-artifact@v3" [5031,5059]
                                FIELD [5060,5145]
                                    String: "with" [5060,5066]
                                    OBJECT [5067,5145]
                                        FIELD [5068,5129]
                                            String: "name" [5068,5074]
                                            STRING [5075,5129]
                                                String: "torchvision-py${{ matrix.py_vers }}-macos11-m1-conda" [5075,5129]
                                        FIELD [5130,5144]
                                            String: "path" [5130,5136]
                                            STRING [5137,5144]
                                                String: "dist/" [5137,5144]
                            OBJECT [5147,5667]
                                FIELD [5148,5180]
                                    String: "name" [5148,5154]
                                    STRING [5155,5180]
                                        String: "Upload package to conda" [5155,5180]
                                FIELD [5181,5313]
                                    String: "if" [5181,5185]
                                    STRING [5186,5313]
                                        String: "${{ github.event_name == 'push' && (github.event.ref == 'ref/heads/nightly' || startsWith(github.event.ref, 'refs/tags/')) }}" [5186,5313]
                                FIELD [5314,5349]
                                    String: "shell" [5314,5321]
                                    STRING [5322,5349]
                                        String: "arch -arch arm64 bash {0}" [5322,5349]
                                FIELD [5350,5422]
                                    String: "env" [5350,5355]
                                    OBJECT [5356,5422]
                                        FIELD [5357,5421]
                                            String: "CONDA_PYTORCHBOT_TOKEN" [5357,5381]
                                            STRING [5382,5421]
                                                String: "${{ secrets.CONDA_PYTORCHBOT_TOKEN }}" [5382,5421]
                                FIELD [5423,5666]
                                    String: "run" [5423,5428]
                                    STRING [5429,5666]
                                        String: ". ~/miniconda3/etc/profile.d/conda.sh\nconda install -yq anaconda-client\nset -x\nanaconda  -t \"${CONDA_PYTORCHBOT_TOKEN}\" upload ~/miniconda3/conda-bld/osx-arm64/*.tar.bz2 -u \"pytorch-${CHANNEL}\" --label main --no-progress --force" [5429,5666]