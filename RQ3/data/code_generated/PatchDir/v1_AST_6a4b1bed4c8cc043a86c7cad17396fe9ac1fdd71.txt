OBJECT [0,6718]
    FIELD [1,20]
        String: "name" [1,7]
        STRING [8,20]
            String: "Autoformat" [8,20]
    FIELD [21,74]
        String: "on" [21,25]
        OBJECT [26,74]
            FIELD [27,73]
                String: "issue_comment" [27,42]
                OBJECT [43,73]
                    FIELD [44,72]
                        String: "types" [44,51]
                        ARRAY [52,72]
                            STRING [53,62]
                                String: "created" [53,62]
                            STRING [63,71]
                                String: "edited" [63,71]
    FIELD [75,108]
        String: "permissions" [75,88]
        OBJECT [89,108]
            FIELD [90,107]
                String: "contents" [90,100]
                STRING [101,107]
                    String: "read" [101,107]
    FIELD [109,181]
        String: "defaults" [109,119]
        OBJECT [120,181]
            FIELD [121,180]
                String: "run" [121,126]
                OBJECT [127,180]
                    FIELD [128,179]
                        String: "shell" [128,135]
                        STRING [136,179]
                            String: "bash --noprofile --norc -exo pipefail {0}" [136,179]
    FIELD [182,6717]
        String: "jobs" [182,188]
        OBJECT [189,6717]
            FIELD [190,1862]
                String: "check-comment" [190,205]
                OBJECT [206,1862]
                    FIELD [207,232]
                        String: "runs-on" [207,216]
                        STRING [217,232]
                            String: "ubuntu-latest" [217,232]
                    FIELD [233,253]
                        String: "timeout-minutes" [233,250]
                        NUMBER [251,253]
                            Number: 10 [251,253]
                    FIELD [254,413]
                        String: "if" [254,258]
                        STRING [259,413]
                            String: "${{ github.event.issue.pull_request && contains(github.event.comment.body, '@mlflow-automation') && contains(github.event.comment.body, 'autoformat') }}" [259,413]
                    FIELD [414,472]
                        String: "permissions" [414,427]
                        OBJECT [428,472]
                            FIELD [429,447]
                                String: "statuses" [429,439]
                                STRING [440,447]
                                    String: "write" [440,447]
                            FIELD [448,471]
                                String: "pull-requests" [448,463]
                                STRING [464,471]
                                    String: "write" [464,471]
                    FIELD [473,1041]
                        String: "outputs" [473,482]
                        OBJECT [483,1041]
                            FIELD [484,566]
                                String: "should_autoformat" [484,503]
                                STRING [504,566]
                                    String: "${{ fromJSON(steps.judge.outputs.result).shouldAutoformat }}" [504,566]
                            FIELD [567,636]
                                String: "repository" [567,579]
                                STRING [580,636]
                                    String: "${{ fromJSON(steps.judge.outputs.result).repository }}" [580,636]
                            FIELD [637,702]
                                String: "head_ref" [637,647]
                                STRING [648,702]
                                    String: "${{ fromJSON(steps.judge.outputs.result).head_ref }}" [648,702]
                            FIELD [703,768]
                                String: "head_sha" [703,713]
                                STRING [714,768]
                                    String: "${{ fromJSON(steps.judge.outputs.result).head_sha }}" [714,768]
                            FIELD [769,834]
                                String: "base_ref" [769,779]
                                STRING [780,834]
                                    String: "${{ fromJSON(steps.judge.outputs.result).base_ref }}" [780,834]
                            FIELD [835,900]
                                String: "base_sha" [835,845]
                                STRING [846,900]
                                    String: "${{ fromJSON(steps.judge.outputs.result).base_sha }}" [846,900]
                            FIELD [901,968]
                                String: "base_repo" [901,912]
                                STRING [913,968]
                                    String: "${{ fromJSON(steps.judge.outputs.result).base_repo }}" [913,968]
                            FIELD [969,1040]
                                String: "pull_number" [969,982]
                                STRING [983,1040]
                                    String: "${{ fromJSON(steps.judge.outputs.result).pull_number }}" [983,1040]
                    FIELD [1042,1861]
                        String: "steps" [1042,1049]
                        ARRAY [1050,1861]
                            OBJECT [1051,1081]
                                FIELD [1052,1080]
                                    String: "uses" [1052,1058]
                                    STRING [1059,1080]
                                        String: "actions/checkout@v3" [1059,1080]
                            OBJECT [1082,1860]
                                FIELD [1083,1097]
                                    String: "name" [1083,1089]
                                    STRING [1090,1097]
                                        String: "judge" [1090,1097]
                                FIELD [1098,1110]
                                    String: "id" [1098,1102]
                                    STRING [1103,1110]
                                        String: "judge" [1103,1110]
                                FIELD [1111,1144]
                                    String: "uses" [1111,1117]
                                    STRING [1118,1144]
                                        String: "actions/github-script@v6" [1118,1144]
                                FIELD [1145,1859]
                                    String: "with" [1145,1151]
                                    OBJECT [1152,1859]
                                        FIELD [1153,1197]
                                            String: "github-token" [1153,1167]
                                            STRING [1168,1197]
                                                String: "${{ secrets.GITHUB_TOKEN }}" [1168,1197]
                                        FIELD [1198,1858]
                                            String: "script" [1198,1206]
                                            STRING [1207,1858]
                                                String: "core.debug(JSON.stringify(context, null, 2));\nconst autoformat = require('./.github/workflows/autoformat.js');\nconst { comment } = context.payload;\nconst isMaintainer = autoformat.isMlflowMaintainer(comment.author_association);\nif (!isMaintainer) {\n  core.setFailed(\"Only MLflow maintainers can trigger this workflow.\");\n}\nconst shouldAutoformat = autoformat.shouldAutoformat(comment);\nif (shouldAutoformat) {\n  await autoformat.createReaction(context, github);\n  await autoformat.createStatus(context, github, core);\n}\nconst pullInfo = await autoformat.getPullInformation(context, github);\nreturn { ...pullInfo, shouldAutoformat };\n" [1207,1858]
            FIELD [1863,5042]
                String: "format" [1863,1871]
                OBJECT [1872,5042]
                    FIELD [1873,1898]
                        String: "runs-on" [1873,1882]
                        STRING [1883,1898]
                            String: "ubuntu-latest" [1883,1898]
                    FIELD [1899,1919]
                        String: "timeout-minutes" [1899,1916]
                        NUMBER [1917,1919]
                            Number: 30 [1917,1919]
                    FIELD [1920,1943]
                        String: "needs" [1920,1927]
                        STRING [1928,1943]
                            String: "check-comment" [1928,1943]
                    FIELD [1944,2013]
                        String: "if" [1944,1948]
                        STRING [1949,2013]
                            String: "${{ needs.check-comment.outputs.should_autoformat == 'true' }}" [1949,2013]
                    FIELD [2014,2052]
                        String: "permissions" [2014,2027]
                        OBJECT [2028,2052]
                            FIELD [2029,2051]
                                String: "pull-requests" [2029,2044]
                                STRING [2045,2051]
                                    String: "read" [2045,2051]
                    FIELD [2053,2119]
                        String: "outputs" [2053,2062]
                        OBJECT [2063,2119]
                            FIELD [2064,2118]
                                String: "reformatted" [2064,2077]
                                STRING [2078,2118]
                                    String: "${{ steps.patch.outputs.reformatted }}" [2078,2118]
                    FIELD [2120,5041]
                        String: "steps" [2120,2127]
                        ARRAY [2128,5041]
                            OBJECT [2129,2299]
                                FIELD [2130,2158]
                                    String: "uses" [2130,2136]
                                    STRING [2137,2158]
                                        String: "actions/checkout@v3" [2137,2158]
                                FIELD [2159,2298]
                                    String: "with" [2159,2165]
                                    OBJECT [2166,2298]
                                        FIELD [2167,2227]
                                            String: "repository" [2167,2179]
                                            STRING [2180,2227]
                                                String: "${{ needs.check-comment.outputs.repository }}" [2180,2227]
                                        FIELD [2228,2279]
                                            String: "ref" [2228,2233]
                                            STRING [2234,2279]
                                                String: "${{ needs.check-comment.outputs.head_ref }}" [2234,2279]
                                        FIELD [2280,2297]
                                            String: "fetch-depth" [2280,2293]
                                            NUMBER [2294,2297]
                                                Number: 300 [2294,2297]
                            OBJECT [2300,3129]
                                FIELD [2301,2320]
                                    String: "name" [2301,2307]
                                    STRING [2308,2320]
                                        String: "Check diff" [2308,2320]
                                FIELD [2321,2332]
                                    String: "id" [2321,2325]
                                    STRING [2326,2332]
                                        String: "diff" [2326,2332]
                                FIELD [2333,2385]
                                    String: "env" [2333,2338]
                                    OBJECT [2339,2385]
                                        FIELD [2340,2384]
                                            String: "GITHUB_TOKEN" [2340,2354]
                                            STRING [2355,2384]
                                                String: "${{ secrets.GITHUB_TOKEN }}" [2355,2384]
                                FIELD [2386,3128]
                                    String: "run" [2386,2391]
                                    STRING [2392,3128]
                                        String: "changed_files=\"$(gh pr view --repo ${{ github.repository }} ${{ needs.check-comment.outputs.pull_number }} --json files --jq '.files.[].path')\"\nprotos=$([[ -z $(echo \"$changed_files\" | grep '^mlflow/protos') ]] && echo \"false\" || echo \"true\")\npython=$([[ -z $(echo \"$changed_files\" | grep '\\.py$\\|^pyproject\\.toml$') ]] && echo \"false\" || echo \"true\")\njs=$([[ -z $(echo \"$changed_files\" | grep '^mlflow/server/js') ]] && echo \"false\" || echo \"true\")\nr=$([[ -z $(echo \"$changed_files\" | grep '^mlflow/R/mlflow') ]] && echo \"false\" || echo \"true\")\necho \"protos=$protos\" >> $GITHUB_OUTPUT\necho \"python=$python\" >> $GITHUB_OUTPUT\necho \"js=$js\" >> $GITHUB_OUTPUT\necho \"r=$r\" >> $GITHUB_OUTPUT\n" [2392,3128]
                            OBJECT [3130,3486]
                                FIELD [3131,3157]
                                    String: "name" [3131,3137]
                                    STRING [3138,3157]
                                        String: "Merge base branch" [3138,3157]
                                FIELD [3158,3485]
                                    String: "run" [3158,3163]
                                    STRING [3164,3485]
                                        String: "git config user.name 'mlflow-automation'\ngit config user.email 'mlflow-automation@users.noreply.github.com'\ngit remote add base https://github.com/${{ needs.check-comment.outputs.base_repo }}.git\ngit fetch base ${{ needs.check-comment.outputs.base_ref }}\ngit merge base/${{ needs.check-comment.outputs.base_ref }}\n" [3164,3485]
                            OBJECT [3487,3577]
                                FIELD [3488,3576]
                                    String: "run" [3488,3493]
                                    STRING [3494,3576]
                                        String: "pre-commit install\npre-commit run prettier --all-files --color=always || true\n" [3494,3576]
                            OBJECT [3578,3714]
                                FIELD [3579,3621]
                                    String: "if" [3579,3583]
                                    STRING [3584,3621]
                                        String: "steps.diff.outputs.protos == 'true'" [3584,3621]
                                FIELD [3622,3649]
                                    String: "env" [3622,3627]
                                    OBJECT [3628,3649]
                                        FIELD [3629,3648]
                                            String: "DOCKER_BUILDKIT" [3629,3646]
                                            NUMBER [3647,3648]
                                                Number: 1 [3647,3648]
                                FIELD [3650,3713]
                                    String: "run" [3650,3655]
                                    STRING [3656,3713]
                                        String: "docker build -t gen-protos -f dev/Dockerfile.protos .\n" [3656,3713]
                            OBJECT [3715,3850]
                                FIELD [3716,3758]
                                    String: "if" [3716,3720]
                                    STRING [3721,3758]
                                        String: "steps.diff.outputs.protos == 'true'" [3721,3758]
                                FIELD [3759,3849]
                                    String: "run" [3759,3764]
                                    STRING [3765,3849]
                                        String: "docker run --rm -w /mlflow -v $(pwd):/mlflow gen-protos ./dev/generate-protos.sh\n" [3765,3849]
                            OBJECT [3851,3935]
                                FIELD [3852,3894]
                                    String: "if" [3852,3856]
                                    STRING [3857,3894]
                                        String: "steps.diff.outputs.python == 'true'" [3857,3894]
                                FIELD [3895,3934]
                                    String: "uses" [3895,3901]
                                    STRING [3902,3934]
                                        String: "./.github/actions/setup-python" [3902,3934]
                            OBJECT [3936,4040]
                                FIELD [3937,3979]
                                    String: "if" [3937,3941]
                                    STRING [3942,3979]
                                        String: "steps.diff.outputs.python == 'true'" [3942,3979]
                                FIELD [3980,4039]
                                    String: "run" [3980,3985]
                                    STRING [3986,4039]
                                        String: "pip install -r requirements/lint-requirements.txt\n" [3986,4039]
                            OBJECT [4041,4177]
                                FIELD [4042,4084]
                                    String: "if" [4042,4046]
                                    STRING [4047,4084]
                                        String: "steps.diff.outputs.python == 'true'" [4047,4084]
                                FIELD [4085,4176]
                                    String: "run" [4085,4090]
                                    STRING [4091,4176]
                                        String: "ruff --fix .\nblack .\nblacken-docs $(git ls-files '*.py' '*.rst' '*.md') || true\n" [4091,4176]
                            OBJECT [4178,4278]
                                FIELD [4179,4217]
                                    String: "if" [4179,4183]
                                    STRING [4184,4217]
                                        String: "steps.diff.outputs.js == 'true'" [4184,4217]
                                FIELD [4218,4248]
                                    String: "uses" [4218,4224]
                                    STRING [4225,4248]
                                        String: "actions/setup-node@v3" [4225,4248]
                                FIELD [4249,4277]
                                    String: "with" [4249,4255]
                                    OBJECT [4256,4277]
                                        FIELD [4257,4276]
                                            String: "node-version" [4257,4271]
                                            STRING [4272,4276]
                                                String: "16" [4272,4276]
                            OBJECT [4279,4381]
                                FIELD [4280,4318]
                                    String: "if" [4280,4284]
                                    STRING [4285,4318]
                                        String: "steps.diff.outputs.js == 'true'" [4285,4318]
                                FIELD [4319,4357]
                                    String: "working-directory" [4319,4338]
                                    STRING [4339,4357]
                                        String: "mlflow/server/js" [4339,4357]
                                FIELD [4358,4380]
                                    String: "run" [4358,4363]
                                    STRING [4364,4380]
                                        String: "yarn install\n" [4364,4380]
                            OBJECT [4382,4485]
                                FIELD [4383,4421]
                                    String: "if" [4383,4387]
                                    STRING [4388,4421]
                                        String: "steps.diff.outputs.js == 'true'" [4388,4421]
                                FIELD [4422,4460]
                                    String: "working-directory" [4422,4441]
                                    STRING [4442,4460]
                                        String: "mlflow/server/js" [4442,4460]
                                FIELD [4461,4484]
                                    String: "run" [4461,4466]
                                    STRING [4467,4484]
                                        String: "yarn lint:fix\n" [4467,4484]
                            OBJECT [4486,4585]
                                FIELD [4487,4525]
                                    String: "if" [4487,4491]
                                    STRING [4492,4525]
                                        String: "steps.diff.outputs.js == 'true'" [4492,4525]
                                FIELD [4526,4564]
                                    String: "working-directory" [4526,4545]
                                    STRING [4546,4564]
                                        String: "mlflow/server/js" [4546,4564]
                                FIELD [4565,4584]
                                    String: "run" [4565,4570]
                                    STRING [4571,4584]
                                        String: "yarn i18n\n" [4571,4584]
                            OBJECT [4586,4678]
                                FIELD [4587,4624]
                                    String: "if" [4587,4591]
                                    STRING [4592,4624]
                                        String: "steps.diff.outputs.r == 'true'" [4592,4624]
                                FIELD [4625,4651]
                                    String: "working-directory" [4625,4644]
                                    STRING [4645,4651]
                                        String: "docs" [4645,4651]
                                FIELD [4652,4677]
                                    String: "run" [4652,4657]
                                    STRING [4658,4677]
                                        String: "./build-rdoc.sh\n" [4658,4677]
                            OBJECT [4679,4901]
                                FIELD [4680,4701]
                                    String: "name" [4680,4686]
                                    STRING [4687,4701]
                                        String: "Create patch" [4687,4701]
                                FIELD [4702,4714]
                                    String: "id" [4702,4706]
                                    STRING [4707,4714]
                                        String: "patch" [4707,4714]
                                FIELD [4715,4900]
                                    String: "run" [4715,4720]
                                    STRING [4721,4900]
                                        String: "git diff > ${{ github.run_id }}.diff\nreformatted=$([[ -s ${{ github.run_id }}.diff ]] && echo \"true\" || echo \"false\")\necho \"reformatted=$reformatted\" >> $GITHUB_OUTPUT\n" [4721,4900]
                            OBJECT [4902,5040]
                                FIELD [4903,4924]
                                    String: "name" [4903,4909]
                                    STRING [4910,4924]
                                        String: "Upload patch" [4910,4924]
                                FIELD [4925,4960]
                                    String: "uses" [4925,4931]
                                    STRING [4932,4960]
                                        String: "actions/upload-artifact@v3" [4932,4960]
                                FIELD [4961,5039]
                                    String: "with" [4961,4967]
                                    OBJECT [4968,5039]
                                        FIELD [4969,5003]
                                            String: "name" [4969,4975]
                                            STRING [4976,5003]
                                                String: "${{ github.run_id }}.diff" [4976,5003]
                                        FIELD [5004,5038]
                                            String: "path" [5004,5010]
                                            STRING [5011,5038]
                                                String: "${{ github.run_id }}.diff" [5011,5038]
            FIELD [5043,6102]
                String: "push" [5043,5049]
                OBJECT [5050,6102]
                    FIELD [5051,5076]
                        String: "runs-on" [5051,5060]
                        STRING [5061,5076]
                            String: "ubuntu-latest" [5061,5076]
                    FIELD [5077,5096]
                        String: "timeout-minutes" [5077,5094]
                        NUMBER [5095,5096]
                            Number: 5 [5095,5096]
                    FIELD [5097,5131]
                        String: "needs" [5097,5104]
                        ARRAY [5105,5131]
                            STRING [5106,5121]
                                String: "check-comment" [5106,5121]
                            STRING [5122,5130]
                                String: "format" [5122,5130]
                    FIELD [5132,5188]
                        String: "if" [5132,5136]
                        STRING [5137,5188]
                            String: "${{ needs.format.outputs.reformatted == 'true' }}" [5137,5188]
                    FIELD [5189,6101]
                        String: "steps" [5189,5196]
                        ARRAY [5197,6101]
                            OBJECT [5198,5417]
                                FIELD [5199,5227]
                                    String: "uses" [5199,5205]
                                    STRING [5206,5227]
                                        String: "actions/checkout@v3" [5206,5227]
                                FIELD [5228,5416]
                                    String: "with" [5228,5234]
                                    OBJECT [5235,5416]
                                        FIELD [5236,5296]
                                            String: "repository" [5236,5248]
                                            STRING [5249,5296]
                                                String: "${{ needs.check-comment.outputs.repository }}" [5249,5296]
                                        FIELD [5297,5348]
                                            String: "ref" [5297,5302]
                                            STRING [5303,5348]
                                                String: "${{ needs.check-comment.outputs.head_ref }}" [5303,5348]
                                        FIELD [5349,5366]
                                            String: "fetch-depth" [5349,5362]
                                            NUMBER [5363,5366]
                                                Number: 300 [5363,5366]
                                        FIELD [5367,5415]
                                            String: "token" [5367,5374]
                                            STRING [5375,5415]
                                                String: "${{ secrets.MLFLOW_AUTOMATION_TOKEN }}" [5375,5415]
                            OBJECT [5418,5774]
                                FIELD [5419,5445]
                                    String: "name" [5419,5425]
                                    STRING [5426,5445]
                                        String: "Merge base branch" [5426,5445]
                                FIELD [5446,5773]
                                    String: "run" [5446,5451]
                                    STRING [5452,5773]
                                        String: "git config user.name 'mlflow-automation'\ngit config user.email 'mlflow-automation@users.noreply.github.com'\ngit remote add base https://github.com/${{ needs.check-comment.outputs.base_repo }}.git\ngit fetch base ${{ needs.check-comment.outputs.base_ref }}\ngit merge base/${{ needs.check-comment.outputs.base_ref }}\n" [5452,5773]
                            OBJECT [5775,5896]
                                FIELD [5776,5799]
                                    String: "name" [5776,5782]
                                    STRING [5783,5799]
                                        String: "Download patch" [5783,5799]
                                FIELD [5800,5837]
                                    String: "uses" [5800,5806]
                                    STRING [5807,5837]
                                        String: "actions/download-artifact@v3" [5807,5837]
                                FIELD [5838,5895]
                                    String: "with" [5838,5844]
                                    OBJECT [5845,5895]
                                        FIELD [5846,5880]
                                            String: "name" [5846,5852]
                                            STRING [5853,5880]
                                                String: "${{ github.run_id }}.diff" [5853,5880]
                                        FIELD [5881,5894]
                                            String: "path" [5881,5887]
                                            STRING [5888,5894]
                                                String: "/tmp" [5888,5894]
                            OBJECT [5897,6100]
                                FIELD [5898,5927]
                                    String: "name" [5898,5904]
                                    STRING [5905,5927]
                                        String: "Apply patch and push" [5905,5927]
                                FIELD [5928,6099]
                                    String: "run" [5928,5933]
                                    STRING [5934,6099]
                                        String: "git apply /tmp/${{ github.run_id }}.diff\ngit commit -sam \"Autoformat: https://github.com/${{ github.repository }}/actions/runs/${{ github.run_id }}\"\ngit push\n" [5934,6099]
            FIELD [6103,6716]
                String: "update-status" [6103,6118]
                OBJECT [6119,6716]
                    FIELD [6120,6145]
                        String: "runs-on" [6120,6129]
                        STRING [6130,6145]
                            String: "ubuntu-latest" [6130,6145]
                    FIELD [6146,6166]
                        String: "timeout-minutes" [6146,6163]
                        NUMBER [6164,6166]
                            Number: 10 [6164,6166]
                    FIELD [6167,6208]
                        String: "needs" [6167,6174]
                        ARRAY [6175,6208]
                            STRING [6176,6191]
                                String: "check-comment" [6176,6191]
                            STRING [6192,6200]
                                String: "format" [6192,6200]
                            STRING [6201,6207]
                                String: "push" [6201,6207]
                    FIELD [6209,6283]
                        String: "if" [6209,6213]
                        STRING [6214,6283]
                            String: "always() && needs.check-comment.outputs.should_autoformat == 'true'" [6214,6283]
                    FIELD [6284,6318]
                        String: "permissions" [6284,6297]
                        OBJECT [6298,6318]
                            FIELD [6299,6317]
                                String: "statuses" [6299,6309]
                                STRING [6310,6317]
                                    String: "write" [6310,6317]
                    FIELD [6319,6715]
                        String: "steps" [6319,6326]
                        ARRAY [6327,6715]
                            OBJECT [6328,6358]
                                FIELD [6329,6357]
                                    String: "uses" [6329,6335]
                                    STRING [6336,6357]
                                        String: "actions/checkout@v3" [6336,6357]
                            OBJECT [6359,6714]
                                FIELD [6360,6382]
                                    String: "name" [6360,6366]
                                    STRING [6367,6382]
                                        String: "Update status" [6367,6382]
                                FIELD [6383,6416]
                                    String: "uses" [6383,6389]
                                    STRING [6390,6416]
                                        String: "actions/github-script@v6" [6390,6416]
                                FIELD [6417,6713]
                                    String: "with" [6417,6423]
                                    OBJECT [6424,6713]
                                        FIELD [6425,6469]
                                            String: "github-token" [6425,6439]
                                            STRING [6440,6469]
                                                String: "${{ secrets.GITHUB_TOKEN }}" [6440,6469]
                                        FIELD [6470,6712]
                                            String: "script" [6470,6478]
                                            STRING [6479,6712]
                                                String: "const needs = ${{ toJson(needs) }};\nconst head_sha = '${{ needs.check-comment.outputs.head_sha }}'\nconst autoformat = require('./.github/workflows/autoformat.js');\nawait autoformat.updateStatus(context, github, head_sha, needs);" [6479,6712]